var On=Object.defineProperty;var a=(V,pe)=>On(V,"name",{value:pe,configurable:!0});(function(){"use strict";var V=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pe(l){var _=l.default;if(typeof _=="function"){var g=a(function(){return _.apply(this,arguments)},"a");g.prototype=_.prototype}else g={};return Object.defineProperty(g,"__esModule",{value:!0}),Object.keys(l).forEach(function(d){var w=Object.getOwnPropertyDescriptor(l,d);Object.defineProperty(g,d,w.get?w:{enumerable:!0,get:function(){return l[d]}})}),g}a(pe,"getAugmentedNamespace");var vr=a(function(l,_){_||(_={}),typeof _=="function"&&(_={cmp:_});var g=typeof _.cycles=="boolean"?_.cycles:!1,d=_.cmp&&function(I){return function(E){return function(y,i){var s={key:y,value:E[y]},p={key:i,value:E[i]};return I(s,p)}}}(_.cmp),w=[];return a(function I(E){if(E&&E.toJSON&&typeof E.toJSON=="function"&&(E=E.toJSON()),E!==void 0){if(typeof E=="number")return isFinite(E)?""+E:"null";if(typeof E!="object")return JSON.stringify(E);var y,i;if(Array.isArray(E)){for(i="[",y=0;y<E.length;y++)y&&(i+=","),i+=I(E[y])||"null";return i+"]"}if(E===null)return"null";if(w.indexOf(E)!==-1){if(g)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=w.push(E)-1,p=Object.keys(E).sort(d&&d(E));for(i="",y=0;y<p.length;y++){var o=p[y],u=I(E[o]);!u||(i&&(i+=","),i+=JSON.stringify(o)+":"+u)}return w.splice(s,1),"{"+i+"}"}},"stringify")(l)},"fastJsonStableStringify");function le(l){throw new Error('Could not dynamically require "'+l+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}a(le,"commonjsRequire");var ge={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(l,_){(function(g){l.exports=g()})(function(){return a(function g(d,w,I){function E(s,p){if(!w[s]){if(!d[s]){var o=typeof le=="function"&&le;if(!p&&o)return o(s,!0);if(y)return y(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var v=w[s]={exports:{}};d[s][0].call(v.exports,function(A){var M=d[s][1][A];return E(M||A)},v,v.exports,g,d,w,I)}return w[s].exports}a(E,"s");for(var y=typeof le=="function"&&le,i=0;i<I.length;i++)E(I[i]);return E},"e")({1:[function(g,d,w){(function(I){var E=I.MutationObserver||I.WebKitMutationObserver,y;if(E){var i=0,s=new E(A),p=I.document.createTextNode("");s.observe(p,{characterData:!0}),y=a(function(){p.data=i=++i%2},"scheduleDrain")}else if(!I.setImmediate&&typeof I.MessageChannel<"u"){var o=new I.MessageChannel;o.port1.onmessage=A,y=a(function(){o.port2.postMessage(0)},"scheduleDrain")}else"document"in I&&"onreadystatechange"in I.document.createElement("script")?y=a(function(){var P=I.document.createElement("script");P.onreadystatechange=function(){A(),P.onreadystatechange=null,P.parentNode.removeChild(P),P=null},I.document.documentElement.appendChild(P)},"scheduleDrain"):y=a(function(){setTimeout(A,0)},"scheduleDrain");var u,v=[];function A(){u=!0;for(var P,Y,L=v.length;L;){for(Y=v,v=[],P=-1;++P<L;)Y[P]();L=v.length}u=!1}a(A,"nextTick"),d.exports=M;function M(P){v.push(P)===1&&!u&&y()}a(M,"immediate")}).call(this,typeof V<"u"?V:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(g,d,w){var I=g(1);function E(){}a(E,"INTERNAL");var y={},i=["REJECTED"],s=["FULFILLED"],p=["PENDING"];d.exports=o;function o(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,m!==E&&M(this,m)}a(o,"Promise"),o.prototype.catch=function(m){return this.then(null,m)},o.prototype.then=function(m,C){if(typeof m!="function"&&this.state===s||typeof C!="function"&&this.state===i)return this;var D=new this.constructor(E);if(this.state!==p){var T=this.state===s?m:C;v(D,T,this.outcome)}else this.queue.push(new u(D,m,C));return D};function u(m,C,D){this.promise=m,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof D=="function"&&(this.onRejected=D,this.callRejected=this.otherCallRejected)}a(u,"QueueItem"),u.prototype.callFulfilled=function(m){y.resolve(this.promise,m)},u.prototype.otherCallFulfilled=function(m){v(this.promise,this.onFulfilled,m)},u.prototype.callRejected=function(m){y.reject(this.promise,m)},u.prototype.otherCallRejected=function(m){v(this.promise,this.onRejected,m)};function v(m,C,D){I(function(){var T;try{T=C(D)}catch(F){return y.reject(m,F)}T===m?y.reject(m,new TypeError("Cannot resolve promise with itself")):y.resolve(m,T)})}a(v,"unwrap"),y.resolve=function(m,C){var D=P(A,C);if(D.status==="error")return y.reject(m,D.value);var T=D.value;if(T)M(m,T);else{m.state=s,m.outcome=C;for(var F=-1,U=m.queue.length;++F<U;)m.queue[F].callFulfilled(C)}return m},y.reject=function(m,C){m.state=i,m.outcome=C;for(var D=-1,T=m.queue.length;++D<T;)m.queue[D].callRejected(C);return m};function A(m){var C=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof C=="function")return a(function(){C.apply(m,arguments)},"appyThen")}a(A,"getThen");function M(m,C){var D=!1;function T(W){D||(D=!0,y.reject(m,W))}a(T,"onError");function F(W){D||(D=!0,y.resolve(m,W))}a(F,"onSuccess");function U(){C(F,T)}a(U,"tryToUnwrap");var j=P(U);j.status==="error"&&T(j.value)}a(M,"safelyResolveThenable");function P(m,C){var D={};try{D.value=m(C),D.status="success"}catch(T){D.status="error",D.value=T}return D}a(P,"tryCatch"),o.resolve=Y;function Y(m){return m instanceof this?m:y.resolve(new this(E),m)}a(Y,"resolve"),o.reject=L;function L(m){var C=new this(E);return y.reject(C,m)}a(L,"reject"),o.all=Q;function Q(m){var C=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=m.length,T=!1;if(!D)return this.resolve([]);for(var F=new Array(D),U=0,j=-1,W=new this(E);++j<D;)k(m[j],j);return W;function k(K,Z){C.resolve(K).then(ee,function(fe){T||(T=!0,y.reject(W,fe))});function ee(fe){F[Z]=fe,++U===D&&!T&&(T=!0,y.resolve(W,F))}a(ee,"resolveFromAll")}}a(Q,"all"),o.race=O;function O(m){var C=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=m.length,T=!1;if(!D)return this.resolve([]);for(var F=-1,U=new this(E);++F<D;)j(m[F]);return U;function j(W){C.resolve(W).then(function(k){T||(T=!0,y.resolve(U,k))},function(k){T||(T=!0,y.reject(U,k))})}}a(O,"race")},{1:1}],3:[function(g,d,w){(function(I){typeof I.Promise!="function"&&(I.Promise=g(2))}).call(this,typeof V<"u"?V:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(g,d,w){var I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function E(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}a(E,"_classCallCheck");function y(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}a(y,"getIDB");var i=y();function s(){try{if(!i||!i.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}a(s,"isIndexedDBValid");function p(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(t){if(t.name!=="TypeError")throw t;for(var r=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,f=new r,c=0;c<e.length;c+=1)f.append(e[c]);return f.getBlob(n.type)}}a(p,"createBlob"),typeof Promise>"u"&&g(3);var o=Promise;function u(e,n){n&&e.then(function(r){n(null,r)},function(r){n(r)})}a(u,"executeCallback");function v(e,n,r){typeof n=="function"&&e.then(n),typeof r=="function"&&e.catch(r)}a(v,"executeTwoCallbacks");function A(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}a(A,"normalizeKey");function M(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}a(M,"getCallback");var P="local-forage-detect-blob-support",Y=void 0,L={},Q=Object.prototype.toString,O="readonly",m="readwrite";function C(e){for(var n=e.length,r=new ArrayBuffer(n),f=new Uint8Array(r),c=0;c<n;c++)f[c]=e.charCodeAt(c);return r}a(C,"_binStringToArrayBuffer");function D(e){return new o(function(n){var r=e.transaction(P,m),f=p([""]);r.objectStore(P).put(f,"key"),r.onabort=function(c){c.preventDefault(),c.stopPropagation(),n(!1)},r.oncomplete=function(){var c=navigator.userAgent.match(/Chrome\/(\d+)/),t=navigator.userAgent.match(/Edge\//);n(t||!c||parseInt(c[1],10)>=43)}}).catch(function(){return!1})}a(D,"_checkBlobSupportWithoutCaching");function T(e){return typeof Y=="boolean"?o.resolve(Y):D(e).then(function(n){return Y=n,Y})}a(T,"_checkBlobSupport");function F(e){var n=L[e.name],r={};r.promise=new o(function(f,c){r.resolve=f,r.reject=c}),n.deferredOperations.push(r),n.dbReady?n.dbReady=n.dbReady.then(function(){return r.promise}):n.dbReady=r.promise}a(F,"_deferReadiness");function U(e){var n=L[e.name],r=n.deferredOperations.pop();if(r)return r.resolve(),r.promise}a(U,"_advanceReadiness");function j(e,n){var r=L[e.name],f=r.deferredOperations.pop();if(f)return f.reject(n),f.promise}a(j,"_rejectReadiness");function W(e,n){return new o(function(r,f){if(L[e.name]=L[e.name]||Ge(),e.db)if(n)F(e),e.db.close();else return r(e.db);var c=[e.name];n&&c.push(e.version);var t=i.open.apply(i,c);n&&(t.onupgradeneeded=function(h){var b=t.result;try{b.createObjectStore(e.storeName),h.oldVersion<=1&&b.createObjectStore(P)}catch(x){if(x.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+h.oldVersion+" to version "+h.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw x}}),t.onerror=function(h){h.preventDefault(),f(t.error)},t.onsuccess=function(){var h=t.result;h.onversionchange=function(b){b.target.close()},r(h),U(e)}})}a(W,"_getConnection");function k(e){return W(e,!1)}a(k,"_getOriginalConnection");function K(e){return W(e,!0)}a(K,"_getUpgradedConnection");function Z(e,n){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),f=e.version<e.db.version,c=e.version>e.db.version;if(f&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),c||r){if(r){var t=e.db.version+1;t>e.version&&(e.version=t)}return!0}return!1}a(Z,"_isUpgradeNeeded");function ee(e){return new o(function(n,r){var f=new FileReader;f.onerror=r,f.onloadend=function(c){var t=btoa(c.target.result||"");n({__local_forage_encoded_blob:!0,data:t,type:e.type})},f.readAsBinaryString(e)})}a(ee,"_encodeBlob");function fe(e){var n=C(atob(e.data));return p([n],{type:e.type})}a(fe,"_decodeBlob");function qe(e){return e&&e.__local_forage_encoded_blob}a(qe,"_isEncodedBlob");function Or(e){var n=this,r=n._initReady().then(function(){var f=L[n._dbInfo.name];if(f&&f.dbReady)return f.dbReady});return v(r,e,e),r}a(Or,"_fullyReady");function Br(e){F(e);for(var n=L[e.name],r=n.forages,f=0;f<r.length;f++){var c=r[f];c._dbInfo.db&&(c._dbInfo.db.close(),c._dbInfo.db=null)}return e.db=null,k(e).then(function(t){return e.db=t,Z(e)?K(e):t}).then(function(t){e.db=n.db=t;for(var h=0;h<r.length;h++)r[h]._dbInfo.db=t}).catch(function(t){throw j(e,t),t})}a(Br,"_tryReconnect");function re(e,n,r,f){f===void 0&&(f=1);try{var c=e.db.transaction(e.storeName,n);r(null,c)}catch(t){if(f>0&&(!e.db||t.name==="InvalidStateError"||t.name==="NotFoundError"))return o.resolve().then(function(){if(!e.db||t.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),K(e)}).then(function(){return Br(e).then(function(){re(e,n,r,f-1)})}).catch(r);r(t)}}a(re,"createTransaction");function Ge(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}a(Ge,"createDbContext");function Pr(e){var n=this,r={db:null};if(e)for(var f in e)r[f]=e[f];var c=L[r.name];c||(c=Ge(),L[r.name]=c),c.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=Or);var t=[];function h(){return o.resolve()}a(h,"ignoreErrors");for(var b=0;b<c.forages.length;b++){var x=c.forages[b];x!==n&&t.push(x._initReady().catch(h))}var S=c.forages.slice(0);return o.all(t).then(function(){return r.db=c.db,k(r)}).then(function(R){return r.db=R,Z(r,n._defaultConfig.version)?K(r):R}).then(function(R){r.db=c.db=R,n._dbInfo=r;for(var N=0;N<S.length;N++){var B=S[N];B!==n&&(B._dbInfo.db=r.db,B._dbInfo.version=r.version)}})}a(Pr,"_initStorage");function Lr(e,n){var r=this;e=A(e);var f=new o(function(c,t){r.ready().then(function(){re(r._dbInfo,O,function(h,b){if(h)return t(h);try{var x=b.objectStore(r._dbInfo.storeName),S=x.get(e);S.onsuccess=function(){var R=S.result;R===void 0&&(R=null),qe(R)&&(R=fe(R)),c(R)},S.onerror=function(){t(S.error)}}catch(R){t(R)}})}).catch(t)});return u(f,n),f}a(Lr,"getItem");function Mr(e,n){var r=this,f=new o(function(c,t){r.ready().then(function(){re(r._dbInfo,O,function(h,b){if(h)return t(h);try{var x=b.objectStore(r._dbInfo.storeName),S=x.openCursor(),R=1;S.onsuccess=function(){var N=S.result;if(N){var B=N.value;qe(B)&&(B=fe(B));var $=e(B,N.key,R++);$!==void 0?c($):N.continue()}else c()},S.onerror=function(){t(S.error)}}catch(N){t(N)}})}).catch(t)});return u(f,n),f}a(Mr,"iterate");function Fr(e,n,r){var f=this;e=A(e);var c=new o(function(t,h){var b;f.ready().then(function(){return b=f._dbInfo,Q.call(n)==="[object Blob]"?T(b.db).then(function(x){return x?n:ee(n)}):n}).then(function(x){re(f._dbInfo,m,function(S,R){if(S)return h(S);try{var N=R.objectStore(f._dbInfo.storeName);x===null&&(x=void 0);var B=N.put(x,e);R.oncomplete=function(){x===void 0&&(x=null),t(x)},R.onabort=R.onerror=function(){var $=B.error?B.error:B.transaction.error;h($)}}catch($){h($)}})}).catch(h)});return u(c,r),c}a(Fr,"setItem");function $r(e,n){var r=this;e=A(e);var f=new o(function(c,t){r.ready().then(function(){re(r._dbInfo,m,function(h,b){if(h)return t(h);try{var x=b.objectStore(r._dbInfo.storeName),S=x.delete(e);b.oncomplete=function(){c()},b.onerror=function(){t(S.error)},b.onabort=function(){var R=S.error?S.error:S.transaction.error;t(R)}}catch(R){t(R)}})}).catch(t)});return u(f,n),f}a($r,"removeItem");function zr(e){var n=this,r=new o(function(f,c){n.ready().then(function(){re(n._dbInfo,m,function(t,h){if(t)return c(t);try{var b=h.objectStore(n._dbInfo.storeName),x=b.clear();h.oncomplete=function(){f()},h.onabort=h.onerror=function(){var S=x.error?x.error:x.transaction.error;c(S)}}catch(S){c(S)}})}).catch(c)});return u(r,e),r}a(zr,"clear");function Ur(e){var n=this,r=new o(function(f,c){n.ready().then(function(){re(n._dbInfo,O,function(t,h){if(t)return c(t);try{var b=h.objectStore(n._dbInfo.storeName),x=b.count();x.onsuccess=function(){f(x.result)},x.onerror=function(){c(x.error)}}catch(S){c(S)}})}).catch(c)});return u(r,e),r}a(Ur,"length");function jr(e,n){var r=this,f=new o(function(c,t){if(e<0){c(null);return}r.ready().then(function(){re(r._dbInfo,O,function(h,b){if(h)return t(h);try{var x=b.objectStore(r._dbInfo.storeName),S=!1,R=x.openKeyCursor();R.onsuccess=function(){var N=R.result;if(!N){c(null);return}e===0||S?c(N.key):(S=!0,N.advance(e))},R.onerror=function(){t(R.error)}}catch(N){t(N)}})}).catch(t)});return u(f,n),f}a(jr,"key");function Yr(e){var n=this,r=new o(function(f,c){n.ready().then(function(){re(n._dbInfo,O,function(t,h){if(t)return c(t);try{var b=h.objectStore(n._dbInfo.storeName),x=b.openKeyCursor(),S=[];x.onsuccess=function(){var R=x.result;if(!R){f(S);return}S.push(R.key),R.continue()},x.onerror=function(){c(x.error)}}catch(R){c(R)}})}).catch(c)});return u(r,e),r}a(Yr,"keys");function Wr(e,n){n=M.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var f=this,c;if(!e.name)c=o.reject("Invalid arguments");else{var t=e.name===r.name&&f._dbInfo.db,h=t?o.resolve(f._dbInfo.db):k(e).then(function(b){var x=L[e.name],S=x.forages;x.db=b;for(var R=0;R<S.length;R++)S[R]._dbInfo.db=b;return b});e.storeName?c=h.then(function(b){if(!!b.objectStoreNames.contains(e.storeName)){var x=b.version+1;F(e);var S=L[e.name],R=S.forages;b.close();for(var N=0;N<R.length;N++){var B=R[N];B._dbInfo.db=null,B._dbInfo.version=x}var $=new o(function(z,q){var X=i.open(e.name,x);X.onerror=function(H){var se=X.result;se.close(),q(H)},X.onupgradeneeded=function(){var H=X.result;H.deleteObjectStore(e.storeName)},X.onsuccess=function(){var H=X.result;H.close(),z(H)}});return $.then(function(z){S.db=z;for(var q=0;q<R.length;q++){var X=R[q];X._dbInfo.db=z,U(X._dbInfo)}}).catch(function(z){throw(j(e,z)||o.resolve()).catch(function(){}),z})}}):c=h.then(function(b){F(e);var x=L[e.name],S=x.forages;b.close();for(var R=0;R<S.length;R++){var N=S[R];N._dbInfo.db=null}var B=new o(function($,z){var q=i.deleteDatabase(e.name);q.onerror=function(){var X=q.result;X&&X.close(),z(q.error)},q.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},q.onsuccess=function(){var X=q.result;X&&X.close(),$(X)}});return B.then(function($){x.db=$;for(var z=0;z<S.length;z++){var q=S[z];U(q._dbInfo)}}).catch(function($){throw(j(e,$)||o.resolve()).catch(function(){}),$})})}return u(c,n),c}a(Wr,"dropInstance");var Xr={_driver:"asyncStorage",_initStorage:Pr,_support:s(),iterate:Mr,getItem:Lr,setItem:Fr,removeItem:$r,clear:zr,length:Ur,key:jr,keys:Yr,dropInstance:Wr};function kr(){return typeof openDatabase=="function"}a(kr,"isWebSQLValid");var te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qr="~~local_forage_type~",Ke=/^~~local_forage_type~([^~]+)~/,he="__lfsc__:",_e=he.length,xe="arbf",Se="blob",Ve="si08",Je="ui08",Qe="uic8",He="si16",Ze="si32",er="ur16",rr="ui32",nr="fl32",tr="fl64",or=_e+xe.length,ir=Object.prototype.toString;function ar(e){var n=e.length*.75,r=e.length,f,c=0,t,h,b,x;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var S=new ArrayBuffer(n),R=new Uint8Array(S);for(f=0;f<r;f+=4)t=te.indexOf(e[f]),h=te.indexOf(e[f+1]),b=te.indexOf(e[f+2]),x=te.indexOf(e[f+3]),R[c++]=t<<2|h>>4,R[c++]=(h&15)<<4|b>>2,R[c++]=(b&3)<<6|x&63;return S}a(ar,"stringToBuffer");function Ee(e){var n=new Uint8Array(e),r="",f;for(f=0;f<n.length;f+=3)r+=te[n[f]>>2],r+=te[(n[f]&3)<<4|n[f+1]>>4],r+=te[(n[f+1]&15)<<2|n[f+2]>>6],r+=te[n[f+2]&63];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}a(Ee,"bufferToString");function Gr(e,n){var r="";if(e&&(r=ir.call(e)),e&&(r==="[object ArrayBuffer]"||e.buffer&&ir.call(e.buffer)==="[object ArrayBuffer]")){var f,c=he;e instanceof ArrayBuffer?(f=e,c+=xe):(f=e.buffer,r==="[object Int8Array]"?c+=Ve:r==="[object Uint8Array]"?c+=Je:r==="[object Uint8ClampedArray]"?c+=Qe:r==="[object Int16Array]"?c+=He:r==="[object Uint16Array]"?c+=er:r==="[object Int32Array]"?c+=Ze:r==="[object Uint32Array]"?c+=rr:r==="[object Float32Array]"?c+=nr:r==="[object Float64Array]"?c+=tr:n(new Error("Failed to get type for BinaryArray"))),n(c+Ee(f))}else if(r==="[object Blob]"){var t=new FileReader;t.onload=function(){var h=qr+e.type+"~"+Ee(this.result);n(he+Se+h)},t.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(h){console.error("Couldn't convert value into a JSON string: ",e),n(null,h)}}a(Gr,"serialize");function Kr(e){if(e.substring(0,_e)!==he)return JSON.parse(e);var n=e.substring(or),r=e.substring(_e,or),f;if(r===Se&&Ke.test(n)){var c=n.match(Ke);f=c[1],n=n.substring(c[0].length)}var t=ar(n);switch(r){case xe:return t;case Se:return p([t],{type:f});case Ve:return new Int8Array(t);case Je:return new Uint8Array(t);case Qe:return new Uint8ClampedArray(t);case He:return new Int16Array(t);case er:return new Uint16Array(t);case Ze:return new Int32Array(t);case rr:return new Uint32Array(t);case nr:return new Float32Array(t);case tr:return new Float64Array(t);default:throw new Error("Unkown type: "+r)}}a(Kr,"deserialize");var Ie={serialize:Gr,deserialize:Kr,stringToBuffer:ar,bufferToString:Ee};function fr(e,n,r,f){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,f)}a(fr,"createDbTable");function Vr(e){var n=this,r={db:null};if(e)for(var f in e)r[f]=typeof e[f]!="string"?e[f].toString():e[f];var c=new o(function(t,h){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(b){return h(b)}r.db.transaction(function(b){fr(b,r,function(){n._dbInfo=r,t()},function(x,S){h(S)})},h)});return r.serializer=Ie,c}a(Vr,"_initStorage$1");function oe(e,n,r,f,c,t){e.executeSql(r,f,c,function(h,b){b.code===b.SYNTAX_ERR?h.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(x,S){S.rows.length?t(x,b):fr(x,n,function(){x.executeSql(r,f,c,t)},t)},t):t(h,b)},t)}a(oe,"tryExecuteSql");function Jr(e,n){var r=this;e=A(e);var f=new o(function(c,t){r.ready().then(function(){var h=r._dbInfo;h.db.transaction(function(b){oe(b,h,"SELECT * FROM "+h.storeName+" WHERE key = ? LIMIT 1",[e],function(x,S){var R=S.rows.length?S.rows.item(0).value:null;R&&(R=h.serializer.deserialize(R)),c(R)},function(x,S){t(S)})})}).catch(t)});return u(f,n),f}a(Jr,"getItem$1");function Qr(e,n){var r=this,f=new o(function(c,t){r.ready().then(function(){var h=r._dbInfo;h.db.transaction(function(b){oe(b,h,"SELECT * FROM "+h.storeName,[],function(x,S){for(var R=S.rows,N=R.length,B=0;B<N;B++){var $=R.item(B),z=$.value;if(z&&(z=h.serializer.deserialize(z)),z=e(z,$.key,B+1),z!==void 0){c(z);return}}c()},function(x,S){t(S)})})}).catch(t)});return u(f,n),f}a(Qr,"iterate$1");function ur(e,n,r,f){var c=this;e=A(e);var t=new o(function(h,b){c.ready().then(function(){n===void 0&&(n=null);var x=n,S=c._dbInfo;S.serializer.serialize(n,function(R,N){N?b(N):S.db.transaction(function(B){oe(B,S,"INSERT OR REPLACE INTO "+S.storeName+" (key, value) VALUES (?, ?)",[e,R],function(){h(x)},function($,z){b(z)})},function(B){if(B.code===B.QUOTA_ERR){if(f>0){h(ur.apply(c,[e,x,r,f-1]));return}b(B)}})})}).catch(b)});return u(t,r),t}a(ur,"_setItem");function Hr(e,n,r){return ur.apply(this,[e,n,r,1])}a(Hr,"setItem$1");function Zr(e,n){var r=this;e=A(e);var f=new o(function(c,t){r.ready().then(function(){var h=r._dbInfo;h.db.transaction(function(b){oe(b,h,"DELETE FROM "+h.storeName+" WHERE key = ?",[e],function(){c()},function(x,S){t(S)})})}).catch(t)});return u(f,n),f}a(Zr,"removeItem$1");function en(e){var n=this,r=new o(function(f,c){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(h){oe(h,t,"DELETE FROM "+t.storeName,[],function(){f()},function(b,x){c(x)})})}).catch(c)});return u(r,e),r}a(en,"clear$1");function rn(e){var n=this,r=new o(function(f,c){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(h){oe(h,t,"SELECT COUNT(key) as c FROM "+t.storeName,[],function(b,x){var S=x.rows.item(0).c;f(S)},function(b,x){c(x)})})}).catch(c)});return u(r,e),r}a(rn,"length$1");function nn(e,n){var r=this,f=new o(function(c,t){r.ready().then(function(){var h=r._dbInfo;h.db.transaction(function(b){oe(b,h,"SELECT key FROM "+h.storeName+" WHERE id = ? LIMIT 1",[e+1],function(x,S){var R=S.rows.length?S.rows.item(0).key:null;c(R)},function(x,S){t(S)})})}).catch(t)});return u(f,n),f}a(nn,"key$1");function tn(e){var n=this,r=new o(function(f,c){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(h){oe(h,t,"SELECT key FROM "+t.storeName,[],function(b,x){for(var S=[],R=0;R<x.rows.length;R++)S.push(x.rows.item(R).key);f(S)},function(b,x){c(x)})})}).catch(c)});return u(r,e),r}a(tn,"keys$1");function on(e){return new o(function(n,r){e.transaction(function(f){f.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(c,t){for(var h=[],b=0;b<t.rows.length;b++)h.push(t.rows.item(b).name);n({db:e,storeNames:h})},function(c,t){r(t)})},function(f){r(f)})})}a(on,"getAllStoreNames");function an(e,n){n=M.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var f=this,c;return e.name?c=new o(function(t){var h;e.name===r.name?h=f._dbInfo.db:h=openDatabase(e.name,"","",0),e.storeName?t({db:h,storeNames:[e.storeName]}):t(on(h))}).then(function(t){return new o(function(h,b){t.db.transaction(function(x){function S($){return new o(function(z,q){x.executeSql("DROP TABLE IF EXISTS "+$,[],function(){z()},function(X,H){q(H)})})}a(S,"dropTable");for(var R=[],N=0,B=t.storeNames.length;N<B;N++)R.push(S(t.storeNames[N]));o.all(R).then(function(){h()}).catch(function($){b($)})},function(x){b(x)})})}):c=o.reject("Invalid arguments"),u(c,n),c}a(an,"dropInstance$1");var fn={_driver:"webSQLStorage",_initStorage:Vr,_support:kr(),iterate:Qr,getItem:Jr,setItem:Hr,removeItem:Zr,clear:en,length:rn,key:nn,keys:tn,dropInstance:an};function un(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}a(un,"isLocalStorageValid");function cr(e,n){var r=e.name+"/";return e.storeName!==n.storeName&&(r+=e.storeName+"/"),r}a(cr,"_getKeyPrefix");function cn(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}a(cn,"checkIfLocalStorageThrows");function sn(){return!cn()||localStorage.length>0}a(sn,"_isLocalStorageUsable");function ln(e){var n=this,r={};if(e)for(var f in e)r[f]=e[f];return r.keyPrefix=cr(e,n._defaultConfig),sn()?(n._dbInfo=r,r.serializer=Ie,o.resolve()):o.reject()}a(ln,"_initStorage$2");function dn(e){var n=this,r=n.ready().then(function(){for(var f=n._dbInfo.keyPrefix,c=localStorage.length-1;c>=0;c--){var t=localStorage.key(c);t.indexOf(f)===0&&localStorage.removeItem(t)}});return u(r,e),r}a(dn,"clear$2");function vn(e,n){var r=this;e=A(e);var f=r.ready().then(function(){var c=r._dbInfo,t=localStorage.getItem(c.keyPrefix+e);return t&&(t=c.serializer.deserialize(t)),t});return u(f,n),f}a(vn,"getItem$2");function hn(e,n){var r=this,f=r.ready().then(function(){for(var c=r._dbInfo,t=c.keyPrefix,h=t.length,b=localStorage.length,x=1,S=0;S<b;S++){var R=localStorage.key(S);if(R.indexOf(t)===0){var N=localStorage.getItem(R);if(N&&(N=c.serializer.deserialize(N)),N=e(N,R.substring(h),x++),N!==void 0)return N}}});return u(f,n),f}a(hn,"iterate$2");function yn(e,n){var r=this,f=r.ready().then(function(){var c=r._dbInfo,t;try{t=localStorage.key(e)}catch{t=null}return t&&(t=t.substring(c.keyPrefix.length)),t});return u(f,n),f}a(yn,"key$2");function pn(e){var n=this,r=n.ready().then(function(){for(var f=n._dbInfo,c=localStorage.length,t=[],h=0;h<c;h++){var b=localStorage.key(h);b.indexOf(f.keyPrefix)===0&&t.push(b.substring(f.keyPrefix.length))}return t});return u(r,e),r}a(pn,"keys$2");function gn(e){var n=this,r=n.keys().then(function(f){return f.length});return u(r,e),r}a(gn,"length$2");function mn(e,n){var r=this;e=A(e);var f=r.ready().then(function(){var c=r._dbInfo;localStorage.removeItem(c.keyPrefix+e)});return u(f,n),f}a(mn,"removeItem$2");function bn(e,n,r){var f=this;e=A(e);var c=f.ready().then(function(){n===void 0&&(n=null);var t=n;return new o(function(h,b){var x=f._dbInfo;x.serializer.serialize(n,function(S,R){if(R)b(R);else try{localStorage.setItem(x.keyPrefix+e,S),h(t)}catch(N){(N.name==="QuotaExceededError"||N.name==="NS_ERROR_DOM_QUOTA_REACHED")&&b(N),b(N)}})})});return u(c,r),c}a(bn,"setItem$2");function wn(e,n){if(n=M.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var f=this,c;return e.name?c=new o(function(t){e.storeName?t(cr(e,f._defaultConfig)):t(e.name+"/")}).then(function(t){for(var h=localStorage.length-1;h>=0;h--){var b=localStorage.key(h);b.indexOf(t)===0&&localStorage.removeItem(b)}}):c=o.reject("Invalid arguments"),u(c,n),c}a(wn,"dropInstance$2");var _n={_driver:"localStorageWrapper",_initStorage:ln,_support:un(),iterate:hn,getItem:vn,setItem:bn,removeItem:mn,clear:dn,length:gn,key:yn,keys:pn,dropInstance:wn},xn=a(function(n,r){return n===r||typeof n=="number"&&typeof r=="number"&&isNaN(n)&&isNaN(r)},"sameValue"),Sn=a(function(n,r){for(var f=n.length,c=0;c<f;){if(xn(n[c],r))return!0;c++}return!1},"includes"),sr=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},ce={},lr={},ue={INDEXEDDB:Xr,WEBSQL:fn,LOCALSTORAGE:_n},En=[ue.INDEXEDDB._driver,ue.WEBSQL._driver,ue.LOCALSTORAGE._driver],ye=["dropInstance"],Re=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ye),In={description:"",driver:En.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Rn(e,n){e[n]=function(){var r=arguments;return e.ready().then(function(){return e[n].apply(e,r)})}}a(Rn,"callWhenReady");function Ae(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var r in n)n.hasOwnProperty(r)&&(sr(n[r])?arguments[0][r]=n[r].slice():arguments[0][r]=n[r])}return arguments[0]}a(Ae,"extend");var An=function(){function e(n){E(this,e);for(var r in ue)if(ue.hasOwnProperty(r)){var f=ue[r],c=f._driver;this[r]=c,ce[c]||this.defineDriver(f)}this._defaultConfig=Ae({},In),this._config=Ae({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return a(e,"LocalForage"),e.prototype.config=a(function(r){if((typeof r>"u"?"undefined":I(r))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var f in r){if(f==="storeName"&&(r[f]=r[f].replace(/\W/g,"_")),f==="version"&&typeof r[f]!="number")return new Error("Database version must be a number.");this._config[f]=r[f]}return"driver"in r&&r.driver?this.setDriver(this._config.driver):!0}else return typeof r=="string"?this._config[r]:this._config},"config"),e.prototype.defineDriver=a(function(r,f,c){var t=new o(function(h,b){try{var x=r._driver,S=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!r._driver){b(S);return}for(var R=Re.concat("_initStorage"),N=0,B=R.length;N<B;N++){var $=R[N],z=!Sn(ye,$);if((z||r[$])&&typeof r[$]!="function"){b(S);return}}var q=a(function(){for(var se=a(function(Cn){return function(){var Tn=new Error("Method "+Cn+" is not implemented by the current driver"),dr=o.reject(Tn);return u(dr,arguments[arguments.length-1]),dr}},"methodNotImplementedFactory"),Ne=0,Dn=ye.length;Ne<Dn;Ne++){var De=ye[Ne];r[De]||(r[De]=se(De))}},"configureMissingMethods");q();var X=a(function(se){ce[x]&&console.info("Redefining LocalForage driver: "+x),ce[x]=r,lr[x]=se,h()},"setDriverSupport");"_support"in r?r._support&&typeof r._support=="function"?r._support().then(X,b):X(!!r._support):X(!0)}catch(H){b(H)}});return v(t,f,c),t},"defineDriver"),e.prototype.driver=a(function(){return this._driver||null},"driver"),e.prototype.getDriver=a(function(r,f,c){var t=ce[r]?o.resolve(ce[r]):o.reject(new Error("Driver not found."));return v(t,f,c),t},"getDriver"),e.prototype.getSerializer=a(function(r){var f=o.resolve(Ie);return v(f,r),f},"getSerializer"),e.prototype.ready=a(function(r){var f=this,c=f._driverSet.then(function(){return f._ready===null&&(f._ready=f._initDriver()),f._ready});return v(c,r,r),c},"ready"),e.prototype.setDriver=a(function(r,f,c){var t=this;sr(r)||(r=[r]);var h=this._getSupportedDrivers(r);function b(){t._config.driver=t.driver()}a(b,"setDriverToConfig");function x(N){return t._extend(N),b(),t._ready=t._initStorage(t._config),t._ready}a(x,"extendSelfWithDriver");function S(N){return function(){var B=0;function $(){for(;B<N.length;){var z=N[B];return B++,t._dbInfo=null,t._ready=null,t.getDriver(z).then(x).catch($)}b();var q=new Error("No available storage method found.");return t._driverSet=o.reject(q),t._driverSet}return a($,"driverPromiseLoop"),$()}}a(S,"initDriver");var R=this._driverSet!==null?this._driverSet.catch(function(){return o.resolve()}):o.resolve();return this._driverSet=R.then(function(){var N=h[0];return t._dbInfo=null,t._ready=null,t.getDriver(N).then(function(B){t._driver=B._driver,b(),t._wrapLibraryMethodsWithReady(),t._initDriver=S(h)})}).catch(function(){b();var N=new Error("No available storage method found.");return t._driverSet=o.reject(N),t._driverSet}),v(this._driverSet,f,c),this._driverSet},"setDriver"),e.prototype.supports=a(function(r){return!!lr[r]},"supports"),e.prototype._extend=a(function(r){Ae(this,r)},"_extend"),e.prototype._getSupportedDrivers=a(function(r){for(var f=[],c=0,t=r.length;c<t;c++){var h=r[c];this.supports(h)&&f.push(h)}return f},"_getSupportedDrivers"),e.prototype._wrapLibraryMethodsWithReady=a(function(){for(var r=0,f=Re.length;r<f;r++)Rn(this,Re[r])},"_wrapLibraryMethodsWithReady"),e.prototype.createInstance=a(function(r){return new e(r)},"createInstance"),e}(),Nn=new An;d.exports=Nn},{3:3}]},{},[4])(4)})})(ge);const G=a(({q:l,r:_,s:g})=>`${l} ${_} ${g}`,"asCoordinateKey"),Ce=[0,60,120,180,240,300];var Te={exports:{}};(function(l){(function(_,g,d){function w(i){var s=this,p=y();s.next=function(){var o=2091639*s.s0+s.c*23283064365386963e-26;return s.s0=s.s1,s.s1=s.s2,s.s2=o-(s.c=o|0)},s.c=1,s.s0=p(" "),s.s1=p(" "),s.s2=p(" "),s.s0-=p(i),s.s0<0&&(s.s0+=1),s.s1-=p(i),s.s1<0&&(s.s1+=1),s.s2-=p(i),s.s2<0&&(s.s2+=1),p=null}a(w,"Alea");function I(i,s){return s.c=i.c,s.s0=i.s0,s.s1=i.s1,s.s2=i.s2,s}a(I,"copy");function E(i,s){var p=new w(i),o=s&&s.state,u=p.next;return u.int32=function(){return p.next()*4294967296|0},u.double=function(){return u()+(u()*2097152|0)*11102230246251565e-32},u.quick=u,o&&(typeof o=="object"&&I(o,p),u.state=function(){return I(p,{})}),u}a(E,"impl");function y(){var i=4022871197,s=a(function(p){p=String(p);for(var o=0;o<p.length;o++){i+=p.charCodeAt(o);var u=.02519603282416938*i;i=u>>>0,u-=i,u*=i,i=u>>>0,u-=i,i+=u*4294967296}return(i>>>0)*23283064365386963e-26},"mash");return s}a(y,"Mash"),g&&g.exports?g.exports=E:d&&d.amd?d(function(){return E}):this.alea=E})(V,l,!1)})(Te);var Oe={exports:{}};(function(l){(function(_,g,d){function w(y){var i=this,s="";i.x=0,i.y=0,i.z=0,i.w=0,i.next=function(){var o=i.x^i.x<<11;return i.x=i.y,i.y=i.z,i.z=i.w,i.w^=i.w>>>19^o^o>>>8},y===(y|0)?i.x=y:s+=y;for(var p=0;p<s.length+64;p++)i.x^=s.charCodeAt(p)|0,i.next()}a(w,"XorGen");function I(y,i){return i.x=y.x,i.y=y.y,i.z=y.z,i.w=y.w,i}a(I,"copy");function E(y,i){var s=new w(y),p=i&&i.state,o=a(function(){return(s.next()>>>0)/4294967296},"prng");return o.double=function(){do var u=s.next()>>>11,v=(s.next()>>>0)/4294967296,A=(u+v)/(1<<21);while(A===0);return A},o.int32=s.next,o.quick=o,p&&(typeof p=="object"&&I(p,s),o.state=function(){return I(s,{})}),o}a(E,"impl"),g&&g.exports?g.exports=E:d&&d.amd?d(function(){return E}):this.xor128=E})(V,l,!1)})(Oe);var Be={exports:{}};(function(l){(function(_,g,d){function w(y){var i=this,s="";i.next=function(){var o=i.x^i.x>>>2;return i.x=i.y,i.y=i.z,i.z=i.w,i.w=i.v,(i.d=i.d+362437|0)+(i.v=i.v^i.v<<4^(o^o<<1))|0},i.x=0,i.y=0,i.z=0,i.w=0,i.v=0,y===(y|0)?i.x=y:s+=y;for(var p=0;p<s.length+64;p++)i.x^=s.charCodeAt(p)|0,p==s.length&&(i.d=i.x<<10^i.x>>>4),i.next()}a(w,"XorGen");function I(y,i){return i.x=y.x,i.y=y.y,i.z=y.z,i.w=y.w,i.v=y.v,i.d=y.d,i}a(I,"copy");function E(y,i){var s=new w(y),p=i&&i.state,o=a(function(){return(s.next()>>>0)/4294967296},"prng");return o.double=function(){do var u=s.next()>>>11,v=(s.next()>>>0)/4294967296,A=(u+v)/(1<<21);while(A===0);return A},o.int32=s.next,o.quick=o,p&&(typeof p=="object"&&I(p,s),o.state=function(){return I(s,{})}),o}a(E,"impl"),g&&g.exports?g.exports=E:d&&d.amd?d(function(){return E}):this.xorwow=E})(V,l,!1)})(Be);var Pe={exports:{}};(function(l){(function(_,g,d){function w(y){var i=this;i.next=function(){var p=i.x,o=i.i,u,v;return u=p[o],u^=u>>>7,v=u^u<<24,u=p[o+1&7],v^=u^u>>>10,u=p[o+3&7],v^=u^u>>>3,u=p[o+4&7],v^=u^u<<7,u=p[o+7&7],u=u^u<<13,v^=u^u<<9,p[o]=v,i.i=o+1&7,v};function s(p,o){var u,v=[];if(o===(o|0))v[0]=o;else for(o=""+o,u=0;u<o.length;++u)v[u&7]=v[u&7]<<15^o.charCodeAt(u)+v[u+1&7]<<13;for(;v.length<8;)v.push(0);for(u=0;u<8&&v[u]===0;++u);for(u==8?v[7]=-1:v[u],p.x=v,p.i=0,u=256;u>0;--u)p.next()}a(s,"init"),s(i,y)}a(w,"XorGen");function I(y,i){return i.x=y.x.slice(),i.i=y.i,i}a(I,"copy");function E(y,i){y==null&&(y=+new Date);var s=new w(y),p=i&&i.state,o=a(function(){return(s.next()>>>0)/4294967296},"prng");return o.double=function(){do var u=s.next()>>>11,v=(s.next()>>>0)/4294967296,A=(u+v)/(1<<21);while(A===0);return A},o.int32=s.next,o.quick=o,p&&(p.x&&I(p,s),o.state=function(){return I(s,{})}),o}a(E,"impl"),g&&g.exports?g.exports=E:d&&d.amd?d(function(){return E}):this.xorshift7=E})(V,l,!1)})(Pe);var Le={exports:{}};(function(l){(function(_,g,d){function w(y){var i=this;i.next=function(){var p=i.w,o=i.X,u=i.i,v,A;return i.w=p=p+1640531527|0,A=o[u+34&127],v=o[u=u+1&127],A^=A<<13,v^=v<<17,A^=A>>>15,v^=v>>>12,A=o[u]=A^v,i.i=u,A+(p^p>>>16)|0};function s(p,o){var u,v,A,M,P,Y=[],L=128;for(o===(o|0)?(v=o,o=null):(o=o+"\0",v=0,L=Math.max(L,o.length)),A=0,M=-32;M<L;++M)o&&(v^=o.charCodeAt((M+32)%o.length)),M===0&&(P=v),v^=v<<10,v^=v>>>15,v^=v<<4,v^=v>>>13,M>=0&&(P=P+1640531527|0,u=Y[M&127]^=v+P,A=u==0?A+1:0);for(A>=128&&(Y[(o&&o.length||0)&127]=-1),A=127,M=4*128;M>0;--M)v=Y[A+34&127],u=Y[A=A+1&127],v^=v<<13,u^=u<<17,v^=v>>>15,u^=u>>>12,Y[A]=v^u;p.w=P,p.X=Y,p.i=A}a(s,"init"),s(i,y)}a(w,"XorGen");function I(y,i){return i.i=y.i,i.w=y.w,i.X=y.X.slice(),i}a(I,"copy");function E(y,i){y==null&&(y=+new Date);var s=new w(y),p=i&&i.state,o=a(function(){return(s.next()>>>0)/4294967296},"prng");return o.double=function(){do var u=s.next()>>>11,v=(s.next()>>>0)/4294967296,A=(u+v)/(1<<21);while(A===0);return A},o.int32=s.next,o.quick=o,p&&(p.X&&I(p,s),o.state=function(){return I(s,{})}),o}a(E,"impl"),g&&g.exports?g.exports=E:d&&d.amd?d(function(){return E}):this.xor4096=E})(V,l,!1)})(Le);var Me={exports:{}};(function(l){(function(_,g,d){function w(y){var i=this,s="";i.next=function(){var o=i.b,u=i.c,v=i.d,A=i.a;return o=o<<25^o>>>7^u,u=u-v|0,v=v<<24^v>>>8^A,A=A-o|0,i.b=o=o<<20^o>>>12^u,i.c=u=u-v|0,i.d=v<<16^u>>>16^A,i.a=A-o|0},i.a=0,i.b=0,i.c=-1640531527,i.d=1367130551,y===Math.floor(y)?(i.a=y/4294967296|0,i.b=y|0):s+=y;for(var p=0;p<s.length+20;p++)i.b^=s.charCodeAt(p)|0,i.next()}a(w,"XorGen");function I(y,i){return i.a=y.a,i.b=y.b,i.c=y.c,i.d=y.d,i}a(I,"copy");function E(y,i){var s=new w(y),p=i&&i.state,o=a(function(){return(s.next()>>>0)/4294967296},"prng");return o.double=function(){do var u=s.next()>>>11,v=(s.next()>>>0)/4294967296,A=(u+v)/(1<<21);while(A===0);return A},o.int32=s.next,o.quick=o,p&&(typeof p=="object"&&I(p,s),o.state=function(){return I(s,{})}),o}a(E,"impl"),g&&g.exports?g.exports=E:d&&d.amd?d(function(){return E}):this.tychei=E})(V,l,!1)})(Me);var Fe={exports:{}},hr={},yr=Object.freeze({__proto__:null,default:hr}),pr=pe(yr);(function(l){(function(_,g,d){var w=256,I=6,E=52,y="random",i=d.pow(w,I),s=d.pow(2,E),p=s*2,o=w-1,u;function v(O,m,C){var D=[];m=m==!0?{entropy:!0}:m||{};var T=Y(P(m.entropy?[O,Q(g)]:O==null?L():O,3),D),F=new A(D),U=a(function(){for(var j=F.g(I),W=i,k=0;j<s;)j=(j+k)*w,W*=w,k=F.g(1);for(;j>=p;)j/=2,W/=2,k>>>=1;return(j+k)/W},"prng");return U.int32=function(){return F.g(4)|0},U.quick=function(){return F.g(4)/4294967296},U.double=U,Y(Q(F.S),g),(m.pass||C||function(j,W,k,K){return K&&(K.S&&M(K,F),j.state=function(){return M(F,{})}),k?(d[y]=j,W):j})(U,T,"global"in m?m.global:this==d,m.state)}a(v,"seedrandom");function A(O){var m,C=O.length,D=this,T=0,F=D.i=D.j=0,U=D.S=[];for(C||(O=[C++]);T<w;)U[T]=T++;for(T=0;T<w;T++)U[T]=U[F=o&F+O[T%C]+(m=U[T])],U[F]=m;(D.g=function(j){for(var W,k=0,K=D.i,Z=D.j,ee=D.S;j--;)W=ee[K=o&K+1],k=k*w+ee[o&(ee[K]=ee[Z=o&Z+W])+(ee[Z]=W)];return D.i=K,D.j=Z,k})(w)}a(A,"ARC4");function M(O,m){return m.i=O.i,m.j=O.j,m.S=O.S.slice(),m}a(M,"copy");function P(O,m){var C=[],D=typeof O,T;if(m&&D=="object")for(T in O)try{C.push(P(O[T],m-1))}catch{}return C.length?C:D=="string"?O:O+"\0"}a(P,"flatten");function Y(O,m){for(var C=O+"",D,T=0;T<C.length;)m[o&T]=o&(D^=m[o&T]*19)+C.charCodeAt(T++);return Q(m)}a(Y,"mixkey");function L(){try{var O;return u&&(O=u.randomBytes)?O=O(w):(O=new Uint8Array(w),(_.crypto||_.msCrypto).getRandomValues(O)),Q(O)}catch{var m=_.navigator,C=m&&m.plugins;return[+new Date,_,C,_.screen,Q(g)]}}a(L,"autoseed");function Q(O){return String.fromCharCode.apply(0,O)}if(a(Q,"tostring"),Y(d.random(),g),l.exports){l.exports=v;try{u=pr}catch{}}else d["seed"+y]=v})(typeof self<"u"?self:V,[],Math)})(Fe);var gr=Te.exports,mr=Oe.exports,br=Be.exports,wr=Pe.exports,_r=Le.exports,xr=Me.exports,ie=Fe.exports;ie.alea=gr,ie.xor128=mr,ie.xorwow=br,ie.xorshift7=wr,ie.xor4096=_r,ie.tychei=xr;var Sr=ie;function*$e(l,_){let g=0;for(const d of _)g++<l||(yield d)}a($e,"skip");var ze=a(l=>{const _=Sr(l),g={chooseOne(d){if(d instanceof Map||d instanceof Set){const w=Math.floor(_()*d.size),{value:I}=$e(w,d.keys()).next();return I}else{const w=d instanceof Array?d:[...d];return w[Math.floor(_()*w.length)]}},removeOne(d){if(d instanceof Map){const w=g.chooseOne(d),I=d.get(w);return d.delete(w),I}else if(d instanceof Set){const w=g.chooseOne(d);return d.delete(w),w}else{const w=Math.floor(_()*d.length),I=d[w];return d.splice(w,1),I}},*randomIterator(d){if(d instanceof Map||d instanceof Set){const w=Math.floor(_()*d.size);yield*$e(w,d.keys())}else{const w=d instanceof Array?d:[...d],I=Math.floor(_()*w.length);for(let E=0;E<w.length;E++)yield w[(I+E)%w.length]}}};return g},"Random");function*Er(l,_,g){for(const d of me(l,_)){const{coordinate:w}=d,I=g.has(G(w));yield{neighbour:d,connected:I}}}a(Er,"PartitionNeighbours");const Ue=a((l,_,g)=>{var d;(d=l[_])!=null||(l[_]=0),l[_]|=g},"addConnection");function*Ir({size:l,seed:_}){const{chooseOne:g,removeOne:d}=ze(_),w=[...Ye(l)],I={},E=new Set,y=new Map,i=g(w);E.add(G(i));for(const{coordinate:s}of me(l,i))y.set(G(s),s);for(;E.size<w.length;){if(y.size===0)throw new Error("working set unexpectedly empty");const s=d(y),p=G(s),o=[...Er(l,s,E)],u=o.filter(({connected:L})=>L),{neighbour:{coordinate:v,direction:A}}=g(u),{forwards:M,backwards:P}=We(A),Y=G(v);Ue(I,p,M),Ue(I,Y,P),E.add(p);for(const{neighbour:{coordinate:L}}of o.filter(({connected:Q})=>!Q))y.set(G(L),L)}for(const s of w){const p=I[G(s)],o=g(Ce),u=je(p);yield{coordinate:s,orientation:o,connection:u}}}a(Ir,"Prims");function*Rr({size:l,seed:_}){const{chooseOne:g,randomIterator:d,removeOne:w}=ze(_),I=a((p,o)=>d(me(p,o)).next().value,"RandomNeighbour"),E=a((p,o)=>{const u=new Map,v=G(p);let A=[{key:v,coordinate:p,forwards:0,backwards:0}];for(u.set(v,p);;){const M=A.at(-1).coordinate,{coordinate:P,direction:Y}=I(l,M),L=G(P);if(u.has(L)){const O=A.findIndex(({key:m})=>m===L)+1;for(let m=O;m<A.length;m++){const{key:C}=A[m];u.delete(C)}A=A.slice(0,O);continue}else{const{forwards:O,backwards:m}=We(Y);if(A.at(-1).forwards=O,A.push({key:L,coordinate:P,forwards:0,backwards:m}),!o.has(L))return A;u.set(L,P)}}},"loopErasedRandomWalk"),y=[...Ye(l)],i={},s=new Map;for(const p of y)s.set(G(p),p);for(w(s);s.size>0;){const p=w(s),o=E(p,s);for(const{key:u,forwards:v,backwards:A}of o)s.delete(u),i[u]|=v|A}for(const p of y){const o=i[G(p)],u=g(Ce),v=je(o);yield{coordinate:p,orientation:u,connection:v}}}a(Rr,"Wilsons");const je=a(l=>{if(l===0)throw new Error("connection cannot be empty");if(l===63)return 63;for(;!(l&32)||l&1;){const g=l&32;l<<=1,l&=63,g&&(l|=1)}const _=(l&30)>>1;switch(_){case 0:return 32;case 8:return 48;case 4:return 40;case 2:return 36;case 1:return 40;case 12:return 56;case 6:return 44;case 3:return 52;case 9:return 44;case 10:return 52;case 5:return 42;case 14:return 60;case 7:return 46;case 11:return 54;case 13:return 46;case 15:return 62;default:throw new Error(`unhandled truncated case ${_.toString(2)} from connection ${l.toString(2)}`)}},"normalizeConnection");function*Ar({q:l,r:_,s:g}){yield{coordinate:{q:l,r:_-1,s:g+1},direction:0},yield{coordinate:{q:l+1,r:_-1,s:g},direction:1},yield{coordinate:{q:l+1,r:_,s:g-1},direction:2},yield{coordinate:{q:l,r:_+1,s:g-1},direction:3},yield{coordinate:{q:l-1,r:_+1,s:g},direction:4},yield{coordinate:{q:l-1,r:_,s:g+1},direction:5}}a(Ar,"Neighbours$1");function*me(l,_){for(const g of Ar(_)){const{coordinate:{q:d,r:w,s:I}}=g;d<-l||d>l||w<-l||w>l||I<-l||I>l||(yield g)}}a(me,"ValidNeighbours");function*Ye(l){for(let _=-l;_<=l;_++)for(let g=-l;g<=l;g++){const d=-_-g;-l<=d&&d<=l&&(yield{q:_,r:g,s:d})}}a(Ye,"CoordinatesGenerator");const We=a(l=>({forwards:32>>l,backwards:32>>(l+3)%6}),"asConnections");function*Nr(l){const{mode:_}=l;switch(_){case"prims":yield*Ir(l);return;case"wilsons":yield*Rr(l);return}}a(Nr,"PuzzleGenerator");const be=ge.exports.createInstance({driver:ge.exports.INDEXEDDB,name:"hexpanse",version:1,storeName:"gameState"}),we=a(l=>{postMessage(l)},"reply");let de,ve,J;onmessage=a(async({data:l})=>{switch(l.type){case"restore":{de=l.config,ve=vr(de);const _=await be.getItem(ve);if(_)J=_;else{J={};for(const{coordinate:g,orientation:d,connection:w}of Nr(de))J[G(g)]={coordinate:g,orientation:d,connection:w,color:"none"};await be.setItem(ve,J)}we({type:"restored",config:de,state:J}),ne={};for(const g of Object.keys(J))Xe(g);ke();return}case"update cell":{const{coordinate:_,orientation:g}=l,d=G(_),w=J[d];w&&(w.orientation=g,await be.setItem(ve,J),delete ne[d],Xe(d),ke());return}}},"onmessage");const ae=a((l,_,g)=>{for(l.q-=g.q,l.r-=g.r,l.s-=g.s;_>0;)l={q:-l.r,r:-l.s,s:-l.q},_-=60;return l.q+=g.q,l.r+=g.r,l.s+=g.s,l},"rotate");function*Dr(l,_,g){const{q:d,r:w,s:I}=l;g&32&&(yield ae({q:d+1,r:w,s:I-1},_,l)),g&16&&(yield ae({q:d,r:w+1,s:I-1},_,l)),g&8&&(yield ae({q:d-1,r:w+1,s:I},_,l)),g&4&&(yield ae({q:d-1,r:w,s:I+1},_,l)),g&2&&(yield ae({q:d,r:w-1,s:I+1},_,l)),g&1&&(yield ae({q:d+1,r:w-1,s:I},_,l))}a(Dr,"Neighbours");let ne;const Xe=a(l=>{var w;const{coordinate:_,orientation:g,connection:d}=J[l];for(const I of Dr(_,g,d)){const E=G(I);!J[E]||((w=ne[l])!=null||(ne[l]=new Set),ne[l].add(E))}},"updateFacingNeighbours"),Cr=a(l=>{var d;const _={none:0,red:0,green:0,blue:0};for(const w of l){const{color:I}=J[w];I&&(_[I]=((d=_[I])!=null?d:0)+1)}const{color:g}=Object.entries(_).reduce((w,[I,E])=>w.count>E?w:{color:I,count:E},{color:"none",count:0});return g},"mostCommonColor"),Tr=a(l=>Object.entries(l),"entries"),ke=a(()=>{var o;let l=0;const _={},g=a((u,v)=>{var M;if(_[u])return;_[u]=v;const A=ne[u];if(A)for(const P of A)(M=ne[P])!=null&&M.has(u)&&g(P,v)},"floodFill");for(const u of Object.keys(J))g(u,++l);const d={};for(const[u,v]of Object.entries(_))(o=d[v])!=null||(d[v]=new Set),d[v].add(u);if(Object.values(d).length===1)return we({type:"game over"});const w=["none","red","green","blue"],I=new Set(w);I.delete("none");const E={none:new Set,red:new Set,green:new Set,blue:new Set},y=Object.values(d).sort((u,v)=>v.size-u.size),i=[],s=[];for(const u of y)u.size>1&&i.length<I.size?i.push(u):s.push(u);for(const u of i){const v=Cr(u);I.has(v)?(E[v]=u,I.delete(v)):s.unshift(u)}let p=0;for(const u of I){if(p>=s.length)break;const v=s[p];if(v.size<=1)break;E[u]=v,p+=1}for(const u of s.slice(p))for(const v of u)E.none.add(v);we({type:"coloring",colors:E});for(const[u,v]of Tr(E))for(const A of v)J[A].color=u},"updateSpan")})();
