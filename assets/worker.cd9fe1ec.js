var Tn=Object.defineProperty;var f=(J,pe)=>Tn(J,"name",{value:pe,configurable:!0});(function(){"use strict";var J=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pe(l){var S=l.default;if(typeof S=="function"){var y=f(function(){return S.apply(this,arguments)},"a");y.prototype=S.prototype}else y={};return Object.defineProperty(y,"__esModule",{value:!0}),Object.keys(l).forEach(function(d){var _=Object.getOwnPropertyDescriptor(l,d);Object.defineProperty(y,d,_.get?_:{enumerable:!0,get:function(){return l[d]}})}),y}f(pe,"getAugmentedNamespace");var vr=f(function(l,S){S||(S={}),typeof S=="function"&&(S={cmp:S});var y=typeof S.cycles=="boolean"?S.cycles:!1,d=S.cmp&&function(I){return function(E){return function(h,o){var s={key:h,value:E[h]},p={key:o,value:E[o]};return I(s,p)}}}(S.cmp),_=[];return f(function I(E){if(E&&E.toJSON&&typeof E.toJSON=="function"&&(E=E.toJSON()),E!==void 0){if(typeof E=="number")return isFinite(E)?""+E:"null";if(typeof E!="object")return JSON.stringify(E);var h,o;if(Array.isArray(E)){for(o="[",h=0;h<E.length;h++)h&&(o+=","),o+=I(E[h])||"null";return o+"]"}if(E===null)return"null";if(_.indexOf(E)!==-1){if(y)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=_.push(E)-1,p=Object.keys(E).sort(d&&d(E));for(o="",h=0;h<p.length;h++){var a=p[h],c=I(E[a]);!c||(o&&(o+=","),o+=JSON.stringify(a)+":"+c)}return _.splice(s,1),"{"+o+"}"}},"stringify")(l)},"fastJsonStableStringify");function le(l){throw new Error('Could not dynamically require "'+l+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}f(le,"commonjsRequire");var ge={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(l,S){(function(y){l.exports=y()})(function(){return f(function y(d,_,I){function E(s,p){if(!_[s]){if(!d[s]){var a=typeof le=="function"&&le;if(!p&&a)return a(s,!0);if(h)return h(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var b=_[s]={exports:{}};d[s][0].call(b.exports,function(A){var $=d[s][1][A];return E($||A)},b,b.exports,y,d,_,I)}return _[s].exports}f(E,"s");for(var h=typeof le=="function"&&le,o=0;o<I.length;o++)E(I[o]);return E},"e")({1:[function(y,d,_){(function(I){var E=I.MutationObserver||I.WebKitMutationObserver,h;if(E){var o=0,s=new E(A),p=I.document.createTextNode("");s.observe(p,{characterData:!0}),h=f(function(){p.data=o=++o%2},"scheduleDrain")}else if(!I.setImmediate&&typeof I.MessageChannel<"u"){var a=new I.MessageChannel;a.port1.onmessage=A,h=f(function(){a.port2.postMessage(0)},"scheduleDrain")}else"document"in I&&"onreadystatechange"in I.document.createElement("script")?h=f(function(){var L=I.document.createElement("script");L.onreadystatechange=function(){A(),L.onreadystatechange=null,L.parentNode.removeChild(L),L=null},I.document.documentElement.appendChild(L)},"scheduleDrain"):h=f(function(){setTimeout(A,0)},"scheduleDrain");var c,b=[];function A(){c=!0;for(var L,Y,P=b.length;P;){for(Y=b,b=[],L=-1;++L<P;)Y[L]();P=b.length}c=!1}f(A,"nextTick"),d.exports=$;function $(L){b.push(L)===1&&!c&&h()}f($,"immediate")}).call(this,typeof J<"u"?J:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(y,d,_){var I=y(1);function E(){}f(E,"INTERNAL");var h={},o=["REJECTED"],s=["FULFILLED"],p=["PENDING"];d.exports=a;function a(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,g!==E&&$(this,g)}f(a,"Promise"),a.prototype.catch=function(g){return this.then(null,g)},a.prototype.then=function(g,T){if(typeof g!="function"&&this.state===s||typeof T!="function"&&this.state===o)return this;var D=new this.constructor(E);if(this.state!==p){var C=this.state===s?g:T;b(D,C,this.outcome)}else this.queue.push(new c(D,g,T));return D};function c(g,T,D){this.promise=g,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof D=="function"&&(this.onRejected=D,this.callRejected=this.otherCallRejected)}f(c,"QueueItem"),c.prototype.callFulfilled=function(g){h.resolve(this.promise,g)},c.prototype.otherCallFulfilled=function(g){b(this.promise,this.onFulfilled,g)},c.prototype.callRejected=function(g){h.reject(this.promise,g)},c.prototype.otherCallRejected=function(g){b(this.promise,this.onRejected,g)};function b(g,T,D){I(function(){var C;try{C=T(D)}catch(M){return h.reject(g,M)}C===g?h.reject(g,new TypeError("Cannot resolve promise with itself")):h.resolve(g,C)})}f(b,"unwrap"),h.resolve=function(g,T){var D=L(A,T);if(D.status==="error")return h.reject(g,D.value);var C=D.value;if(C)$(g,C);else{g.state=s,g.outcome=T;for(var M=-1,j=g.queue.length;++M<j;)g.queue[M].callFulfilled(T)}return g},h.reject=function(g,T){g.state=o,g.outcome=T;for(var D=-1,C=g.queue.length;++D<C;)g.queue[D].callRejected(T);return g};function A(g){var T=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof T=="function")return f(function(){T.apply(g,arguments)},"appyThen")}f(A,"getThen");function $(g,T){var D=!1;function C(W){D||(D=!0,h.reject(g,W))}f(C,"onError");function M(W){D||(D=!0,h.resolve(g,W))}f(M,"onSuccess");function j(){T(M,C)}f(j,"tryToUnwrap");var z=L(j);z.status==="error"&&C(z.value)}f($,"safelyResolveThenable");function L(g,T){var D={};try{D.value=g(T),D.status="success"}catch(C){D.status="error",D.value=C}return D}f(L,"tryCatch"),a.resolve=Y;function Y(g){return g instanceof this?g:h.resolve(new this(E),g)}f(Y,"resolve"),a.reject=P;function P(g){var T=new this(E);return h.reject(T,g)}f(P,"reject"),a.all=K;function K(g){var T=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=g.length,C=!1;if(!D)return this.resolve([]);for(var M=new Array(D),j=0,z=-1,W=new this(E);++z<D;)q(g[z],z);return W;function q(V,Z){T.resolve(V).then(ee,function(fe){C||(C=!0,h.reject(W,fe))});function ee(fe){M[Z]=fe,++j===D&&!C&&(C=!0,h.resolve(W,M))}f(ee,"resolveFromAll")}}f(K,"all"),a.race=O;function O(g){var T=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=g.length,C=!1;if(!D)return this.resolve([]);for(var M=-1,j=new this(E);++M<D;)z(g[M]);return j;function z(W){T.resolve(W).then(function(q){C||(C=!0,h.resolve(j,q))},function(q){C||(C=!0,h.reject(j,q))})}}f(O,"race")},{1:1}],3:[function(y,d,_){(function(I){typeof I.Promise!="function"&&(I.Promise=y(2))}).call(this,typeof J<"u"?J:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(y,d,_){var I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function E(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}f(E,"_classCallCheck");function h(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}f(h,"getIDB");var o=h();function s(){try{if(!o||!o.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}f(s,"isIndexedDBValid");function p(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(t){if(t.name!=="TypeError")throw t;for(var r=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,i=new r,u=0;u<e.length;u+=1)i.append(e[u]);return i.getBlob(n.type)}}f(p,"createBlob"),typeof Promise>"u"&&y(3);var a=Promise;function c(e,n){n&&e.then(function(r){n(null,r)},function(r){n(r)})}f(c,"executeCallback");function b(e,n,r){typeof n=="function"&&e.then(n),typeof r=="function"&&e.catch(r)}f(b,"executeTwoCallbacks");function A(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}f(A,"normalizeKey");function $(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}f($,"getCallback");var L="local-forage-detect-blob-support",Y=void 0,P={},K=Object.prototype.toString,O="readonly",g="readwrite";function T(e){for(var n=e.length,r=new ArrayBuffer(n),i=new Uint8Array(r),u=0;u<n;u++)i[u]=e.charCodeAt(u);return r}f(T,"_binStringToArrayBuffer");function D(e){return new a(function(n){var r=e.transaction(L,g),i=p([""]);r.objectStore(L).put(i,"key"),r.onabort=function(u){u.preventDefault(),u.stopPropagation(),n(!1)},r.oncomplete=function(){var u=navigator.userAgent.match(/Chrome\/(\d+)/),t=navigator.userAgent.match(/Edge\//);n(t||!u||parseInt(u[1],10)>=43)}}).catch(function(){return!1})}f(D,"_checkBlobSupportWithoutCaching");function C(e){return typeof Y=="boolean"?a.resolve(Y):D(e).then(function(n){return Y=n,Y})}f(C,"_checkBlobSupport");function M(e){var n=P[e.name],r={};r.promise=new a(function(i,u){r.resolve=i,r.reject=u}),n.deferredOperations.push(r),n.dbReady?n.dbReady=n.dbReady.then(function(){return r.promise}):n.dbReady=r.promise}f(M,"_deferReadiness");function j(e){var n=P[e.name],r=n.deferredOperations.pop();if(r)return r.resolve(),r.promise}f(j,"_advanceReadiness");function z(e,n){var r=P[e.name],i=r.deferredOperations.pop();if(i)return i.reject(n),i.promise}f(z,"_rejectReadiness");function W(e,n){return new a(function(r,i){if(P[e.name]=P[e.name]||Ge(),e.db)if(n)M(e),e.db.close();else return r(e.db);var u=[e.name];n&&u.push(e.version);var t=o.open.apply(o,u);n&&(t.onupgradeneeded=function(v){var m=t.result;try{m.createObjectStore(e.storeName),v.oldVersion<=1&&m.createObjectStore(L)}catch(w){if(w.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+v.oldVersion+" to version "+v.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw w}}),t.onerror=function(v){v.preventDefault(),i(t.error)},t.onsuccess=function(){var v=t.result;v.onversionchange=function(m){m.target.close()},r(v),j(e)}})}f(W,"_getConnection");function q(e){return W(e,!1)}f(q,"_getOriginalConnection");function V(e){return W(e,!0)}f(V,"_getUpgradedConnection");function Z(e,n){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),i=e.version<e.db.version,u=e.version>e.db.version;if(i&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),u||r){if(r){var t=e.db.version+1;t>e.version&&(e.version=t)}return!0}return!1}f(Z,"_isUpgradeNeeded");function ee(e){return new a(function(n,r){var i=new FileReader;i.onerror=r,i.onloadend=function(u){var t=btoa(u.target.result||"");n({__local_forage_encoded_blob:!0,data:t,type:e.type})},i.readAsBinaryString(e)})}f(ee,"_encodeBlob");function fe(e){var n=T(atob(e.data));return p([n],{type:e.type})}f(fe,"_decodeBlob");function ke(e){return e&&e.__local_forage_encoded_blob}f(ke,"_isEncodedBlob");function Tr(e){var n=this,r=n._initReady().then(function(){var i=P[n._dbInfo.name];if(i&&i.dbReady)return i.dbReady});return b(r,e,e),r}f(Tr,"_fullyReady");function Cr(e){M(e);for(var n=P[e.name],r=n.forages,i=0;i<r.length;i++){var u=r[i];u._dbInfo.db&&(u._dbInfo.db.close(),u._dbInfo.db=null)}return e.db=null,q(e).then(function(t){return e.db=t,Z(e)?V(e):t}).then(function(t){e.db=n.db=t;for(var v=0;v<r.length;v++)r[v]._dbInfo.db=t}).catch(function(t){throw z(e,t),t})}f(Cr,"_tryReconnect");function re(e,n,r,i){i===void 0&&(i=1);try{var u=e.db.transaction(e.storeName,n);r(null,u)}catch(t){if(i>0&&(!e.db||t.name==="InvalidStateError"||t.name==="NotFoundError"))return a.resolve().then(function(){if(!e.db||t.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),V(e)}).then(function(){return Cr(e).then(function(){re(e,n,r,i-1)})}).catch(r);r(t)}}f(re,"createTransaction");function Ge(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}f(Ge,"createDbContext");function Or(e){var n=this,r={db:null};if(e)for(var i in e)r[i]=e[i];var u=P[r.name];u||(u=Ge(),P[r.name]=u),u.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=Tr);var t=[];function v(){return a.resolve()}f(v,"ignoreErrors");for(var m=0;m<u.forages.length;m++){var w=u.forages[m];w!==n&&t.push(w._initReady().catch(v))}var x=u.forages.slice(0);return a.all(t).then(function(){return r.db=u.db,q(r)}).then(function(R){return r.db=R,Z(r,n._defaultConfig.version)?V(r):R}).then(function(R){r.db=u.db=R,n._dbInfo=r;for(var N=0;N<x.length;N++){var B=x[N];B!==n&&(B._dbInfo.db=r.db,B._dbInfo.version=r.version)}})}f(Or,"_initStorage");function Br(e,n){var r=this;e=A(e);var i=new a(function(u,t){r.ready().then(function(){re(r._dbInfo,O,function(v,m){if(v)return t(v);try{var w=m.objectStore(r._dbInfo.storeName),x=w.get(e);x.onsuccess=function(){var R=x.result;R===void 0&&(R=null),ke(R)&&(R=fe(R)),u(R)},x.onerror=function(){t(x.error)}}catch(R){t(R)}})}).catch(t)});return c(i,n),i}f(Br,"getItem");function Pr(e,n){var r=this,i=new a(function(u,t){r.ready().then(function(){re(r._dbInfo,O,function(v,m){if(v)return t(v);try{var w=m.objectStore(r._dbInfo.storeName),x=w.openCursor(),R=1;x.onsuccess=function(){var N=x.result;if(N){var B=N.value;ke(B)&&(B=fe(B));var F=e(B,N.key,R++);F!==void 0?u(F):N.continue()}else u()},x.onerror=function(){t(x.error)}}catch(N){t(N)}})}).catch(t)});return c(i,n),i}f(Pr,"iterate");function Lr(e,n,r){var i=this;e=A(e);var u=new a(function(t,v){var m;i.ready().then(function(){return m=i._dbInfo,K.call(n)==="[object Blob]"?C(m.db).then(function(w){return w?n:ee(n)}):n}).then(function(w){re(i._dbInfo,g,function(x,R){if(x)return v(x);try{var N=R.objectStore(i._dbInfo.storeName);w===null&&(w=void 0);var B=N.put(w,e);R.oncomplete=function(){w===void 0&&(w=null),t(w)},R.onabort=R.onerror=function(){var F=B.error?B.error:B.transaction.error;v(F)}}catch(F){v(F)}})}).catch(v)});return c(u,r),u}f(Lr,"setItem");function Mr(e,n){var r=this;e=A(e);var i=new a(function(u,t){r.ready().then(function(){re(r._dbInfo,g,function(v,m){if(v)return t(v);try{var w=m.objectStore(r._dbInfo.storeName),x=w.delete(e);m.oncomplete=function(){u()},m.onerror=function(){t(x.error)},m.onabort=function(){var R=x.error?x.error:x.transaction.error;t(R)}}catch(R){t(R)}})}).catch(t)});return c(i,n),i}f(Mr,"removeItem");function Fr(e){var n=this,r=new a(function(i,u){n.ready().then(function(){re(n._dbInfo,g,function(t,v){if(t)return u(t);try{var m=v.objectStore(n._dbInfo.storeName),w=m.clear();v.oncomplete=function(){i()},v.onabort=v.onerror=function(){var x=w.error?w.error:w.transaction.error;u(x)}}catch(x){u(x)}})}).catch(u)});return c(r,e),r}f(Fr,"clear");function $r(e){var n=this,r=new a(function(i,u){n.ready().then(function(){re(n._dbInfo,O,function(t,v){if(t)return u(t);try{var m=v.objectStore(n._dbInfo.storeName),w=m.count();w.onsuccess=function(){i(w.result)},w.onerror=function(){u(w.error)}}catch(x){u(x)}})}).catch(u)});return c(r,e),r}f($r,"length");function Ur(e,n){var r=this,i=new a(function(u,t){if(e<0){u(null);return}r.ready().then(function(){re(r._dbInfo,O,function(v,m){if(v)return t(v);try{var w=m.objectStore(r._dbInfo.storeName),x=!1,R=w.openKeyCursor();R.onsuccess=function(){var N=R.result;if(!N){u(null);return}e===0||x?u(N.key):(x=!0,N.advance(e))},R.onerror=function(){t(R.error)}}catch(N){t(N)}})}).catch(t)});return c(i,n),i}f(Ur,"key");function jr(e){var n=this,r=new a(function(i,u){n.ready().then(function(){re(n._dbInfo,O,function(t,v){if(t)return u(t);try{var m=v.objectStore(n._dbInfo.storeName),w=m.openKeyCursor(),x=[];w.onsuccess=function(){var R=w.result;if(!R){i(x);return}x.push(R.key),R.continue()},w.onerror=function(){u(w.error)}}catch(R){u(R)}})}).catch(u)});return c(r,e),r}f(jr,"keys");function zr(e,n){n=$.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var i=this,u;if(!e.name)u=a.reject("Invalid arguments");else{var t=e.name===r.name&&i._dbInfo.db,v=t?a.resolve(i._dbInfo.db):q(e).then(function(m){var w=P[e.name],x=w.forages;w.db=m;for(var R=0;R<x.length;R++)x[R]._dbInfo.db=m;return m});e.storeName?u=v.then(function(m){if(!!m.objectStoreNames.contains(e.storeName)){var w=m.version+1;M(e);var x=P[e.name],R=x.forages;m.close();for(var N=0;N<R.length;N++){var B=R[N];B._dbInfo.db=null,B._dbInfo.version=w}var F=new a(function(U,k){var X=o.open(e.name,w);X.onerror=function(Q){var se=X.result;se.close(),k(Q)},X.onupgradeneeded=function(){var Q=X.result;Q.deleteObjectStore(e.storeName)},X.onsuccess=function(){var Q=X.result;Q.close(),U(Q)}});return F.then(function(U){x.db=U;for(var k=0;k<R.length;k++){var X=R[k];X._dbInfo.db=U,j(X._dbInfo)}}).catch(function(U){throw(z(e,U)||a.resolve()).catch(function(){}),U})}}):u=v.then(function(m){M(e);var w=P[e.name],x=w.forages;m.close();for(var R=0;R<x.length;R++){var N=x[R];N._dbInfo.db=null}var B=new a(function(F,U){var k=o.deleteDatabase(e.name);k.onerror=function(){var X=k.result;X&&X.close(),U(k.error)},k.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},k.onsuccess=function(){var X=k.result;X&&X.close(),F(X)}});return B.then(function(F){w.db=F;for(var U=0;U<x.length;U++){var k=x[U];j(k._dbInfo)}}).catch(function(F){throw(z(e,F)||a.resolve()).catch(function(){}),F})})}return c(u,n),u}f(zr,"dropInstance");var Yr={_driver:"asyncStorage",_initStorage:Or,_support:s(),iterate:Pr,getItem:Br,setItem:Lr,removeItem:Mr,clear:Fr,length:$r,key:Ur,keys:jr,dropInstance:zr};function Wr(){return typeof openDatabase=="function"}f(Wr,"isWebSQLValid");var te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Xr="~~local_forage_type~",Ve=/^~~local_forage_type~([^~]+)~/,he="__lfsc__:",we=he.length,_e="arbf",xe="blob",Je="si08",Ke="ui08",Qe="uic8",He="si16",Ze="si32",er="ur16",rr="ui32",nr="fl32",tr="fl64",or=we+_e.length,ir=Object.prototype.toString;function ar(e){var n=e.length*.75,r=e.length,i,u=0,t,v,m,w;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var x=new ArrayBuffer(n),R=new Uint8Array(x);for(i=0;i<r;i+=4)t=te.indexOf(e[i]),v=te.indexOf(e[i+1]),m=te.indexOf(e[i+2]),w=te.indexOf(e[i+3]),R[u++]=t<<2|v>>4,R[u++]=(v&15)<<4|m>>2,R[u++]=(m&3)<<6|w&63;return x}f(ar,"stringToBuffer");function Se(e){var n=new Uint8Array(e),r="",i;for(i=0;i<n.length;i+=3)r+=te[n[i]>>2],r+=te[(n[i]&3)<<4|n[i+1]>>4],r+=te[(n[i+1]&15)<<2|n[i+2]>>6],r+=te[n[i+2]&63];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}f(Se,"bufferToString");function qr(e,n){var r="";if(e&&(r=ir.call(e)),e&&(r==="[object ArrayBuffer]"||e.buffer&&ir.call(e.buffer)==="[object ArrayBuffer]")){var i,u=he;e instanceof ArrayBuffer?(i=e,u+=_e):(i=e.buffer,r==="[object Int8Array]"?u+=Je:r==="[object Uint8Array]"?u+=Ke:r==="[object Uint8ClampedArray]"?u+=Qe:r==="[object Int16Array]"?u+=He:r==="[object Uint16Array]"?u+=er:r==="[object Int32Array]"?u+=Ze:r==="[object Uint32Array]"?u+=rr:r==="[object Float32Array]"?u+=nr:r==="[object Float64Array]"?u+=tr:n(new Error("Failed to get type for BinaryArray"))),n(u+Se(i))}else if(r==="[object Blob]"){var t=new FileReader;t.onload=function(){var v=Xr+e.type+"~"+Se(this.result);n(he+xe+v)},t.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(v){console.error("Couldn't convert value into a JSON string: ",e),n(null,v)}}f(qr,"serialize");function kr(e){if(e.substring(0,we)!==he)return JSON.parse(e);var n=e.substring(or),r=e.substring(we,or),i;if(r===xe&&Ve.test(n)){var u=n.match(Ve);i=u[1],n=n.substring(u[0].length)}var t=ar(n);switch(r){case _e:return t;case xe:return p([t],{type:i});case Je:return new Int8Array(t);case Ke:return new Uint8Array(t);case Qe:return new Uint8ClampedArray(t);case He:return new Int16Array(t);case er:return new Uint16Array(t);case Ze:return new Int32Array(t);case rr:return new Uint32Array(t);case nr:return new Float32Array(t);case tr:return new Float64Array(t);default:throw new Error("Unkown type: "+r)}}f(kr,"deserialize");var Ee={serialize:qr,deserialize:kr,stringToBuffer:ar,bufferToString:Se};function fr(e,n,r,i){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,i)}f(fr,"createDbTable");function Gr(e){var n=this,r={db:null};if(e)for(var i in e)r[i]=typeof e[i]!="string"?e[i].toString():e[i];var u=new a(function(t,v){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(m){return v(m)}r.db.transaction(function(m){fr(m,r,function(){n._dbInfo=r,t()},function(w,x){v(x)})},v)});return r.serializer=Ee,u}f(Gr,"_initStorage$1");function oe(e,n,r,i,u,t){e.executeSql(r,i,u,function(v,m){m.code===m.SYNTAX_ERR?v.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(w,x){x.rows.length?t(w,m):fr(w,n,function(){w.executeSql(r,i,u,t)},t)},t):t(v,m)},t)}f(oe,"tryExecuteSql");function Vr(e,n){var r=this;e=A(e);var i=new a(function(u,t){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(m){oe(m,v,"SELECT * FROM "+v.storeName+" WHERE key = ? LIMIT 1",[e],function(w,x){var R=x.rows.length?x.rows.item(0).value:null;R&&(R=v.serializer.deserialize(R)),u(R)},function(w,x){t(x)})})}).catch(t)});return c(i,n),i}f(Vr,"getItem$1");function Jr(e,n){var r=this,i=new a(function(u,t){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(m){oe(m,v,"SELECT * FROM "+v.storeName,[],function(w,x){for(var R=x.rows,N=R.length,B=0;B<N;B++){var F=R.item(B),U=F.value;if(U&&(U=v.serializer.deserialize(U)),U=e(U,F.key,B+1),U!==void 0){u(U);return}}u()},function(w,x){t(x)})})}).catch(t)});return c(i,n),i}f(Jr,"iterate$1");function ur(e,n,r,i){var u=this;e=A(e);var t=new a(function(v,m){u.ready().then(function(){n===void 0&&(n=null);var w=n,x=u._dbInfo;x.serializer.serialize(n,function(R,N){N?m(N):x.db.transaction(function(B){oe(B,x,"INSERT OR REPLACE INTO "+x.storeName+" (key, value) VALUES (?, ?)",[e,R],function(){v(w)},function(F,U){m(U)})},function(B){if(B.code===B.QUOTA_ERR){if(i>0){v(ur.apply(u,[e,w,r,i-1]));return}m(B)}})})}).catch(m)});return c(t,r),t}f(ur,"_setItem");function Kr(e,n,r){return ur.apply(this,[e,n,r,1])}f(Kr,"setItem$1");function Qr(e,n){var r=this;e=A(e);var i=new a(function(u,t){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(m){oe(m,v,"DELETE FROM "+v.storeName+" WHERE key = ?",[e],function(){u()},function(w,x){t(x)})})}).catch(t)});return c(i,n),i}f(Qr,"removeItem$1");function Hr(e){var n=this,r=new a(function(i,u){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(v){oe(v,t,"DELETE FROM "+t.storeName,[],function(){i()},function(m,w){u(w)})})}).catch(u)});return c(r,e),r}f(Hr,"clear$1");function Zr(e){var n=this,r=new a(function(i,u){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(v){oe(v,t,"SELECT COUNT(key) as c FROM "+t.storeName,[],function(m,w){var x=w.rows.item(0).c;i(x)},function(m,w){u(w)})})}).catch(u)});return c(r,e),r}f(Zr,"length$1");function en(e,n){var r=this,i=new a(function(u,t){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(m){oe(m,v,"SELECT key FROM "+v.storeName+" WHERE id = ? LIMIT 1",[e+1],function(w,x){var R=x.rows.length?x.rows.item(0).key:null;u(R)},function(w,x){t(x)})})}).catch(t)});return c(i,n),i}f(en,"key$1");function rn(e){var n=this,r=new a(function(i,u){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(v){oe(v,t,"SELECT key FROM "+t.storeName,[],function(m,w){for(var x=[],R=0;R<w.rows.length;R++)x.push(w.rows.item(R).key);i(x)},function(m,w){u(w)})})}).catch(u)});return c(r,e),r}f(rn,"keys$1");function nn(e){return new a(function(n,r){e.transaction(function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(u,t){for(var v=[],m=0;m<t.rows.length;m++)v.push(t.rows.item(m).name);n({db:e,storeNames:v})},function(u,t){r(t)})},function(i){r(i)})})}f(nn,"getAllStoreNames");function tn(e,n){n=$.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var i=this,u;return e.name?u=new a(function(t){var v;e.name===r.name?v=i._dbInfo.db:v=openDatabase(e.name,"","",0),e.storeName?t({db:v,storeNames:[e.storeName]}):t(nn(v))}).then(function(t){return new a(function(v,m){t.db.transaction(function(w){function x(F){return new a(function(U,k){w.executeSql("DROP TABLE IF EXISTS "+F,[],function(){U()},function(X,Q){k(Q)})})}f(x,"dropTable");for(var R=[],N=0,B=t.storeNames.length;N<B;N++)R.push(x(t.storeNames[N]));a.all(R).then(function(){v()}).catch(function(F){m(F)})},function(w){m(w)})})}):u=a.reject("Invalid arguments"),c(u,n),u}f(tn,"dropInstance$1");var on={_driver:"webSQLStorage",_initStorage:Gr,_support:Wr(),iterate:Jr,getItem:Vr,setItem:Kr,removeItem:Qr,clear:Hr,length:Zr,key:en,keys:rn,dropInstance:tn};function an(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}f(an,"isLocalStorageValid");function cr(e,n){var r=e.name+"/";return e.storeName!==n.storeName&&(r+=e.storeName+"/"),r}f(cr,"_getKeyPrefix");function fn(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}f(fn,"checkIfLocalStorageThrows");function un(){return!fn()||localStorage.length>0}f(un,"_isLocalStorageUsable");function cn(e){var n=this,r={};if(e)for(var i in e)r[i]=e[i];return r.keyPrefix=cr(e,n._defaultConfig),un()?(n._dbInfo=r,r.serializer=Ee,a.resolve()):a.reject()}f(cn,"_initStorage$2");function sn(e){var n=this,r=n.ready().then(function(){for(var i=n._dbInfo.keyPrefix,u=localStorage.length-1;u>=0;u--){var t=localStorage.key(u);t.indexOf(i)===0&&localStorage.removeItem(t)}});return c(r,e),r}f(sn,"clear$2");function ln(e,n){var r=this;e=A(e);var i=r.ready().then(function(){var u=r._dbInfo,t=localStorage.getItem(u.keyPrefix+e);return t&&(t=u.serializer.deserialize(t)),t});return c(i,n),i}f(ln,"getItem$2");function dn(e,n){var r=this,i=r.ready().then(function(){for(var u=r._dbInfo,t=u.keyPrefix,v=t.length,m=localStorage.length,w=1,x=0;x<m;x++){var R=localStorage.key(x);if(R.indexOf(t)===0){var N=localStorage.getItem(R);if(N&&(N=u.serializer.deserialize(N)),N=e(N,R.substring(v),w++),N!==void 0)return N}}});return c(i,n),i}f(dn,"iterate$2");function vn(e,n){var r=this,i=r.ready().then(function(){var u=r._dbInfo,t;try{t=localStorage.key(e)}catch{t=null}return t&&(t=t.substring(u.keyPrefix.length)),t});return c(i,n),i}f(vn,"key$2");function hn(e){var n=this,r=n.ready().then(function(){for(var i=n._dbInfo,u=localStorage.length,t=[],v=0;v<u;v++){var m=localStorage.key(v);m.indexOf(i.keyPrefix)===0&&t.push(m.substring(i.keyPrefix.length))}return t});return c(r,e),r}f(hn,"keys$2");function yn(e){var n=this,r=n.keys().then(function(i){return i.length});return c(r,e),r}f(yn,"length$2");function pn(e,n){var r=this;e=A(e);var i=r.ready().then(function(){var u=r._dbInfo;localStorage.removeItem(u.keyPrefix+e)});return c(i,n),i}f(pn,"removeItem$2");function gn(e,n,r){var i=this;e=A(e);var u=i.ready().then(function(){n===void 0&&(n=null);var t=n;return new a(function(v,m){var w=i._dbInfo;w.serializer.serialize(n,function(x,R){if(R)m(R);else try{localStorage.setItem(w.keyPrefix+e,x),v(t)}catch(N){(N.name==="QuotaExceededError"||N.name==="NS_ERROR_DOM_QUOTA_REACHED")&&m(N),m(N)}})})});return c(u,r),u}f(gn,"setItem$2");function mn(e,n){if(n=$.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var i=this,u;return e.name?u=new a(function(t){e.storeName?t(cr(e,i._defaultConfig)):t(e.name+"/")}).then(function(t){for(var v=localStorage.length-1;v>=0;v--){var m=localStorage.key(v);m.indexOf(t)===0&&localStorage.removeItem(m)}}):u=a.reject("Invalid arguments"),c(u,n),u}f(mn,"dropInstance$2");var bn={_driver:"localStorageWrapper",_initStorage:cn,_support:an(),iterate:dn,getItem:ln,setItem:gn,removeItem:pn,clear:sn,length:yn,key:vn,keys:hn,dropInstance:mn},wn=f(function(n,r){return n===r||typeof n=="number"&&typeof r=="number"&&isNaN(n)&&isNaN(r)},"sameValue"),_n=f(function(n,r){for(var i=n.length,u=0;u<i;){if(wn(n[u],r))return!0;u++}return!1},"includes"),sr=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},ce={},lr={},ue={INDEXEDDB:Yr,WEBSQL:on,LOCALSTORAGE:bn},xn=[ue.INDEXEDDB._driver,ue.WEBSQL._driver,ue.LOCALSTORAGE._driver],ye=["dropInstance"],Ie=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ye),Sn={description:"",driver:xn.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function En(e,n){e[n]=function(){var r=arguments;return e.ready().then(function(){return e[n].apply(e,r)})}}f(En,"callWhenReady");function Re(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var r in n)n.hasOwnProperty(r)&&(sr(n[r])?arguments[0][r]=n[r].slice():arguments[0][r]=n[r])}return arguments[0]}f(Re,"extend");var In=function(){function e(n){E(this,e);for(var r in ue)if(ue.hasOwnProperty(r)){var i=ue[r],u=i._driver;this[r]=u,ce[u]||this.defineDriver(i)}this._defaultConfig=Re({},Sn),this._config=Re({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return f(e,"LocalForage"),e.prototype.config=f(function(r){if((typeof r>"u"?"undefined":I(r))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var i in r){if(i==="storeName"&&(r[i]=r[i].replace(/\W/g,"_")),i==="version"&&typeof r[i]!="number")return new Error("Database version must be a number.");this._config[i]=r[i]}return"driver"in r&&r.driver?this.setDriver(this._config.driver):!0}else return typeof r=="string"?this._config[r]:this._config},"config"),e.prototype.defineDriver=f(function(r,i,u){var t=new a(function(v,m){try{var w=r._driver,x=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!r._driver){m(x);return}for(var R=Ie.concat("_initStorage"),N=0,B=R.length;N<B;N++){var F=R[N],U=!_n(ye,F);if((U||r[F])&&typeof r[F]!="function"){m(x);return}}var k=f(function(){for(var se=f(function(Nn){return function(){var Dn=new Error("Method "+Nn+" is not implemented by the current driver"),dr=a.reject(Dn);return c(dr,arguments[arguments.length-1]),dr}},"methodNotImplementedFactory"),Ae=0,An=ye.length;Ae<An;Ae++){var Ne=ye[Ae];r[Ne]||(r[Ne]=se(Ne))}},"configureMissingMethods");k();var X=f(function(se){ce[w]&&console.info("Redefining LocalForage driver: "+w),ce[w]=r,lr[w]=se,v()},"setDriverSupport");"_support"in r?r._support&&typeof r._support=="function"?r._support().then(X,m):X(!!r._support):X(!0)}catch(Q){m(Q)}});return b(t,i,u),t},"defineDriver"),e.prototype.driver=f(function(){return this._driver||null},"driver"),e.prototype.getDriver=f(function(r,i,u){var t=ce[r]?a.resolve(ce[r]):a.reject(new Error("Driver not found."));return b(t,i,u),t},"getDriver"),e.prototype.getSerializer=f(function(r){var i=a.resolve(Ee);return b(i,r),i},"getSerializer"),e.prototype.ready=f(function(r){var i=this,u=i._driverSet.then(function(){return i._ready===null&&(i._ready=i._initDriver()),i._ready});return b(u,r,r),u},"ready"),e.prototype.setDriver=f(function(r,i,u){var t=this;sr(r)||(r=[r]);var v=this._getSupportedDrivers(r);function m(){t._config.driver=t.driver()}f(m,"setDriverToConfig");function w(N){return t._extend(N),m(),t._ready=t._initStorage(t._config),t._ready}f(w,"extendSelfWithDriver");function x(N){return function(){var B=0;function F(){for(;B<N.length;){var U=N[B];return B++,t._dbInfo=null,t._ready=null,t.getDriver(U).then(w).catch(F)}m();var k=new Error("No available storage method found.");return t._driverSet=a.reject(k),t._driverSet}return f(F,"driverPromiseLoop"),F()}}f(x,"initDriver");var R=this._driverSet!==null?this._driverSet.catch(function(){return a.resolve()}):a.resolve();return this._driverSet=R.then(function(){var N=v[0];return t._dbInfo=null,t._ready=null,t.getDriver(N).then(function(B){t._driver=B._driver,m(),t._wrapLibraryMethodsWithReady(),t._initDriver=x(v)})}).catch(function(){m();var N=new Error("No available storage method found.");return t._driverSet=a.reject(N),t._driverSet}),b(this._driverSet,i,u),this._driverSet},"setDriver"),e.prototype.supports=f(function(r){return!!lr[r]},"supports"),e.prototype._extend=f(function(r){Re(this,r)},"_extend"),e.prototype._getSupportedDrivers=f(function(r){for(var i=[],u=0,t=r.length;u<t;u++){var v=r[u];this.supports(v)&&i.push(v)}return i},"_getSupportedDrivers"),e.prototype._wrapLibraryMethodsWithReady=f(function(){for(var r=0,i=Ie.length;r<i;r++)En(this,Ie[r])},"_wrapLibraryMethodsWithReady"),e.prototype.createInstance=f(function(r){return new e(r)},"createInstance"),e}(),Rn=new In;d.exports=Rn},{3:3}]},{},[4])(4)})})(ge);const G=f(({q:l,r:S,s:y})=>`${l} ${S} ${y}`,"asCoordinateKey"),De=[0,60,120,180,240,300];var Te={exports:{}};(function(l){(function(S,y,d){function _(o){var s=this,p=h();s.next=function(){var a=2091639*s.s0+s.c*23283064365386963e-26;return s.s0=s.s1,s.s1=s.s2,s.s2=a-(s.c=a|0)},s.c=1,s.s0=p(" "),s.s1=p(" "),s.s2=p(" "),s.s0-=p(o),s.s0<0&&(s.s0+=1),s.s1-=p(o),s.s1<0&&(s.s1+=1),s.s2-=p(o),s.s2<0&&(s.s2+=1),p=null}f(_,"Alea");function I(o,s){return s.c=o.c,s.s0=o.s0,s.s1=o.s1,s.s2=o.s2,s}f(I,"copy");function E(o,s){var p=new _(o),a=s&&s.state,c=p.next;return c.int32=function(){return p.next()*4294967296|0},c.double=function(){return c()+(c()*2097152|0)*11102230246251565e-32},c.quick=c,a&&(typeof a=="object"&&I(a,p),c.state=function(){return I(p,{})}),c}f(E,"impl");function h(){var o=4022871197,s=f(function(p){p=String(p);for(var a=0;a<p.length;a++){o+=p.charCodeAt(a);var c=.02519603282416938*o;o=c>>>0,c-=o,c*=o,o=c>>>0,c-=o,o+=c*4294967296}return(o>>>0)*23283064365386963e-26},"mash");return s}f(h,"Mash"),y&&y.exports?y.exports=E:d&&d.amd?d(function(){return E}):this.alea=E})(J,l,!1)})(Te);var Ce={exports:{}};(function(l){(function(S,y,d){function _(h){var o=this,s="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var a=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^a^a>>>8},h===(h|0)?o.x=h:s+=h;for(var p=0;p<s.length+64;p++)o.x^=s.charCodeAt(p)|0,o.next()}f(_,"XorGen");function I(h,o){return o.x=h.x,o.y=h.y,o.z=h.z,o.w=h.w,o}f(I,"copy");function E(h,o){var s=new _(h),p=o&&o.state,a=f(function(){return(s.next()>>>0)/4294967296},"prng");return a.double=function(){do var c=s.next()>>>11,b=(s.next()>>>0)/4294967296,A=(c+b)/(1<<21);while(A===0);return A},a.int32=s.next,a.quick=a,p&&(typeof p=="object"&&I(p,s),a.state=function(){return I(s,{})}),a}f(E,"impl"),y&&y.exports?y.exports=E:d&&d.amd?d(function(){return E}):this.xor128=E})(J,l,!1)})(Ce);var Oe={exports:{}};(function(l){(function(S,y,d){function _(h){var o=this,s="";o.next=function(){var a=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^(a^a<<1))|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,h===(h|0)?o.x=h:s+=h;for(var p=0;p<s.length+64;p++)o.x^=s.charCodeAt(p)|0,p==s.length&&(o.d=o.x<<10^o.x>>>4),o.next()}f(_,"XorGen");function I(h,o){return o.x=h.x,o.y=h.y,o.z=h.z,o.w=h.w,o.v=h.v,o.d=h.d,o}f(I,"copy");function E(h,o){var s=new _(h),p=o&&o.state,a=f(function(){return(s.next()>>>0)/4294967296},"prng");return a.double=function(){do var c=s.next()>>>11,b=(s.next()>>>0)/4294967296,A=(c+b)/(1<<21);while(A===0);return A},a.int32=s.next,a.quick=a,p&&(typeof p=="object"&&I(p,s),a.state=function(){return I(s,{})}),a}f(E,"impl"),y&&y.exports?y.exports=E:d&&d.amd?d(function(){return E}):this.xorwow=E})(J,l,!1)})(Oe);var Be={exports:{}};(function(l){(function(S,y,d){function _(h){var o=this;o.next=function(){var p=o.x,a=o.i,c,b;return c=p[a],c^=c>>>7,b=c^c<<24,c=p[a+1&7],b^=c^c>>>10,c=p[a+3&7],b^=c^c>>>3,c=p[a+4&7],b^=c^c<<7,c=p[a+7&7],c=c^c<<13,b^=c^c<<9,p[a]=b,o.i=a+1&7,b};function s(p,a){var c,b=[];if(a===(a|0))b[0]=a;else for(a=""+a,c=0;c<a.length;++c)b[c&7]=b[c&7]<<15^a.charCodeAt(c)+b[c+1&7]<<13;for(;b.length<8;)b.push(0);for(c=0;c<8&&b[c]===0;++c);for(c==8?b[7]=-1:b[c],p.x=b,p.i=0,c=256;c>0;--c)p.next()}f(s,"init"),s(o,h)}f(_,"XorGen");function I(h,o){return o.x=h.x.slice(),o.i=h.i,o}f(I,"copy");function E(h,o){h==null&&(h=+new Date);var s=new _(h),p=o&&o.state,a=f(function(){return(s.next()>>>0)/4294967296},"prng");return a.double=function(){do var c=s.next()>>>11,b=(s.next()>>>0)/4294967296,A=(c+b)/(1<<21);while(A===0);return A},a.int32=s.next,a.quick=a,p&&(p.x&&I(p,s),a.state=function(){return I(s,{})}),a}f(E,"impl"),y&&y.exports?y.exports=E:d&&d.amd?d(function(){return E}):this.xorshift7=E})(J,l,!1)})(Be);var Pe={exports:{}};(function(l){(function(S,y,d){function _(h){var o=this;o.next=function(){var p=o.w,a=o.X,c=o.i,b,A;return o.w=p=p+1640531527|0,A=a[c+34&127],b=a[c=c+1&127],A^=A<<13,b^=b<<17,A^=A>>>15,b^=b>>>12,A=a[c]=A^b,o.i=c,A+(p^p>>>16)|0};function s(p,a){var c,b,A,$,L,Y=[],P=128;for(a===(a|0)?(b=a,a=null):(a=a+"\0",b=0,P=Math.max(P,a.length)),A=0,$=-32;$<P;++$)a&&(b^=a.charCodeAt(($+32)%a.length)),$===0&&(L=b),b^=b<<10,b^=b>>>15,b^=b<<4,b^=b>>>13,$>=0&&(L=L+1640531527|0,c=Y[$&127]^=b+L,A=c==0?A+1:0);for(A>=128&&(Y[(a&&a.length||0)&127]=-1),A=127,$=4*128;$>0;--$)b=Y[A+34&127],c=Y[A=A+1&127],b^=b<<13,c^=c<<17,b^=b>>>15,c^=c>>>12,Y[A]=b^c;p.w=L,p.X=Y,p.i=A}f(s,"init"),s(o,h)}f(_,"XorGen");function I(h,o){return o.i=h.i,o.w=h.w,o.X=h.X.slice(),o}f(I,"copy");function E(h,o){h==null&&(h=+new Date);var s=new _(h),p=o&&o.state,a=f(function(){return(s.next()>>>0)/4294967296},"prng");return a.double=function(){do var c=s.next()>>>11,b=(s.next()>>>0)/4294967296,A=(c+b)/(1<<21);while(A===0);return A},a.int32=s.next,a.quick=a,p&&(p.X&&I(p,s),a.state=function(){return I(s,{})}),a}f(E,"impl"),y&&y.exports?y.exports=E:d&&d.amd?d(function(){return E}):this.xor4096=E})(J,l,!1)})(Pe);var Le={exports:{}};(function(l){(function(S,y,d){function _(h){var o=this,s="";o.next=function(){var a=o.b,c=o.c,b=o.d,A=o.a;return a=a<<25^a>>>7^c,c=c-b|0,b=b<<24^b>>>8^A,A=A-a|0,o.b=a=a<<20^a>>>12^c,o.c=c=c-b|0,o.d=b<<16^c>>>16^A,o.a=A-a|0},o.a=0,o.b=0,o.c=-1640531527,o.d=1367130551,h===Math.floor(h)?(o.a=h/4294967296|0,o.b=h|0):s+=h;for(var p=0;p<s.length+20;p++)o.b^=s.charCodeAt(p)|0,o.next()}f(_,"XorGen");function I(h,o){return o.a=h.a,o.b=h.b,o.c=h.c,o.d=h.d,o}f(I,"copy");function E(h,o){var s=new _(h),p=o&&o.state,a=f(function(){return(s.next()>>>0)/4294967296},"prng");return a.double=function(){do var c=s.next()>>>11,b=(s.next()>>>0)/4294967296,A=(c+b)/(1<<21);while(A===0);return A},a.int32=s.next,a.quick=a,p&&(typeof p=="object"&&I(p,s),a.state=function(){return I(s,{})}),a}f(E,"impl"),y&&y.exports?y.exports=E:d&&d.amd?d(function(){return E}):this.tychei=E})(J,l,!1)})(Le);var Me={exports:{}},hr={},yr=Object.freeze({__proto__:null,default:hr}),pr=pe(yr);(function(l){(function(S,y,d){var _=256,I=6,E=52,h="random",o=d.pow(_,I),s=d.pow(2,E),p=s*2,a=_-1,c;function b(O,g,T){var D=[];g=g==!0?{entropy:!0}:g||{};var C=Y(L(g.entropy?[O,K(y)]:O==null?P():O,3),D),M=new A(D),j=f(function(){for(var z=M.g(I),W=o,q=0;z<s;)z=(z+q)*_,W*=_,q=M.g(1);for(;z>=p;)z/=2,W/=2,q>>>=1;return(z+q)/W},"prng");return j.int32=function(){return M.g(4)|0},j.quick=function(){return M.g(4)/4294967296},j.double=j,Y(K(M.S),y),(g.pass||T||function(z,W,q,V){return V&&(V.S&&$(V,M),z.state=function(){return $(M,{})}),q?(d[h]=z,W):z})(j,C,"global"in g?g.global:this==d,g.state)}f(b,"seedrandom");function A(O){var g,T=O.length,D=this,C=0,M=D.i=D.j=0,j=D.S=[];for(T||(O=[T++]);C<_;)j[C]=C++;for(C=0;C<_;C++)j[C]=j[M=a&M+O[C%T]+(g=j[C])],j[M]=g;(D.g=function(z){for(var W,q=0,V=D.i,Z=D.j,ee=D.S;z--;)W=ee[V=a&V+1],q=q*_+ee[a&(ee[V]=ee[Z=a&Z+W])+(ee[Z]=W)];return D.i=V,D.j=Z,q})(_)}f(A,"ARC4");function $(O,g){return g.i=O.i,g.j=O.j,g.S=O.S.slice(),g}f($,"copy");function L(O,g){var T=[],D=typeof O,C;if(g&&D=="object")for(C in O)try{T.push(L(O[C],g-1))}catch{}return T.length?T:D=="string"?O:O+"\0"}f(L,"flatten");function Y(O,g){for(var T=O+"",D,C=0;C<T.length;)g[a&C]=a&(D^=g[a&C]*19)+T.charCodeAt(C++);return K(g)}f(Y,"mixkey");function P(){try{var O;return c&&(O=c.randomBytes)?O=O(_):(O=new Uint8Array(_),(S.crypto||S.msCrypto).getRandomValues(O)),K(O)}catch{var g=S.navigator,T=g&&g.plugins;return[+new Date,S,T,S.screen,K(y)]}}f(P,"autoseed");function K(O){return String.fromCharCode.apply(0,O)}if(f(K,"tostring"),Y(d.random(),y),l.exports){l.exports=b;try{c=pr}catch{}}else d["seed"+h]=b})(typeof self<"u"?self:J,[],Math)})(Me);var gr=Te.exports,mr=Ce.exports,br=Oe.exports,wr=Be.exports,_r=Pe.exports,xr=Le.exports,ie=Me.exports;ie.alea=gr,ie.xor128=mr,ie.xorwow=br,ie.xorshift7=wr,ie.xor4096=_r,ie.tychei=xr;var Sr=ie;function*Fe(l,S){let y=0;for(const d of S)y++<l||(yield d)}f(Fe,"skip");var $e=f(l=>{const S=Sr(l),y={chooseOne(d){if(d instanceof Map||d instanceof Set){const _=Math.floor(S()*d.size),{value:I}=Fe(_,d.keys()).next();return I}else{const _=d instanceof Array?d:[...d];return _[Math.floor(S()*_.length)]}},removeOne(d){if(d instanceof Map){const _=y.chooseOne(d),I=d.get(_);return d.delete(_),I}else if(d instanceof Set){const _=y.chooseOne(d);return d.delete(_),_}else{const _=Math.floor(S()*d.length),I=d[_];return d.splice(_,1),I}},*randomIterator(d){if(d instanceof Map||d instanceof Set){const _=Math.floor(S()*d.size);yield*Fe(_,d.keys())}else{const _=d instanceof Array?d:[...d],I=Math.floor(S()*_.length);for(let E=0;E<_.length;E++)yield _[(I+E)%_.length]}}};return y},"Random");function*Er(l,S,y){for(const d of me(l,S)){const{coordinate:_}=d,I=y.has(G(_));yield{neighbour:d,connected:I}}}f(Er,"PartitionNeighbours");const Ue=f((l,S,y)=>{var d;(d=l[S])!=null||(l[S]=0),l[S]|=y},"addConnection");function*Ir({size:l,seed:S}){const{chooseOne:y,removeOne:d}=$e(S),_=[...ze(l)],I={},E=new Set,h=new Map,o=y(_);E.add(G(o));for(const{coordinate:s}of me(l,o))h.set(G(s),s);for(;E.size<_.length;){if(h.size===0)throw new Error("working set unexpectedly empty");const s=d(h),p=G(s),a=[...Er(l,s,E)],c=a.filter(({connected:P})=>P),{neighbour:{coordinate:b,direction:A}}=y(c),{forwards:$,backwards:L}=Ye(A),Y=G(b);Ue(I,p,$),Ue(I,Y,L),E.add(p);for(const{neighbour:{coordinate:P}}of a.filter(({connected:K})=>!K))h.set(G(P),P)}for(const s of _){const p=I[G(s)],a=y(De),c=je(p);yield{coordinate:s,orientation:a,connection:c}}}f(Ir,"Prims");function*Rr({size:l,seed:S}){const{chooseOne:y,randomIterator:d,removeOne:_}=$e(S),I=f((p,a)=>d(me(p,a)).next().value,"RandomNeighbour"),E=f((p,a)=>{const c=new Map,b=G(p);let A=[{key:b,coordinate:p,forwards:0,backwards:0}];for(c.set(b,p);;){const $=A.at(-1).coordinate,{coordinate:L,direction:Y}=I(l,$),P=G(L);if(c.has(P)){const O=A.findIndex(({key:g})=>g===P)+1;for(let g=O;g<A.length;g++){const{key:T}=A[g];c.delete(T)}A=A.slice(0,O);continue}else{const{forwards:O,backwards:g}=Ye(Y);if(A.at(-1).forwards=O,A.push({key:P,coordinate:L,forwards:0,backwards:g}),!a.has(P))return A;c.set(P,L)}}},"loopErasedRandomWalk"),h=[...ze(l)],o={},s=new Map;for(const p of h)s.set(G(p),p);for(_(s);s.size>0;){const p=_(s),a=E(p,s);for(const{key:c,forwards:b,backwards:A}of a)s.delete(c),o[c]|=b|A}for(const p of h){const a=o[G(p)],c=y(De),b=je(a);yield{coordinate:p,orientation:c,connection:b}}}f(Rr,"Wilsons");const je=f(l=>{if(l===0)throw new Error("connection cannot be empty");if(l===63)return 63;for(;!(l&32)||l&1;){const y=l&32;l<<=1,l&=63,y&&(l|=1)}const S=(l&30)>>1;switch(S){case 0:return 32;case 8:return 48;case 4:return 40;case 2:return 36;case 1:return 40;case 12:return 56;case 6:return 44;case 3:return 52;case 9:return 44;case 10:return 52;case 5:return 42;case 14:return 60;case 7:return 46;case 11:return 54;case 13:return 46;case 15:return 62;default:throw new Error(`unhandled truncated case ${S.toString(2)} from connection ${l.toString(2)}`)}},"normalizeConnection");function*Ar({q:l,r:S,s:y}){yield{coordinate:{q:l,r:S-1,s:y+1},direction:0},yield{coordinate:{q:l+1,r:S-1,s:y},direction:1},yield{coordinate:{q:l+1,r:S,s:y-1},direction:2},yield{coordinate:{q:l,r:S+1,s:y-1},direction:3},yield{coordinate:{q:l-1,r:S+1,s:y},direction:4},yield{coordinate:{q:l-1,r:S,s:y+1},direction:5}}f(Ar,"Neighbours$1");function*me(l,S){for(const y of Ar(S)){const{coordinate:{q:d,r:_,s:I}}=y;d<-l||d>l||_<-l||_>l||I<-l||I>l||(yield y)}}f(me,"ValidNeighbours");function*ze(l){for(let S=-l;S<=l;S++)for(let y=-l;y<=l;y++){const d=-S-y;-l<=d&&d<=l&&(yield{q:S,r:y,s:d})}}f(ze,"CoordinatesGenerator");const Ye=f(l=>({forwards:32>>l,backwards:32>>(l+3)%6}),"asConnections");function*Nr(l){const{mode:S}=l;switch(S){case"prims":yield*Ir(l);return;case"wilsons":yield*Rr(l);return}}f(Nr,"PuzzleGenerator");const be=ge.exports.createInstance({driver:ge.exports.INDEXEDDB,name:"hexpanse",version:1,storeName:"gameState"}),We=f(l=>{postMessage(l)},"reply");let de,ve,H;onmessage=f(async({data:l})=>{switch(l.type){case"restore":{de=l.config,ve=vr(de);const S=await be.getItem(ve);if(S)H=S;else{H={};for(const{coordinate:y,orientation:d,connection:_}of Nr(de))H[G(y)]={coordinate:y,orientation:d,connection:_};await be.setItem(ve,H)}We({type:"restored",config:de,state:H}),ne={};for(const y of Object.keys(H))Xe(y);qe();return}case"update cell":{const{coordinate:S,orientation:y}=l,d=G(S),_=H[d];_&&(_.orientation=y,await be.setItem(ve,H),delete ne[d],Xe(d),qe());return}}},"onmessage");const ae=f((l,S,y)=>{for(l.q-=y.q,l.r-=y.r,l.s-=y.s;S>0;)l={q:-l.r,r:-l.s,s:-l.q},S-=60;return l.q+=y.q,l.r+=y.r,l.s+=y.s,l},"rotate");function*Dr(l,S,y){const{q:d,r:_,s:I}=l;y&32&&(yield ae({q:d+1,r:_,s:I-1},S,l)),y&16&&(yield ae({q:d,r:_+1,s:I-1},S,l)),y&8&&(yield ae({q:d-1,r:_+1,s:I},S,l)),y&4&&(yield ae({q:d-1,r:_,s:I+1},S,l)),y&2&&(yield ae({q:d,r:_-1,s:I+1},S,l)),y&1&&(yield ae({q:d+1,r:_-1,s:I},S,l))}f(Dr,"Neighbours");let ne;const Xe=f(l=>{var _;const{coordinate:S,orientation:y,connection:d}=H[l];for(const I of Dr(S,y,d)){const E=G(I);!H[E]||((_=ne[l])!=null||(ne[l]=new Set),ne[l].add(E))}},"updateFacingNeighbours"),qe=f(()=>{var _;let l=0;const S={},y=f((I,E)=>{var o;if(S[I])return;S[I]=E;const h=ne[I];if(h)for(const s of h)(o=ne[s])!=null&&o.has(I)&&y(s,E)},"floodFill");for(const I of Object.keys(H))y(I,++l);const d={};for(const[I,E]of Object.entries(S))(_=d[E])!=null||(d[E]=new Set),d[E].add(I);if(Object.values(d).length===1)return We({type:"game over"})},"updateSpan")})();
