var Sn=Object.defineProperty;var f=(K,he)=>Sn(K,"name",{value:he,configurable:!0});(function(){"use strict";var K=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function he(_){var E=_.default;if(typeof E=="function"){var g=f(function(){return E.apply(this,arguments)},"a");g.prototype=E.prototype}else g={};return Object.defineProperty(g,"__esModule",{value:!0}),Object.keys(_).forEach(function(x){var D=Object.getOwnPropertyDescriptor(_,x);Object.defineProperty(g,x,D.get?D:{enumerable:!0,get:function(){return _[x]}})}),g}f(he,"getAugmentedNamespace");var nr=f(function(_,E){E||(E={}),typeof E=="function"&&(E={cmp:E});var g=typeof E.cycles=="boolean"?E.cycles:!1,x=E.cmp&&function(A){return function(S){return function(v,o){var l={key:v,value:S[v]},y={key:o,value:S[o]};return A(l,y)}}}(E.cmp),D=[];return f(function A(S){if(S&&S.toJSON&&typeof S.toJSON=="function"&&(S=S.toJSON()),S!==void 0){if(typeof S=="number")return isFinite(S)?""+S:"null";if(typeof S!="object")return JSON.stringify(S);var v,o;if(Array.isArray(S)){for(o="[",v=0;v<S.length;v++)v&&(o+=","),o+=A(S[v])||"null";return o+"]"}if(S===null)return"null";if(D.indexOf(S)!==-1){if(g)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=D.push(S)-1,y=Object.keys(S).sort(x&&x(S));for(o="",v=0;v<y.length;v++){var a=y[v],c=A(S[a]);!c||(o&&(o+=","),o+=JSON.stringify(a)+":"+c)}return D.splice(l,1),"{"+o+"}"}},"stringify")(_)},"fastJsonStableStringify");function ce(_){throw new Error('Could not dynamically require "'+_+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}f(ce,"commonjsRequire");var ye={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(_,E){(function(g){_.exports=g()})(function(){return f(function g(x,D,A){function S(l,y){if(!D[l]){if(!x[l]){var a=typeof ce=="function"&&ce;if(!y&&a)return a(l,!0);if(v)return v(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var b=D[l]={exports:{}};x[l][0].call(b.exports,function(I){var $=x[l][1][I];return S($||I)},b,b.exports,g,x,D,A)}return D[l].exports}f(S,"s");for(var v=typeof ce=="function"&&ce,o=0;o<A.length;o++)S(A[o]);return S},"e")({1:[function(g,x,D){(function(A){var S=A.MutationObserver||A.WebKitMutationObserver,v;if(S){var o=0,l=new S(I),y=A.document.createTextNode("");l.observe(y,{characterData:!0}),v=f(function(){y.data=o=++o%2},"scheduleDrain")}else if(!A.setImmediate&&typeof A.MessageChannel<"u"){var a=new A.MessageChannel;a.port1.onmessage=I,v=f(function(){a.port2.postMessage(0)},"scheduleDrain")}else"document"in A&&"onreadystatechange"in A.document.createElement("script")?v=f(function(){var P=A.document.createElement("script");P.onreadystatechange=function(){I(),P.onreadystatechange=null,P.parentNode.removeChild(P),P=null},A.document.documentElement.appendChild(P)},"scheduleDrain"):v=f(function(){setTimeout(I,0)},"scheduleDrain");var c,b=[];function I(){c=!0;for(var P,j,z=b.length;z;){for(j=b,b=[],P=-1;++P<z;)j[P]();z=b.length}c=!1}f(I,"nextTick"),x.exports=$;function $(P){b.push(P)===1&&!c&&v()}f($,"immediate")}).call(this,typeof K<"u"?K:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(g,x,D){var A=g(1);function S(){}f(S,"INTERNAL");var v={},o=["REJECTED"],l=["FULFILLED"],y=["PENDING"];x.exports=a;function a(h){if(typeof h!="function")throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,h!==S&&$(this,h)}f(a,"Promise"),a.prototype.catch=function(h){return this.then(null,h)},a.prototype.then=function(h,C){if(typeof h!="function"&&this.state===l||typeof C!="function"&&this.state===o)return this;var N=new this.constructor(S);if(this.state!==y){var T=this.state===l?h:C;b(N,T,this.outcome)}else this.queue.push(new c(N,h,C));return N};function c(h,C,N){this.promise=h,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}f(c,"QueueItem"),c.prototype.callFulfilled=function(h){v.resolve(this.promise,h)},c.prototype.otherCallFulfilled=function(h){b(this.promise,this.onFulfilled,h)},c.prototype.callRejected=function(h){v.reject(this.promise,h)},c.prototype.otherCallRejected=function(h){b(this.promise,this.onRejected,h)};function b(h,C,N){A(function(){var T;try{T=C(N)}catch(L){return v.reject(h,L)}T===h?v.reject(h,new TypeError("Cannot resolve promise with itself")):v.resolve(h,T)})}f(b,"unwrap"),v.resolve=function(h,C){var N=P(I,C);if(N.status==="error")return v.reject(h,N.value);var T=N.value;if(T)$(h,T);else{h.state=l,h.outcome=C;for(var L=-1,U=h.queue.length;++L<U;)h.queue[L].callFulfilled(C)}return h},v.reject=function(h,C){h.state=o,h.outcome=C;for(var N=-1,T=h.queue.length;++N<T;)h.queue[N].callRejected(C);return h};function I(h){var C=h&&h.then;if(h&&(typeof h=="object"||typeof h=="function")&&typeof C=="function")return f(function(){C.apply(h,arguments)},"appyThen")}f(I,"getThen");function $(h,C){var N=!1;function T(X){N||(N=!0,v.reject(h,X))}f(T,"onError");function L(X){N||(N=!0,v.resolve(h,X))}f(L,"onSuccess");function U(){C(L,T)}f(U,"tryToUnwrap");var Y=P(U);Y.status==="error"&&T(Y.value)}f($,"safelyResolveThenable");function P(h,C){var N={};try{N.value=h(C),N.status="success"}catch(T){N.status="error",N.value=T}return N}f(P,"tryCatch"),a.resolve=j;function j(h){return h instanceof this?h:v.resolve(new this(S),h)}f(j,"resolve"),a.reject=z;function z(h){var C=new this(S);return v.reject(C,h)}f(z,"reject"),a.all=Q;function Q(h){var C=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=h.length,T=!1;if(!N)return this.resolve([]);for(var L=new Array(N),U=0,Y=-1,X=new this(S);++Y<N;)G(h[Y],Y);return X;function G(J,H){C.resolve(J).then(k,function(ie){T||(T=!0,v.reject(X,ie))});function k(ie){L[H]=ie,++U===N&&!T&&(T=!0,v.resolve(X,L))}f(k,"resolveFromAll")}}f(Q,"all"),a.race=B;function B(h){var C=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=h.length,T=!1;if(!N)return this.resolve([]);for(var L=-1,U=new this(S);++L<N;)Y(h[L]);return U;function Y(X){C.resolve(X).then(function(G){T||(T=!0,v.resolve(U,G))},function(G){T||(T=!0,v.reject(U,G))})}}f(B,"race")},{1:1}],3:[function(g,x,D){(function(A){typeof A.Promise!="function"&&(A.Promise=g(2))}).call(this,typeof K<"u"?K:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(g,x,D){var A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function S(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}f(S,"_classCallCheck");function v(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}f(v,"getIDB");var o=v();function l(){try{if(!o||!o.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}f(l,"isIndexedDBValid");function y(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(t){if(t.name!=="TypeError")throw t;for(var r=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,i=new r,u=0;u<e.length;u+=1)i.append(e[u]);return i.getBlob(n.type)}}f(y,"createBlob"),typeof Promise>"u"&&g(3);var a=Promise;function c(e,n){n&&e.then(function(r){n(null,r)},function(r){n(r)})}f(c,"executeCallback");function b(e,n,r){typeof n=="function"&&e.then(n),typeof r=="function"&&e.catch(r)}f(b,"executeTwoCallbacks");function I(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}f(I,"normalizeKey");function $(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}f($,"getCallback");var P="local-forage-detect-blob-support",j=void 0,z={},Q=Object.prototype.toString,B="readonly",h="readwrite";function C(e){for(var n=e.length,r=new ArrayBuffer(n),i=new Uint8Array(r),u=0;u<n;u++)i[u]=e.charCodeAt(u);return r}f(C,"_binStringToArrayBuffer");function N(e){return new a(function(n){var r=e.transaction(P,h),i=y([""]);r.objectStore(P).put(i,"key"),r.onabort=function(u){u.preventDefault(),u.stopPropagation(),n(!1)},r.oncomplete=function(){var u=navigator.userAgent.match(/Chrome\/(\d+)/),t=navigator.userAgent.match(/Edge\//);n(t||!u||parseInt(u[1],10)>=43)}}).catch(function(){return!1})}f(N,"_checkBlobSupportWithoutCaching");function T(e){return typeof j=="boolean"?a.resolve(j):N(e).then(function(n){return j=n,j})}f(T,"_checkBlobSupport");function L(e){var n=z[e.name],r={};r.promise=new a(function(i,u){r.resolve=i,r.reject=u}),n.deferredOperations.push(r),n.dbReady?n.dbReady=n.dbReady.then(function(){return r.promise}):n.dbReady=r.promise}f(L,"_deferReadiness");function U(e){var n=z[e.name],r=n.deferredOperations.pop();if(r)return r.resolve(),r.promise}f(U,"_advanceReadiness");function Y(e,n){var r=z[e.name],i=r.deferredOperations.pop();if(i)return i.reject(n),i.promise}f(Y,"_rejectReadiness");function X(e,n){return new a(function(r,i){if(z[e.name]=z[e.name]||Me(),e.db)if(n)L(e),e.db.close();else return r(e.db);var u=[e.name];n&&u.push(e.version);var t=o.open.apply(o,u);n&&(t.onupgradeneeded=function(s){var d=t.result;try{d.createObjectStore(e.storeName),s.oldVersion<=1&&d.createObjectStore(P)}catch(p){if(p.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+s.oldVersion+" to version "+s.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw p}}),t.onerror=function(s){s.preventDefault(),i(t.error)},t.onsuccess=function(){var s=t.result;s.onversionchange=function(d){d.target.close()},r(s),U(e)}})}f(X,"_getConnection");function G(e){return X(e,!1)}f(G,"_getOriginalConnection");function J(e){return X(e,!0)}f(J,"_getUpgradedConnection");function H(e,n){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),i=e.version<e.db.version,u=e.version>e.db.version;if(i&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),u||r){if(r){var t=e.db.version+1;t>e.version&&(e.version=t)}return!0}return!1}f(H,"_isUpgradeNeeded");function k(e){return new a(function(n,r){var i=new FileReader;i.onerror=r,i.onloadend=function(u){var t=btoa(u.target.result||"");n({__local_forage_encoded_blob:!0,data:t,type:e.type})},i.readAsBinaryString(e)})}f(k,"_encodeBlob");function ie(e){var n=C(atob(e.data));return y([n],{type:e.type})}f(ie,"_decodeBlob");function Le(e){return e&&e.__local_forage_encoded_blob}f(Le,"_isEncodedBlob");function Sr(e){var n=this,r=n._initReady().then(function(){var i=z[n._dbInfo.name];if(i&&i.dbReady)return i.dbReady});return b(r,e,e),r}f(Sr,"_fullyReady");function Er(e){L(e);for(var n=z[e.name],r=n.forages,i=0;i<r.length;i++){var u=r[i];u._dbInfo.db&&(u._dbInfo.db.close(),u._dbInfo.db=null)}return e.db=null,G(e).then(function(t){return e.db=t,H(e)?J(e):t}).then(function(t){e.db=n.db=t;for(var s=0;s<r.length;s++)r[s]._dbInfo.db=t}).catch(function(t){throw Y(e,t),t})}f(Er,"_tryReconnect");function Z(e,n,r,i){i===void 0&&(i=1);try{var u=e.db.transaction(e.storeName,n);r(null,u)}catch(t){if(i>0&&(!e.db||t.name==="InvalidStateError"||t.name==="NotFoundError"))return a.resolve().then(function(){if(!e.db||t.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),J(e)}).then(function(){return Er(e).then(function(){Z(e,n,r,i-1)})}).catch(r);r(t)}}f(Z,"createTransaction");function Me(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}f(Me,"createDbContext");function Ir(e){var n=this,r={db:null};if(e)for(var i in e)r[i]=e[i];var u=z[r.name];u||(u=Me(),z[r.name]=u),u.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=Sr);var t=[];function s(){return a.resolve()}f(s,"ignoreErrors");for(var d=0;d<u.forages.length;d++){var p=u.forages[d];p!==n&&t.push(p._initReady().catch(s))}var m=u.forages.slice(0);return a.all(t).then(function(){return r.db=u.db,G(r)}).then(function(w){return r.db=w,H(r,n._defaultConfig.version)?J(r):w}).then(function(w){r.db=u.db=w,n._dbInfo=r;for(var R=0;R<m.length;R++){var O=m[R];O!==n&&(O._dbInfo.db=r.db,O._dbInfo.version=r.version)}})}f(Ir,"_initStorage");function Rr(e,n){var r=this;e=I(e);var i=new a(function(u,t){r.ready().then(function(){Z(r._dbInfo,B,function(s,d){if(s)return t(s);try{var p=d.objectStore(r._dbInfo.storeName),m=p.get(e);m.onsuccess=function(){var w=m.result;w===void 0&&(w=null),Le(w)&&(w=ie(w)),u(w)},m.onerror=function(){t(m.error)}}catch(w){t(w)}})}).catch(t)});return c(i,n),i}f(Rr,"getItem");function Ar(e,n){var r=this,i=new a(function(u,t){r.ready().then(function(){Z(r._dbInfo,B,function(s,d){if(s)return t(s);try{var p=d.objectStore(r._dbInfo.storeName),m=p.openCursor(),w=1;m.onsuccess=function(){var R=m.result;if(R){var O=R.value;Le(O)&&(O=ie(O));var M=e(O,R.key,w++);M!==void 0?u(M):R.continue()}else u()},m.onerror=function(){t(m.error)}}catch(R){t(R)}})}).catch(t)});return c(i,n),i}f(Ar,"iterate");function Nr(e,n,r){var i=this;e=I(e);var u=new a(function(t,s){var d;i.ready().then(function(){return d=i._dbInfo,Q.call(n)==="[object Blob]"?T(d.db).then(function(p){return p?n:k(n)}):n}).then(function(p){Z(i._dbInfo,h,function(m,w){if(m)return s(m);try{var R=w.objectStore(i._dbInfo.storeName);p===null&&(p=void 0);var O=R.put(p,e);w.oncomplete=function(){p===void 0&&(p=null),t(p)},w.onabort=w.onerror=function(){var M=O.error?O.error:O.transaction.error;s(M)}}catch(M){s(M)}})}).catch(s)});return c(u,r),u}f(Nr,"setItem");function Dr(e,n){var r=this;e=I(e);var i=new a(function(u,t){r.ready().then(function(){Z(r._dbInfo,h,function(s,d){if(s)return t(s);try{var p=d.objectStore(r._dbInfo.storeName),m=p.delete(e);d.oncomplete=function(){u()},d.onerror=function(){t(m.error)},d.onabort=function(){var w=m.error?m.error:m.transaction.error;t(w)}}catch(w){t(w)}})}).catch(t)});return c(i,n),i}f(Dr,"removeItem");function Tr(e){var n=this,r=new a(function(i,u){n.ready().then(function(){Z(n._dbInfo,h,function(t,s){if(t)return u(t);try{var d=s.objectStore(n._dbInfo.storeName),p=d.clear();s.oncomplete=function(){i()},s.onabort=s.onerror=function(){var m=p.error?p.error:p.transaction.error;u(m)}}catch(m){u(m)}})}).catch(u)});return c(r,e),r}f(Tr,"clear");function Cr(e){var n=this,r=new a(function(i,u){n.ready().then(function(){Z(n._dbInfo,B,function(t,s){if(t)return u(t);try{var d=s.objectStore(n._dbInfo.storeName),p=d.count();p.onsuccess=function(){i(p.result)},p.onerror=function(){u(p.error)}}catch(m){u(m)}})}).catch(u)});return c(r,e),r}f(Cr,"length");function Or(e,n){var r=this,i=new a(function(u,t){if(e<0){u(null);return}r.ready().then(function(){Z(r._dbInfo,B,function(s,d){if(s)return t(s);try{var p=d.objectStore(r._dbInfo.storeName),m=!1,w=p.openKeyCursor();w.onsuccess=function(){var R=w.result;if(!R){u(null);return}e===0||m?u(R.key):(m=!0,R.advance(e))},w.onerror=function(){t(w.error)}}catch(R){t(R)}})}).catch(t)});return c(i,n),i}f(Or,"key");function Br(e){var n=this,r=new a(function(i,u){n.ready().then(function(){Z(n._dbInfo,B,function(t,s){if(t)return u(t);try{var d=s.objectStore(n._dbInfo.storeName),p=d.openKeyCursor(),m=[];p.onsuccess=function(){var w=p.result;if(!w){i(m);return}m.push(w.key),w.continue()},p.onerror=function(){u(p.error)}}catch(w){u(w)}})}).catch(u)});return c(r,e),r}f(Br,"keys");function Pr(e,n){n=$.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var i=this,u;if(!e.name)u=a.reject("Invalid arguments");else{var t=e.name===r.name&&i._dbInfo.db,s=t?a.resolve(i._dbInfo.db):G(e).then(function(d){var p=z[e.name],m=p.forages;p.db=d;for(var w=0;w<m.length;w++)m[w]._dbInfo.db=d;return d});e.storeName?u=s.then(function(d){if(!!d.objectStoreNames.contains(e.storeName)){var p=d.version+1;L(e);var m=z[e.name],w=m.forages;d.close();for(var R=0;R<w.length;R++){var O=w[R];O._dbInfo.db=null,O._dbInfo.version=p}var M=new a(function(F,V){var W=o.open(e.name,p);W.onerror=function(q){var ue=W.result;ue.close(),V(q)},W.onupgradeneeded=function(){var q=W.result;q.deleteObjectStore(e.storeName)},W.onsuccess=function(){var q=W.result;q.close(),F(q)}});return M.then(function(F){m.db=F;for(var V=0;V<w.length;V++){var W=w[V];W._dbInfo.db=F,U(W._dbInfo)}}).catch(function(F){throw(Y(e,F)||a.resolve()).catch(function(){}),F})}}):u=s.then(function(d){L(e);var p=z[e.name],m=p.forages;d.close();for(var w=0;w<m.length;w++){var R=m[w];R._dbInfo.db=null}var O=new a(function(M,F){var V=o.deleteDatabase(e.name);V.onerror=function(){var W=V.result;W&&W.close(),F(V.error)},V.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},V.onsuccess=function(){var W=V.result;W&&W.close(),M(W)}});return O.then(function(M){p.db=M;for(var F=0;F<m.length;F++){var V=m[F];U(V._dbInfo)}}).catch(function(M){throw(Y(e,M)||a.resolve()).catch(function(){}),M})})}return c(u,n),u}f(Pr,"dropInstance");var Lr={_driver:"asyncStorage",_initStorage:Ir,_support:l(),iterate:Ar,getItem:Rr,setItem:Nr,removeItem:Dr,clear:Tr,length:Cr,key:Or,keys:Br,dropInstance:Pr};function Mr(){return typeof openDatabase=="function"}f(Mr,"isWebSQLValid");var re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Fr="~~local_forage_type~",Fe=/^~~local_forage_type~([^~]+)~/,ve="__lfsc__:",ge=ve.length,me="arbf",be="blob",$e="si08",Ue="ui08",Ye="uic8",ze="si16",je="si32",Xe="ur16",We="ui32",Ge="fl32",Ve="fl64",Je=ge+me.length,Ke=Object.prototype.toString;function qe(e){var n=e.length*.75,r=e.length,i,u=0,t,s,d,p;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var m=new ArrayBuffer(n),w=new Uint8Array(m);for(i=0;i<r;i+=4)t=re.indexOf(e[i]),s=re.indexOf(e[i+1]),d=re.indexOf(e[i+2]),p=re.indexOf(e[i+3]),w[u++]=t<<2|s>>4,w[u++]=(s&15)<<4|d>>2,w[u++]=(d&3)<<6|p&63;return m}f(qe,"stringToBuffer");function _e(e){var n=new Uint8Array(e),r="",i;for(i=0;i<n.length;i+=3)r+=re[n[i]>>2],r+=re[(n[i]&3)<<4|n[i+1]>>4],r+=re[(n[i+1]&15)<<2|n[i+2]>>6],r+=re[n[i+2]&63];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}f(_e,"bufferToString");function $r(e,n){var r="";if(e&&(r=Ke.call(e)),e&&(r==="[object ArrayBuffer]"||e.buffer&&Ke.call(e.buffer)==="[object ArrayBuffer]")){var i,u=ve;e instanceof ArrayBuffer?(i=e,u+=me):(i=e.buffer,r==="[object Int8Array]"?u+=$e:r==="[object Uint8Array]"?u+=Ue:r==="[object Uint8ClampedArray]"?u+=Ye:r==="[object Int16Array]"?u+=ze:r==="[object Uint16Array]"?u+=Xe:r==="[object Int32Array]"?u+=je:r==="[object Uint32Array]"?u+=We:r==="[object Float32Array]"?u+=Ge:r==="[object Float64Array]"?u+=Ve:n(new Error("Failed to get type for BinaryArray"))),n(u+_e(i))}else if(r==="[object Blob]"){var t=new FileReader;t.onload=function(){var s=Fr+e.type+"~"+_e(this.result);n(ve+be+s)},t.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),n(null,s)}}f($r,"serialize");function Ur(e){if(e.substring(0,ge)!==ve)return JSON.parse(e);var n=e.substring(Je),r=e.substring(ge,Je),i;if(r===be&&Fe.test(n)){var u=n.match(Fe);i=u[1],n=n.substring(u[0].length)}var t=qe(n);switch(r){case me:return t;case be:return y([t],{type:i});case $e:return new Int8Array(t);case Ue:return new Uint8Array(t);case Ye:return new Uint8ClampedArray(t);case ze:return new Int16Array(t);case Xe:return new Uint16Array(t);case je:return new Int32Array(t);case We:return new Uint32Array(t);case Ge:return new Float32Array(t);case Ve:return new Float64Array(t);default:throw new Error("Unkown type: "+r)}}f(Ur,"deserialize");var we={serialize:$r,deserialize:Ur,stringToBuffer:qe,bufferToString:_e};function Qe(e,n,r,i){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,i)}f(Qe,"createDbTable");function Yr(e){var n=this,r={db:null};if(e)for(var i in e)r[i]=typeof e[i]!="string"?e[i].toString():e[i];var u=new a(function(t,s){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(d){return s(d)}r.db.transaction(function(d){Qe(d,r,function(){n._dbInfo=r,t()},function(p,m){s(m)})},s)});return r.serializer=we,u}f(Yr,"_initStorage$1");function ne(e,n,r,i,u,t){e.executeSql(r,i,u,function(s,d){d.code===d.SYNTAX_ERR?s.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(p,m){m.rows.length?t(p,d):Qe(p,n,function(){p.executeSql(r,i,u,t)},t)},t):t(s,d)},t)}f(ne,"tryExecuteSql");function zr(e,n){var r=this;e=I(e);var i=new a(function(u,t){r.ready().then(function(){var s=r._dbInfo;s.db.transaction(function(d){ne(d,s,"SELECT * FROM "+s.storeName+" WHERE key = ? LIMIT 1",[e],function(p,m){var w=m.rows.length?m.rows.item(0).value:null;w&&(w=s.serializer.deserialize(w)),u(w)},function(p,m){t(m)})})}).catch(t)});return c(i,n),i}f(zr,"getItem$1");function jr(e,n){var r=this,i=new a(function(u,t){r.ready().then(function(){var s=r._dbInfo;s.db.transaction(function(d){ne(d,s,"SELECT * FROM "+s.storeName,[],function(p,m){for(var w=m.rows,R=w.length,O=0;O<R;O++){var M=w.item(O),F=M.value;if(F&&(F=s.serializer.deserialize(F)),F=e(F,M.key,O+1),F!==void 0){u(F);return}}u()},function(p,m){t(m)})})}).catch(t)});return c(i,n),i}f(jr,"iterate$1");function He(e,n,r,i){var u=this;e=I(e);var t=new a(function(s,d){u.ready().then(function(){n===void 0&&(n=null);var p=n,m=u._dbInfo;m.serializer.serialize(n,function(w,R){R?d(R):m.db.transaction(function(O){ne(O,m,"INSERT OR REPLACE INTO "+m.storeName+" (key, value) VALUES (?, ?)",[e,w],function(){s(p)},function(M,F){d(F)})},function(O){if(O.code===O.QUOTA_ERR){if(i>0){s(He.apply(u,[e,p,r,i-1]));return}d(O)}})})}).catch(d)});return c(t,r),t}f(He,"_setItem");function Xr(e,n,r){return He.apply(this,[e,n,r,1])}f(Xr,"setItem$1");function Wr(e,n){var r=this;e=I(e);var i=new a(function(u,t){r.ready().then(function(){var s=r._dbInfo;s.db.transaction(function(d){ne(d,s,"DELETE FROM "+s.storeName+" WHERE key = ?",[e],function(){u()},function(p,m){t(m)})})}).catch(t)});return c(i,n),i}f(Wr,"removeItem$1");function Gr(e){var n=this,r=new a(function(i,u){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(s){ne(s,t,"DELETE FROM "+t.storeName,[],function(){i()},function(d,p){u(p)})})}).catch(u)});return c(r,e),r}f(Gr,"clear$1");function Vr(e){var n=this,r=new a(function(i,u){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(s){ne(s,t,"SELECT COUNT(key) as c FROM "+t.storeName,[],function(d,p){var m=p.rows.item(0).c;i(m)},function(d,p){u(p)})})}).catch(u)});return c(r,e),r}f(Vr,"length$1");function Jr(e,n){var r=this,i=new a(function(u,t){r.ready().then(function(){var s=r._dbInfo;s.db.transaction(function(d){ne(d,s,"SELECT key FROM "+s.storeName+" WHERE id = ? LIMIT 1",[e+1],function(p,m){var w=m.rows.length?m.rows.item(0).key:null;u(w)},function(p,m){t(m)})})}).catch(t)});return c(i,n),i}f(Jr,"key$1");function Kr(e){var n=this,r=new a(function(i,u){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(s){ne(s,t,"SELECT key FROM "+t.storeName,[],function(d,p){for(var m=[],w=0;w<p.rows.length;w++)m.push(p.rows.item(w).key);i(m)},function(d,p){u(p)})})}).catch(u)});return c(r,e),r}f(Kr,"keys$1");function qr(e){return new a(function(n,r){e.transaction(function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(u,t){for(var s=[],d=0;d<t.rows.length;d++)s.push(t.rows.item(d).name);n({db:e,storeNames:s})},function(u,t){r(t)})},function(i){r(i)})})}f(qr,"getAllStoreNames");function Qr(e,n){n=$.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var i=this,u;return e.name?u=new a(function(t){var s;e.name===r.name?s=i._dbInfo.db:s=openDatabase(e.name,"","",0),e.storeName?t({db:s,storeNames:[e.storeName]}):t(qr(s))}).then(function(t){return new a(function(s,d){t.db.transaction(function(p){function m(M){return new a(function(F,V){p.executeSql("DROP TABLE IF EXISTS "+M,[],function(){F()},function(W,q){V(q)})})}f(m,"dropTable");for(var w=[],R=0,O=t.storeNames.length;R<O;R++)w.push(m(t.storeNames[R]));a.all(w).then(function(){s()}).catch(function(M){d(M)})},function(p){d(p)})})}):u=a.reject("Invalid arguments"),c(u,n),u}f(Qr,"dropInstance$1");var Hr={_driver:"webSQLStorage",_initStorage:Yr,_support:Mr(),iterate:jr,getItem:zr,setItem:Xr,removeItem:Wr,clear:Gr,length:Vr,key:Jr,keys:Kr,dropInstance:Qr};function kr(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}f(kr,"isLocalStorageValid");function ke(e,n){var r=e.name+"/";return e.storeName!==n.storeName&&(r+=e.storeName+"/"),r}f(ke,"_getKeyPrefix");function Zr(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}f(Zr,"checkIfLocalStorageThrows");function en(){return!Zr()||localStorage.length>0}f(en,"_isLocalStorageUsable");function rn(e){var n=this,r={};if(e)for(var i in e)r[i]=e[i];return r.keyPrefix=ke(e,n._defaultConfig),en()?(n._dbInfo=r,r.serializer=we,a.resolve()):a.reject()}f(rn,"_initStorage$2");function nn(e){var n=this,r=n.ready().then(function(){for(var i=n._dbInfo.keyPrefix,u=localStorage.length-1;u>=0;u--){var t=localStorage.key(u);t.indexOf(i)===0&&localStorage.removeItem(t)}});return c(r,e),r}f(nn,"clear$2");function tn(e,n){var r=this;e=I(e);var i=r.ready().then(function(){var u=r._dbInfo,t=localStorage.getItem(u.keyPrefix+e);return t&&(t=u.serializer.deserialize(t)),t});return c(i,n),i}f(tn,"getItem$2");function on(e,n){var r=this,i=r.ready().then(function(){for(var u=r._dbInfo,t=u.keyPrefix,s=t.length,d=localStorage.length,p=1,m=0;m<d;m++){var w=localStorage.key(m);if(w.indexOf(t)===0){var R=localStorage.getItem(w);if(R&&(R=u.serializer.deserialize(R)),R=e(R,w.substring(s),p++),R!==void 0)return R}}});return c(i,n),i}f(on,"iterate$2");function an(e,n){var r=this,i=r.ready().then(function(){var u=r._dbInfo,t;try{t=localStorage.key(e)}catch{t=null}return t&&(t=t.substring(u.keyPrefix.length)),t});return c(i,n),i}f(an,"key$2");function fn(e){var n=this,r=n.ready().then(function(){for(var i=n._dbInfo,u=localStorage.length,t=[],s=0;s<u;s++){var d=localStorage.key(s);d.indexOf(i.keyPrefix)===0&&t.push(d.substring(i.keyPrefix.length))}return t});return c(r,e),r}f(fn,"keys$2");function un(e){var n=this,r=n.keys().then(function(i){return i.length});return c(r,e),r}f(un,"length$2");function cn(e,n){var r=this;e=I(e);var i=r.ready().then(function(){var u=r._dbInfo;localStorage.removeItem(u.keyPrefix+e)});return c(i,n),i}f(cn,"removeItem$2");function sn(e,n,r){var i=this;e=I(e);var u=i.ready().then(function(){n===void 0&&(n=null);var t=n;return new a(function(s,d){var p=i._dbInfo;p.serializer.serialize(n,function(m,w){if(w)d(w);else try{localStorage.setItem(p.keyPrefix+e,m),s(t)}catch(R){(R.name==="QuotaExceededError"||R.name==="NS_ERROR_DOM_QUOTA_REACHED")&&d(R),d(R)}})})});return c(u,r),u}f(sn,"setItem$2");function ln(e,n){if(n=$.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var i=this,u;return e.name?u=new a(function(t){e.storeName?t(ke(e,i._defaultConfig)):t(e.name+"/")}).then(function(t){for(var s=localStorage.length-1;s>=0;s--){var d=localStorage.key(s);d.indexOf(t)===0&&localStorage.removeItem(d)}}):u=a.reject("Invalid arguments"),c(u,n),u}f(ln,"dropInstance$2");var vn={_driver:"localStorageWrapper",_initStorage:rn,_support:kr(),iterate:on,getItem:tn,setItem:sn,removeItem:cn,clear:nn,length:un,key:an,keys:fn,dropInstance:ln},dn=f(function(n,r){return n===r||typeof n=="number"&&typeof r=="number"&&isNaN(n)&&isNaN(r)},"sameValue"),hn=f(function(n,r){for(var i=n.length,u=0;u<i;){if(dn(n[u],r))return!0;u++}return!1},"includes"),Ze=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},fe={},er={},ae={INDEXEDDB:Lr,WEBSQL:Hr,LOCALSTORAGE:vn},yn=[ae.INDEXEDDB._driver,ae.WEBSQL._driver,ae.LOCALSTORAGE._driver],de=["dropInstance"],xe=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(de),pn={description:"",driver:yn.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function gn(e,n){e[n]=function(){var r=arguments;return e.ready().then(function(){return e[n].apply(e,r)})}}f(gn,"callWhenReady");function Se(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var r in n)n.hasOwnProperty(r)&&(Ze(n[r])?arguments[0][r]=n[r].slice():arguments[0][r]=n[r])}return arguments[0]}f(Se,"extend");var mn=function(){function e(n){S(this,e);for(var r in ae)if(ae.hasOwnProperty(r)){var i=ae[r],u=i._driver;this[r]=u,fe[u]||this.defineDriver(i)}this._defaultConfig=Se({},pn),this._config=Se({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return f(e,"LocalForage"),e.prototype.config=f(function(r){if((typeof r>"u"?"undefined":A(r))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var i in r){if(i==="storeName"&&(r[i]=r[i].replace(/\W/g,"_")),i==="version"&&typeof r[i]!="number")return new Error("Database version must be a number.");this._config[i]=r[i]}return"driver"in r&&r.driver?this.setDriver(this._config.driver):!0}else return typeof r=="string"?this._config[r]:this._config},"config"),e.prototype.defineDriver=f(function(r,i,u){var t=new a(function(s,d){try{var p=r._driver,m=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!r._driver){d(m);return}for(var w=xe.concat("_initStorage"),R=0,O=w.length;R<O;R++){var M=w[R],F=!hn(de,M);if((F||r[M])&&typeof r[M]!="function"){d(m);return}}var V=f(function(){for(var ue=f(function(wn){return function(){var xn=new Error("Method "+wn+" is not implemented by the current driver"),rr=a.reject(xn);return c(rr,arguments[arguments.length-1]),rr}},"methodNotImplementedFactory"),Ee=0,_n=de.length;Ee<_n;Ee++){var Ie=de[Ee];r[Ie]||(r[Ie]=ue(Ie))}},"configureMissingMethods");V();var W=f(function(ue){fe[p]&&console.info("Redefining LocalForage driver: "+p),fe[p]=r,er[p]=ue,s()},"setDriverSupport");"_support"in r?r._support&&typeof r._support=="function"?r._support().then(W,d):W(!!r._support):W(!0)}catch(q){d(q)}});return b(t,i,u),t},"defineDriver"),e.prototype.driver=f(function(){return this._driver||null},"driver"),e.prototype.getDriver=f(function(r,i,u){var t=fe[r]?a.resolve(fe[r]):a.reject(new Error("Driver not found."));return b(t,i,u),t},"getDriver"),e.prototype.getSerializer=f(function(r){var i=a.resolve(we);return b(i,r),i},"getSerializer"),e.prototype.ready=f(function(r){var i=this,u=i._driverSet.then(function(){return i._ready===null&&(i._ready=i._initDriver()),i._ready});return b(u,r,r),u},"ready"),e.prototype.setDriver=f(function(r,i,u){var t=this;Ze(r)||(r=[r]);var s=this._getSupportedDrivers(r);function d(){t._config.driver=t.driver()}f(d,"setDriverToConfig");function p(R){return t._extend(R),d(),t._ready=t._initStorage(t._config),t._ready}f(p,"extendSelfWithDriver");function m(R){return function(){var O=0;function M(){for(;O<R.length;){var F=R[O];return O++,t._dbInfo=null,t._ready=null,t.getDriver(F).then(p).catch(M)}d();var V=new Error("No available storage method found.");return t._driverSet=a.reject(V),t._driverSet}return f(M,"driverPromiseLoop"),M()}}f(m,"initDriver");var w=this._driverSet!==null?this._driverSet.catch(function(){return a.resolve()}):a.resolve();return this._driverSet=w.then(function(){var R=s[0];return t._dbInfo=null,t._ready=null,t.getDriver(R).then(function(O){t._driver=O._driver,d(),t._wrapLibraryMethodsWithReady(),t._initDriver=m(s)})}).catch(function(){d();var R=new Error("No available storage method found.");return t._driverSet=a.reject(R),t._driverSet}),b(this._driverSet,i,u),this._driverSet},"setDriver"),e.prototype.supports=f(function(r){return!!er[r]},"supports"),e.prototype._extend=f(function(r){Se(this,r)},"_extend"),e.prototype._getSupportedDrivers=f(function(r){for(var i=[],u=0,t=r.length;u<t;u++){var s=r[u];this.supports(s)&&i.push(s)}return i},"_getSupportedDrivers"),e.prototype._wrapLibraryMethodsWithReady=f(function(){for(var r=0,i=xe.length;r<i;r++)gn(this,xe[r])},"_wrapLibraryMethodsWithReady"),e.prototype.createInstance=f(function(r){return new e(r)},"createInstance"),e}(),bn=new mn;x.exports=bn},{3:3}]},{},[4])(4)})})(ye);const ee=f(({q:_,r:E,s:g})=>`${_} ${E} ${g}`,"asCoordinateKey"),tr=[0,60,120,180,240,300];var Re={exports:{}};(function(_){(function(E,g,x){function D(o){var l=this,y=v();l.next=function(){var a=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=a-(l.c=a|0)},l.c=1,l.s0=y(" "),l.s1=y(" "),l.s2=y(" "),l.s0-=y(o),l.s0<0&&(l.s0+=1),l.s1-=y(o),l.s1<0&&(l.s1+=1),l.s2-=y(o),l.s2<0&&(l.s2+=1),y=null}f(D,"Alea");function A(o,l){return l.c=o.c,l.s0=o.s0,l.s1=o.s1,l.s2=o.s2,l}f(A,"copy");function S(o,l){var y=new D(o),a=l&&l.state,c=y.next;return c.int32=function(){return y.next()*4294967296|0},c.double=function(){return c()+(c()*2097152|0)*11102230246251565e-32},c.quick=c,a&&(typeof a=="object"&&A(a,y),c.state=function(){return A(y,{})}),c}f(S,"impl");function v(){var o=4022871197,l=f(function(y){y=String(y);for(var a=0;a<y.length;a++){o+=y.charCodeAt(a);var c=.02519603282416938*o;o=c>>>0,c-=o,c*=o,o=c>>>0,c-=o,o+=c*4294967296}return(o>>>0)*23283064365386963e-26},"mash");return l}f(v,"Mash"),g&&g.exports?g.exports=S:x&&x.amd?x(function(){return S}):this.alea=S})(K,_,!1)})(Re);var Ae={exports:{}};(function(_){(function(E,g,x){function D(v){var o=this,l="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var a=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^a^a>>>8},v===(v|0)?o.x=v:l+=v;for(var y=0;y<l.length+64;y++)o.x^=l.charCodeAt(y)|0,o.next()}f(D,"XorGen");function A(v,o){return o.x=v.x,o.y=v.y,o.z=v.z,o.w=v.w,o}f(A,"copy");function S(v,o){var l=new D(v),y=o&&o.state,a=f(function(){return(l.next()>>>0)/4294967296},"prng");return a.double=function(){do var c=l.next()>>>11,b=(l.next()>>>0)/4294967296,I=(c+b)/(1<<21);while(I===0);return I},a.int32=l.next,a.quick=a,y&&(typeof y=="object"&&A(y,l),a.state=function(){return A(l,{})}),a}f(S,"impl"),g&&g.exports?g.exports=S:x&&x.amd?x(function(){return S}):this.xor128=S})(K,_,!1)})(Ae);var Ne={exports:{}};(function(_){(function(E,g,x){function D(v){var o=this,l="";o.next=function(){var a=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^(a^a<<1))|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,v===(v|0)?o.x=v:l+=v;for(var y=0;y<l.length+64;y++)o.x^=l.charCodeAt(y)|0,y==l.length&&(o.d=o.x<<10^o.x>>>4),o.next()}f(D,"XorGen");function A(v,o){return o.x=v.x,o.y=v.y,o.z=v.z,o.w=v.w,o.v=v.v,o.d=v.d,o}f(A,"copy");function S(v,o){var l=new D(v),y=o&&o.state,a=f(function(){return(l.next()>>>0)/4294967296},"prng");return a.double=function(){do var c=l.next()>>>11,b=(l.next()>>>0)/4294967296,I=(c+b)/(1<<21);while(I===0);return I},a.int32=l.next,a.quick=a,y&&(typeof y=="object"&&A(y,l),a.state=function(){return A(l,{})}),a}f(S,"impl"),g&&g.exports?g.exports=S:x&&x.amd?x(function(){return S}):this.xorwow=S})(K,_,!1)})(Ne);var De={exports:{}};(function(_){(function(E,g,x){function D(v){var o=this;o.next=function(){var y=o.x,a=o.i,c,b;return c=y[a],c^=c>>>7,b=c^c<<24,c=y[a+1&7],b^=c^c>>>10,c=y[a+3&7],b^=c^c>>>3,c=y[a+4&7],b^=c^c<<7,c=y[a+7&7],c=c^c<<13,b^=c^c<<9,y[a]=b,o.i=a+1&7,b};function l(y,a){var c,b=[];if(a===(a|0))b[0]=a;else for(a=""+a,c=0;c<a.length;++c)b[c&7]=b[c&7]<<15^a.charCodeAt(c)+b[c+1&7]<<13;for(;b.length<8;)b.push(0);for(c=0;c<8&&b[c]===0;++c);for(c==8?b[7]=-1:b[c],y.x=b,y.i=0,c=256;c>0;--c)y.next()}f(l,"init"),l(o,v)}f(D,"XorGen");function A(v,o){return o.x=v.x.slice(),o.i=v.i,o}f(A,"copy");function S(v,o){v==null&&(v=+new Date);var l=new D(v),y=o&&o.state,a=f(function(){return(l.next()>>>0)/4294967296},"prng");return a.double=function(){do var c=l.next()>>>11,b=(l.next()>>>0)/4294967296,I=(c+b)/(1<<21);while(I===0);return I},a.int32=l.next,a.quick=a,y&&(y.x&&A(y,l),a.state=function(){return A(l,{})}),a}f(S,"impl"),g&&g.exports?g.exports=S:x&&x.amd?x(function(){return S}):this.xorshift7=S})(K,_,!1)})(De);var Te={exports:{}};(function(_){(function(E,g,x){function D(v){var o=this;o.next=function(){var y=o.w,a=o.X,c=o.i,b,I;return o.w=y=y+1640531527|0,I=a[c+34&127],b=a[c=c+1&127],I^=I<<13,b^=b<<17,I^=I>>>15,b^=b>>>12,I=a[c]=I^b,o.i=c,I+(y^y>>>16)|0};function l(y,a){var c,b,I,$,P,j=[],z=128;for(a===(a|0)?(b=a,a=null):(a=a+"\0",b=0,z=Math.max(z,a.length)),I=0,$=-32;$<z;++$)a&&(b^=a.charCodeAt(($+32)%a.length)),$===0&&(P=b),b^=b<<10,b^=b>>>15,b^=b<<4,b^=b>>>13,$>=0&&(P=P+1640531527|0,c=j[$&127]^=b+P,I=c==0?I+1:0);for(I>=128&&(j[(a&&a.length||0)&127]=-1),I=127,$=4*128;$>0;--$)b=j[I+34&127],c=j[I=I+1&127],b^=b<<13,c^=c<<17,b^=b>>>15,c^=c>>>12,j[I]=b^c;y.w=P,y.X=j,y.i=I}f(l,"init"),l(o,v)}f(D,"XorGen");function A(v,o){return o.i=v.i,o.w=v.w,o.X=v.X.slice(),o}f(A,"copy");function S(v,o){v==null&&(v=+new Date);var l=new D(v),y=o&&o.state,a=f(function(){return(l.next()>>>0)/4294967296},"prng");return a.double=function(){do var c=l.next()>>>11,b=(l.next()>>>0)/4294967296,I=(c+b)/(1<<21);while(I===0);return I},a.int32=l.next,a.quick=a,y&&(y.X&&A(y,l),a.state=function(){return A(l,{})}),a}f(S,"impl"),g&&g.exports?g.exports=S:x&&x.amd?x(function(){return S}):this.xor4096=S})(K,_,!1)})(Te);var Ce={exports:{}};(function(_){(function(E,g,x){function D(v){var o=this,l="";o.next=function(){var a=o.b,c=o.c,b=o.d,I=o.a;return a=a<<25^a>>>7^c,c=c-b|0,b=b<<24^b>>>8^I,I=I-a|0,o.b=a=a<<20^a>>>12^c,o.c=c=c-b|0,o.d=b<<16^c>>>16^I,o.a=I-a|0},o.a=0,o.b=0,o.c=-1640531527,o.d=1367130551,v===Math.floor(v)?(o.a=v/4294967296|0,o.b=v|0):l+=v;for(var y=0;y<l.length+20;y++)o.b^=l.charCodeAt(y)|0,o.next()}f(D,"XorGen");function A(v,o){return o.a=v.a,o.b=v.b,o.c=v.c,o.d=v.d,o}f(A,"copy");function S(v,o){var l=new D(v),y=o&&o.state,a=f(function(){return(l.next()>>>0)/4294967296},"prng");return a.double=function(){do var c=l.next()>>>11,b=(l.next()>>>0)/4294967296,I=(c+b)/(1<<21);while(I===0);return I},a.int32=l.next,a.quick=a,y&&(typeof y=="object"&&A(y,l),a.state=function(){return A(l,{})}),a}f(S,"impl"),g&&g.exports?g.exports=S:x&&x.amd?x(function(){return S}):this.tychei=S})(K,_,!1)})(Ce);var Oe={exports:{}},or={},ir=Object.freeze({__proto__:null,default:or}),ar=he(ir);(function(_){(function(E,g,x){var D=256,A=6,S=52,v="random",o=x.pow(D,A),l=x.pow(2,S),y=l*2,a=D-1,c;function b(B,h,C){var N=[];h=h==!0?{entropy:!0}:h||{};var T=j(P(h.entropy?[B,Q(g)]:B==null?z():B,3),N),L=new I(N),U=f(function(){for(var Y=L.g(A),X=o,G=0;Y<l;)Y=(Y+G)*D,X*=D,G=L.g(1);for(;Y>=y;)Y/=2,X/=2,G>>>=1;return(Y+G)/X},"prng");return U.int32=function(){return L.g(4)|0},U.quick=function(){return L.g(4)/4294967296},U.double=U,j(Q(L.S),g),(h.pass||C||function(Y,X,G,J){return J&&(J.S&&$(J,L),Y.state=function(){return $(L,{})}),G?(x[v]=Y,X):Y})(U,T,"global"in h?h.global:this==x,h.state)}f(b,"seedrandom");function I(B){var h,C=B.length,N=this,T=0,L=N.i=N.j=0,U=N.S=[];for(C||(B=[C++]);T<D;)U[T]=T++;for(T=0;T<D;T++)U[T]=U[L=a&L+B[T%C]+(h=U[T])],U[L]=h;(N.g=function(Y){for(var X,G=0,J=N.i,H=N.j,k=N.S;Y--;)X=k[J=a&J+1],G=G*D+k[a&(k[J]=k[H=a&H+X])+(k[H]=X)];return N.i=J,N.j=H,G})(D)}f(I,"ARC4");function $(B,h){return h.i=B.i,h.j=B.j,h.S=B.S.slice(),h}f($,"copy");function P(B,h){var C=[],N=typeof B,T;if(h&&N=="object")for(T in B)try{C.push(P(B[T],h-1))}catch{}return C.length?C:N=="string"?B:B+"\0"}f(P,"flatten");function j(B,h){for(var C=B+"",N,T=0;T<C.length;)h[a&T]=a&(N^=h[a&T]*19)+C.charCodeAt(T++);return Q(h)}f(j,"mixkey");function z(){try{var B;return c&&(B=c.randomBytes)?B=B(D):(B=new Uint8Array(D),(E.crypto||E.msCrypto).getRandomValues(B)),Q(B)}catch{var h=E.navigator,C=h&&h.plugins;return[+new Date,E,C,E.screen,Q(g)]}}f(z,"autoseed");function Q(B){return String.fromCharCode.apply(0,B)}if(f(Q,"tostring"),j(x.random(),g),_.exports){_.exports=b;try{c=ar}catch{}}else x["seed"+v]=b})(typeof self<"u"?self:K,[],Math)})(Oe);var fr=Re.exports,ur=Ae.exports,cr=Ne.exports,sr=De.exports,lr=Te.exports,vr=Ce.exports,te=Oe.exports;te.alea=fr,te.xor128=ur,te.xorwow=cr,te.xorshift7=sr,te.xor4096=lr,te.tychei=vr;var dr=te;function hr(_,E){let g=E.next();for(;_-- >0;)g=E.next();return g}f(hr,"skip");var yr=f(_=>{const E=dr(_);return g=>{if(g instanceof Map){const x=Math.floor(E()*g.size),{value:D}=hr(x,g.keys());return D}else return g[Math.floor(E()*g.length)]}},"Random");const pr=f(_=>{if(_===0)throw new Error("connection cannot be empty");if(_===63)return 63;for(;!(_&32)||_&1;){const g=_&32;_<<=1,_&=63,g&&(_|=1)}const E=(_&30)>>1;switch(E){case 0:return 32;case 8:return 48;case 4:return 40;case 2:return 36;case 1:return 40;case 12:return 56;case 6:return 44;case 3:return 52;case 9:return 44;case 10:return 52;case 5:return 42;case 14:return 60;case 7:return 46;case 11:return 54;case 13:return 46;case 15:return 62;default:throw new Error(`unhandled truncated case ${E.toString(2)} from connection ${_.toString(2)}`)}},"normalizeConnection");function*gr({q:_,r:E,s:g}){yield{coordinate:{q:_,r:E-1,s:g+1},direction:0},yield{coordinate:{q:_+1,r:E-1,s:g},direction:1},yield{coordinate:{q:_+1,r:E,s:g-1},direction:2},yield{coordinate:{q:_,r:E+1,s:g-1},direction:3},yield{coordinate:{q:_-1,r:E+1,s:g},direction:4},yield{coordinate:{q:_-1,r:E,s:g+1},direction:5}}f(gr,"Neighbours");function*Be(_,E){for(const g of gr(E)){const{coordinate:{q:x,r:D,s:A}}=g;x<-_||x>_||D<-_||D>_||A<-_||A>_||(yield g)}}f(Be,"ValidNeighbours");function*mr(_){for(let E=-_;E<=_;E++)for(let g=-_;g<=_;g++){const x=-E-g;-_<=x&&x<=_&&(yield{q:E,r:g,s:x})}}f(mr,"CoordinatesGenerator");function*br(_,E,g){for(const x of Be(_,E)){const{coordinate:D}=x,A=g.has(ee(D));yield{neighbour:x,connected:A}}}f(br,"PartitionNeighbours");const _r=f(_=>({forwards:32>>_,backwards:32>>(_+3)%6}),"asConnections"),Pe=f((_,E,g)=>{var x;(x=_[E])!=null||(_[E]=0),_[E]|=g},"addConnection");function*wr({size:_,seed:E}){const g=yr(E),x=[...mr(_)],D={},A=new Set,S=new Map,v=g(x);A.add(ee(v));for(const{coordinate:o}of Be(_,v))S.set(ee(o),o);for(;A.size<x.length;){if(S.size===0)throw new Error("working set unexpectedly empty");const o=g(S),l=[...br(_,S.get(o),A)],y=l.filter(({connected:P})=>P),{neighbour:{coordinate:a,direction:c}}=g(y),{forwards:b,backwards:I}=_r(c);Pe(D,o,b);const $=ee(a);Pe(D,$,I),A.add(o);for(const{neighbour:{coordinate:P}}of l.filter(({connected:j})=>!j))S.set(ee(P),P);S.delete(o)}for(const o of x){const l=D[ee(o)],y=g(tr),a=pr(l);yield{coordinate:o,orientation:y,connection:a}}}f(wr,"PuzzleGenerator");const pe=ye.exports.createInstance({driver:ye.exports.INDEXEDDB,name:"hexpanse",version:1,storeName:"gameState"}),xr=f(_=>{postMessage(_)},"reply");let se,le,oe;onmessage=f(async({data:_})=>{switch(_.type){case"restore":{se=_.config,le=nr(se);const E=await pe.getItem(le);if(E)oe=E;else{oe={};for(const{coordinate:g,orientation:x,connection:D}of wr(se))oe[ee(g)]={coordinate:g,orientation:x,connection:D};await pe.setItem(le,oe)}return xr({type:"restored",config:se,state:oe})}case"update cell":{const{coordinate:E,orientation:g}=_,x=oe[ee(E)];x&&(x.orientation=g,await pe.setItem(le,oe));return}}},"onmessage")})();
