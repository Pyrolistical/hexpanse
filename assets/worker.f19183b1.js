var On=Object.defineProperty;var i=(V,pe)=>On(V,"name",{value:pe,configurable:!0});(function(){"use strict";var V=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pe(l){var _=l.default;if(typeof _=="function"){var p=i(function(){return _.apply(this,arguments)},"a");p.prototype=_.prototype}else p={};return Object.defineProperty(p,"__esModule",{value:!0}),Object.keys(l).forEach(function(d){var w=Object.getOwnPropertyDescriptor(l,d);Object.defineProperty(p,d,w.get?w:{enumerable:!0,get:function(){return l[d]}})}),p}i(pe,"getAugmentedNamespace");var vr=i(function(l,_){_||(_={}),typeof _=="function"&&(_={cmp:_});var p=typeof _.cycles=="boolean"?_.cycles:!1,d=_.cmp&&function(E){return function(I){return function(h,f){var s={key:h,value:I[h]},g={key:f,value:I[f]};return E(s,g)}}}(_.cmp),w=[];return i(function E(I){if(I&&I.toJSON&&typeof I.toJSON=="function"&&(I=I.toJSON()),I!==void 0){if(typeof I=="number")return isFinite(I)?""+I:"null";if(typeof I!="object")return JSON.stringify(I);var h,f;if(Array.isArray(I)){for(f="[",h=0;h<I.length;h++)h&&(f+=","),f+=E(I[h])||"null";return f+"]"}if(I===null)return"null";if(w.indexOf(I)!==-1){if(p)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=w.push(I)-1,g=Object.keys(I).sort(d&&d(I));for(f="",h=0;h<g.length;h++){var o=g[h],c=E(I[o]);!c||(f&&(f+=","),f+=JSON.stringify(o)+":"+c)}return w.splice(s,1),"{"+f+"}"}},"stringify")(l)},"fastJsonStableStringify");function le(l){throw new Error('Could not dynamically require "'+l+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}i(le,"commonjsRequire");var ge={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(l,_){(function(p){l.exports=p()})(function(){return i(function p(d,w,E){function I(s,g){if(!w[s]){if(!d[s]){var o=typeof le=="function"&&le;if(!g&&o)return o(s,!0);if(h)return h(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var y=w[s]={exports:{}};d[s][0].call(y.exports,function(A){var M=d[s][1][A];return I(M||A)},y,y.exports,p,d,w,E)}return w[s].exports}i(I,"s");for(var h=typeof le=="function"&&le,f=0;f<E.length;f++)I(E[f]);return I},"e")({1:[function(p,d,w){(function(E){var I=E.MutationObserver||E.WebKitMutationObserver,h;if(I){var f=0,s=new I(A),g=E.document.createTextNode("");s.observe(g,{characterData:!0}),h=i(function(){g.data=f=++f%2},"scheduleDrain")}else if(!E.setImmediate&&typeof E.MessageChannel<"u"){var o=new E.MessageChannel;o.port1.onmessage=A,h=i(function(){o.port2.postMessage(0)},"scheduleDrain")}else"document"in E&&"onreadystatechange"in E.document.createElement("script")?h=i(function(){var P=E.document.createElement("script");P.onreadystatechange=function(){A(),P.onreadystatechange=null,P.parentNode.removeChild(P),P=null},E.document.documentElement.appendChild(P)},"scheduleDrain"):h=i(function(){setTimeout(A,0)},"scheduleDrain");var c,y=[];function A(){c=!0;for(var P,Y,L=y.length;L;){for(Y=y,y=[],P=-1;++P<L;)Y[P]();L=y.length}c=!1}i(A,"nextTick"),d.exports=M;function M(P){y.push(P)===1&&!c&&h()}i(M,"immediate")}).call(this,typeof V<"u"?V:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(p,d,w){var E=p(1);function I(){}i(I,"INTERNAL");var h={},f=["REJECTED"],s=["FULFILLED"],g=["PENDING"];d.exports=o;function o(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,m!==I&&M(this,m)}i(o,"Promise"),o.prototype.catch=function(m){return this.then(null,m)},o.prototype.then=function(m,C){if(typeof m!="function"&&this.state===s||typeof C!="function"&&this.state===f)return this;var D=new this.constructor(I);if(this.state!==g){var T=this.state===s?m:C;y(D,T,this.outcome)}else this.queue.push(new c(D,m,C));return D};function c(m,C,D){this.promise=m,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof D=="function"&&(this.onRejected=D,this.callRejected=this.otherCallRejected)}i(c,"QueueItem"),c.prototype.callFulfilled=function(m){h.resolve(this.promise,m)},c.prototype.otherCallFulfilled=function(m){y(this.promise,this.onFulfilled,m)},c.prototype.callRejected=function(m){h.reject(this.promise,m)},c.prototype.otherCallRejected=function(m){y(this.promise,this.onRejected,m)};function y(m,C,D){E(function(){var T;try{T=C(D)}catch(F){return h.reject(m,F)}T===m?h.reject(m,new TypeError("Cannot resolve promise with itself")):h.resolve(m,T)})}i(y,"unwrap"),h.resolve=function(m,C){var D=P(A,C);if(D.status==="error")return h.reject(m,D.value);var T=D.value;if(T)M(m,T);else{m.state=s,m.outcome=C;for(var F=-1,U=m.queue.length;++F<U;)m.queue[F].callFulfilled(C)}return m},h.reject=function(m,C){m.state=f,m.outcome=C;for(var D=-1,T=m.queue.length;++D<T;)m.queue[D].callRejected(C);return m};function A(m){var C=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof C=="function")return i(function(){C.apply(m,arguments)},"appyThen")}i(A,"getThen");function M(m,C){var D=!1;function T(W){D||(D=!0,h.reject(m,W))}i(T,"onError");function F(W){D||(D=!0,h.resolve(m,W))}i(F,"onSuccess");function U(){C(F,T)}i(U,"tryToUnwrap");var j=P(U);j.status==="error"&&T(j.value)}i(M,"safelyResolveThenable");function P(m,C){var D={};try{D.value=m(C),D.status="success"}catch(T){D.status="error",D.value=T}return D}i(P,"tryCatch"),o.resolve=Y;function Y(m){return m instanceof this?m:h.resolve(new this(I),m)}i(Y,"resolve"),o.reject=L;function L(m){var C=new this(I);return h.reject(C,m)}i(L,"reject"),o.all=Q;function Q(m){var C=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=m.length,T=!1;if(!D)return this.resolve([]);for(var F=new Array(D),U=0,j=-1,W=new this(I);++j<D;)q(m[j],j);return W;function q(K,Z){C.resolve(K).then(ee,function(fe){T||(T=!0,h.reject(W,fe))});function ee(fe){F[Z]=fe,++U===D&&!T&&(T=!0,h.resolve(W,F))}i(ee,"resolveFromAll")}}i(Q,"all"),o.race=O;function O(m){var C=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=m.length,T=!1;if(!D)return this.resolve([]);for(var F=-1,U=new this(I);++F<D;)j(m[F]);return U;function j(W){C.resolve(W).then(function(q){T||(T=!0,h.resolve(U,q))},function(q){T||(T=!0,h.reject(U,q))})}}i(O,"race")},{1:1}],3:[function(p,d,w){(function(E){typeof E.Promise!="function"&&(E.Promise=p(2))}).call(this,typeof V<"u"?V:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(p,d,w){var E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function I(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}i(I,"_classCallCheck");function h(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}i(h,"getIDB");var f=h();function s(){try{if(!f||!f.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}i(s,"isIndexedDBValid");function g(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(t){if(t.name!=="TypeError")throw t;for(var r=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,a=new r,u=0;u<e.length;u+=1)a.append(e[u]);return a.getBlob(n.type)}}i(g,"createBlob"),typeof Promise>"u"&&p(3);var o=Promise;function c(e,n){n&&e.then(function(r){n(null,r)},function(r){n(r)})}i(c,"executeCallback");function y(e,n,r){typeof n=="function"&&e.then(n),typeof r=="function"&&e.catch(r)}i(y,"executeTwoCallbacks");function A(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}i(A,"normalizeKey");function M(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}i(M,"getCallback");var P="local-forage-detect-blob-support",Y=void 0,L={},Q=Object.prototype.toString,O="readonly",m="readwrite";function C(e){for(var n=e.length,r=new ArrayBuffer(n),a=new Uint8Array(r),u=0;u<n;u++)a[u]=e.charCodeAt(u);return r}i(C,"_binStringToArrayBuffer");function D(e){return new o(function(n){var r=e.transaction(P,m),a=g([""]);r.objectStore(P).put(a,"key"),r.onabort=function(u){u.preventDefault(),u.stopPropagation(),n(!1)},r.oncomplete=function(){var u=navigator.userAgent.match(/Chrome\/(\d+)/),t=navigator.userAgent.match(/Edge\//);n(t||!u||parseInt(u[1],10)>=43)}}).catch(function(){return!1})}i(D,"_checkBlobSupportWithoutCaching");function T(e){return typeof Y=="boolean"?o.resolve(Y):D(e).then(function(n){return Y=n,Y})}i(T,"_checkBlobSupport");function F(e){var n=L[e.name],r={};r.promise=new o(function(a,u){r.resolve=a,r.reject=u}),n.deferredOperations.push(r),n.dbReady?n.dbReady=n.dbReady.then(function(){return r.promise}):n.dbReady=r.promise}i(F,"_deferReadiness");function U(e){var n=L[e.name],r=n.deferredOperations.pop();if(r)return r.resolve(),r.promise}i(U,"_advanceReadiness");function j(e,n){var r=L[e.name],a=r.deferredOperations.pop();if(a)return a.reject(n),a.promise}i(j,"_rejectReadiness");function W(e,n){return new o(function(r,a){if(L[e.name]=L[e.name]||Ge(),e.db)if(n)F(e),e.db.close();else return r(e.db);var u=[e.name];n&&u.push(e.version);var t=f.open.apply(f,u);n&&(t.onupgradeneeded=function(v){var b=t.result;try{b.createObjectStore(e.storeName),v.oldVersion<=1&&b.createObjectStore(P)}catch(x){if(x.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+v.oldVersion+" to version "+v.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw x}}),t.onerror=function(v){v.preventDefault(),a(t.error)},t.onsuccess=function(){var v=t.result;v.onversionchange=function(b){b.target.close()},r(v),U(e)}})}i(W,"_getConnection");function q(e){return W(e,!1)}i(q,"_getOriginalConnection");function K(e){return W(e,!0)}i(K,"_getUpgradedConnection");function Z(e,n){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),a=e.version<e.db.version,u=e.version>e.db.version;if(a&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),u||r){if(r){var t=e.db.version+1;t>e.version&&(e.version=t)}return!0}return!1}i(Z,"_isUpgradeNeeded");function ee(e){return new o(function(n,r){var a=new FileReader;a.onerror=r,a.onloadend=function(u){var t=btoa(u.target.result||"");n({__local_forage_encoded_blob:!0,data:t,type:e.type})},a.readAsBinaryString(e)})}i(ee,"_encodeBlob");function fe(e){var n=C(atob(e.data));return g([n],{type:e.type})}i(fe,"_decodeBlob");function ke(e){return e&&e.__local_forage_encoded_blob}i(ke,"_isEncodedBlob");function Or(e){var n=this,r=n._initReady().then(function(){var a=L[n._dbInfo.name];if(a&&a.dbReady)return a.dbReady});return y(r,e,e),r}i(Or,"_fullyReady");function Br(e){F(e);for(var n=L[e.name],r=n.forages,a=0;a<r.length;a++){var u=r[a];u._dbInfo.db&&(u._dbInfo.db.close(),u._dbInfo.db=null)}return e.db=null,q(e).then(function(t){return e.db=t,Z(e)?K(e):t}).then(function(t){e.db=n.db=t;for(var v=0;v<r.length;v++)r[v]._dbInfo.db=t}).catch(function(t){throw j(e,t),t})}i(Br,"_tryReconnect");function re(e,n,r,a){a===void 0&&(a=1);try{var u=e.db.transaction(e.storeName,n);r(null,u)}catch(t){if(a>0&&(!e.db||t.name==="InvalidStateError"||t.name==="NotFoundError"))return o.resolve().then(function(){if(!e.db||t.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),K(e)}).then(function(){return Br(e).then(function(){re(e,n,r,a-1)})}).catch(r);r(t)}}i(re,"createTransaction");function Ge(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}i(Ge,"createDbContext");function Pr(e){var n=this,r={db:null};if(e)for(var a in e)r[a]=e[a];var u=L[r.name];u||(u=Ge(),L[r.name]=u),u.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=Or);var t=[];function v(){return o.resolve()}i(v,"ignoreErrors");for(var b=0;b<u.forages.length;b++){var x=u.forages[b];x!==n&&t.push(x._initReady().catch(v))}var S=u.forages.slice(0);return o.all(t).then(function(){return r.db=u.db,q(r)}).then(function(R){return r.db=R,Z(r,n._defaultConfig.version)?K(r):R}).then(function(R){r.db=u.db=R,n._dbInfo=r;for(var N=0;N<S.length;N++){var B=S[N];B!==n&&(B._dbInfo.db=r.db,B._dbInfo.version=r.version)}})}i(Pr,"_initStorage");function Lr(e,n){var r=this;e=A(e);var a=new o(function(u,t){r.ready().then(function(){re(r._dbInfo,O,function(v,b){if(v)return t(v);try{var x=b.objectStore(r._dbInfo.storeName),S=x.get(e);S.onsuccess=function(){var R=S.result;R===void 0&&(R=null),ke(R)&&(R=fe(R)),u(R)},S.onerror=function(){t(S.error)}}catch(R){t(R)}})}).catch(t)});return c(a,n),a}i(Lr,"getItem");function Mr(e,n){var r=this,a=new o(function(u,t){r.ready().then(function(){re(r._dbInfo,O,function(v,b){if(v)return t(v);try{var x=b.objectStore(r._dbInfo.storeName),S=x.openCursor(),R=1;S.onsuccess=function(){var N=S.result;if(N){var B=N.value;ke(B)&&(B=fe(B));var $=e(B,N.key,R++);$!==void 0?u($):N.continue()}else u()},S.onerror=function(){t(S.error)}}catch(N){t(N)}})}).catch(t)});return c(a,n),a}i(Mr,"iterate");function Fr(e,n,r){var a=this;e=A(e);var u=new o(function(t,v){var b;a.ready().then(function(){return b=a._dbInfo,Q.call(n)==="[object Blob]"?T(b.db).then(function(x){return x?n:ee(n)}):n}).then(function(x){re(a._dbInfo,m,function(S,R){if(S)return v(S);try{var N=R.objectStore(a._dbInfo.storeName);x===null&&(x=void 0);var B=N.put(x,e);R.oncomplete=function(){x===void 0&&(x=null),t(x)},R.onabort=R.onerror=function(){var $=B.error?B.error:B.transaction.error;v($)}}catch($){v($)}})}).catch(v)});return c(u,r),u}i(Fr,"setItem");function $r(e,n){var r=this;e=A(e);var a=new o(function(u,t){r.ready().then(function(){re(r._dbInfo,m,function(v,b){if(v)return t(v);try{var x=b.objectStore(r._dbInfo.storeName),S=x.delete(e);b.oncomplete=function(){u()},b.onerror=function(){t(S.error)},b.onabort=function(){var R=S.error?S.error:S.transaction.error;t(R)}}catch(R){t(R)}})}).catch(t)});return c(a,n),a}i($r,"removeItem");function zr(e){var n=this,r=new o(function(a,u){n.ready().then(function(){re(n._dbInfo,m,function(t,v){if(t)return u(t);try{var b=v.objectStore(n._dbInfo.storeName),x=b.clear();v.oncomplete=function(){a()},v.onabort=v.onerror=function(){var S=x.error?x.error:x.transaction.error;u(S)}}catch(S){u(S)}})}).catch(u)});return c(r,e),r}i(zr,"clear");function Ur(e){var n=this,r=new o(function(a,u){n.ready().then(function(){re(n._dbInfo,O,function(t,v){if(t)return u(t);try{var b=v.objectStore(n._dbInfo.storeName),x=b.count();x.onsuccess=function(){a(x.result)},x.onerror=function(){u(x.error)}}catch(S){u(S)}})}).catch(u)});return c(r,e),r}i(Ur,"length");function jr(e,n){var r=this,a=new o(function(u,t){if(e<0){u(null);return}r.ready().then(function(){re(r._dbInfo,O,function(v,b){if(v)return t(v);try{var x=b.objectStore(r._dbInfo.storeName),S=!1,R=x.openKeyCursor();R.onsuccess=function(){var N=R.result;if(!N){u(null);return}e===0||S?u(N.key):(S=!0,N.advance(e))},R.onerror=function(){t(R.error)}}catch(N){t(N)}})}).catch(t)});return c(a,n),a}i(jr,"key");function Yr(e){var n=this,r=new o(function(a,u){n.ready().then(function(){re(n._dbInfo,O,function(t,v){if(t)return u(t);try{var b=v.objectStore(n._dbInfo.storeName),x=b.openKeyCursor(),S=[];x.onsuccess=function(){var R=x.result;if(!R){a(S);return}S.push(R.key),R.continue()},x.onerror=function(){u(x.error)}}catch(R){u(R)}})}).catch(u)});return c(r,e),r}i(Yr,"keys");function Wr(e,n){n=M.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var a=this,u;if(!e.name)u=o.reject("Invalid arguments");else{var t=e.name===r.name&&a._dbInfo.db,v=t?o.resolve(a._dbInfo.db):q(e).then(function(b){var x=L[e.name],S=x.forages;x.db=b;for(var R=0;R<S.length;R++)S[R]._dbInfo.db=b;return b});e.storeName?u=v.then(function(b){if(!!b.objectStoreNames.contains(e.storeName)){var x=b.version+1;F(e);var S=L[e.name],R=S.forages;b.close();for(var N=0;N<R.length;N++){var B=R[N];B._dbInfo.db=null,B._dbInfo.version=x}var $=new o(function(z,k){var X=f.open(e.name,x);X.onerror=function(H){var se=X.result;se.close(),k(H)},X.onupgradeneeded=function(){var H=X.result;H.deleteObjectStore(e.storeName)},X.onsuccess=function(){var H=X.result;H.close(),z(H)}});return $.then(function(z){S.db=z;for(var k=0;k<R.length;k++){var X=R[k];X._dbInfo.db=z,U(X._dbInfo)}}).catch(function(z){throw(j(e,z)||o.resolve()).catch(function(){}),z})}}):u=v.then(function(b){F(e);var x=L[e.name],S=x.forages;b.close();for(var R=0;R<S.length;R++){var N=S[R];N._dbInfo.db=null}var B=new o(function($,z){var k=f.deleteDatabase(e.name);k.onerror=function(){var X=k.result;X&&X.close(),z(k.error)},k.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},k.onsuccess=function(){var X=k.result;X&&X.close(),$(X)}});return B.then(function($){x.db=$;for(var z=0;z<S.length;z++){var k=S[z];U(k._dbInfo)}}).catch(function($){throw(j(e,$)||o.resolve()).catch(function(){}),$})})}return c(u,n),u}i(Wr,"dropInstance");var Xr={_driver:"asyncStorage",_initStorage:Pr,_support:s(),iterate:Mr,getItem:Lr,setItem:Fr,removeItem:$r,clear:zr,length:Ur,key:jr,keys:Yr,dropInstance:Wr};function qr(){return typeof openDatabase=="function"}i(qr,"isWebSQLValid");var te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",kr="~~local_forage_type~",Ke=/^~~local_forage_type~([^~]+)~/,he="__lfsc__:",_e=he.length,xe="arbf",Se="blob",Ve="si08",Je="ui08",Qe="uic8",He="si16",Ze="si32",er="ur16",rr="ui32",nr="fl32",tr="fl64",or=_e+xe.length,ir=Object.prototype.toString;function ar(e){var n=e.length*.75,r=e.length,a,u=0,t,v,b,x;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var S=new ArrayBuffer(n),R=new Uint8Array(S);for(a=0;a<r;a+=4)t=te.indexOf(e[a]),v=te.indexOf(e[a+1]),b=te.indexOf(e[a+2]),x=te.indexOf(e[a+3]),R[u++]=t<<2|v>>4,R[u++]=(v&15)<<4|b>>2,R[u++]=(b&3)<<6|x&63;return S}i(ar,"stringToBuffer");function Ee(e){var n=new Uint8Array(e),r="",a;for(a=0;a<n.length;a+=3)r+=te[n[a]>>2],r+=te[(n[a]&3)<<4|n[a+1]>>4],r+=te[(n[a+1]&15)<<2|n[a+2]>>6],r+=te[n[a+2]&63];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}i(Ee,"bufferToString");function Gr(e,n){var r="";if(e&&(r=ir.call(e)),e&&(r==="[object ArrayBuffer]"||e.buffer&&ir.call(e.buffer)==="[object ArrayBuffer]")){var a,u=he;e instanceof ArrayBuffer?(a=e,u+=xe):(a=e.buffer,r==="[object Int8Array]"?u+=Ve:r==="[object Uint8Array]"?u+=Je:r==="[object Uint8ClampedArray]"?u+=Qe:r==="[object Int16Array]"?u+=He:r==="[object Uint16Array]"?u+=er:r==="[object Int32Array]"?u+=Ze:r==="[object Uint32Array]"?u+=rr:r==="[object Float32Array]"?u+=nr:r==="[object Float64Array]"?u+=tr:n(new Error("Failed to get type for BinaryArray"))),n(u+Ee(a))}else if(r==="[object Blob]"){var t=new FileReader;t.onload=function(){var v=kr+e.type+"~"+Ee(this.result);n(he+Se+v)},t.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(v){console.error("Couldn't convert value into a JSON string: ",e),n(null,v)}}i(Gr,"serialize");function Kr(e){if(e.substring(0,_e)!==he)return JSON.parse(e);var n=e.substring(or),r=e.substring(_e,or),a;if(r===Se&&Ke.test(n)){var u=n.match(Ke);a=u[1],n=n.substring(u[0].length)}var t=ar(n);switch(r){case xe:return t;case Se:return g([t],{type:a});case Ve:return new Int8Array(t);case Je:return new Uint8Array(t);case Qe:return new Uint8ClampedArray(t);case He:return new Int16Array(t);case er:return new Uint16Array(t);case Ze:return new Int32Array(t);case rr:return new Uint32Array(t);case nr:return new Float32Array(t);case tr:return new Float64Array(t);default:throw new Error("Unkown type: "+r)}}i(Kr,"deserialize");var Ie={serialize:Gr,deserialize:Kr,stringToBuffer:ar,bufferToString:Ee};function fr(e,n,r,a){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,a)}i(fr,"createDbTable");function Vr(e){var n=this,r={db:null};if(e)for(var a in e)r[a]=typeof e[a]!="string"?e[a].toString():e[a];var u=new o(function(t,v){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(b){return v(b)}r.db.transaction(function(b){fr(b,r,function(){n._dbInfo=r,t()},function(x,S){v(S)})},v)});return r.serializer=Ie,u}i(Vr,"_initStorage$1");function oe(e,n,r,a,u,t){e.executeSql(r,a,u,function(v,b){b.code===b.SYNTAX_ERR?v.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(x,S){S.rows.length?t(x,b):fr(x,n,function(){x.executeSql(r,a,u,t)},t)},t):t(v,b)},t)}i(oe,"tryExecuteSql");function Jr(e,n){var r=this;e=A(e);var a=new o(function(u,t){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(b){oe(b,v,"SELECT * FROM "+v.storeName+" WHERE key = ? LIMIT 1",[e],function(x,S){var R=S.rows.length?S.rows.item(0).value:null;R&&(R=v.serializer.deserialize(R)),u(R)},function(x,S){t(S)})})}).catch(t)});return c(a,n),a}i(Jr,"getItem$1");function Qr(e,n){var r=this,a=new o(function(u,t){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(b){oe(b,v,"SELECT * FROM "+v.storeName,[],function(x,S){for(var R=S.rows,N=R.length,B=0;B<N;B++){var $=R.item(B),z=$.value;if(z&&(z=v.serializer.deserialize(z)),z=e(z,$.key,B+1),z!==void 0){u(z);return}}u()},function(x,S){t(S)})})}).catch(t)});return c(a,n),a}i(Qr,"iterate$1");function ur(e,n,r,a){var u=this;e=A(e);var t=new o(function(v,b){u.ready().then(function(){n===void 0&&(n=null);var x=n,S=u._dbInfo;S.serializer.serialize(n,function(R,N){N?b(N):S.db.transaction(function(B){oe(B,S,"INSERT OR REPLACE INTO "+S.storeName+" (key, value) VALUES (?, ?)",[e,R],function(){v(x)},function($,z){b(z)})},function(B){if(B.code===B.QUOTA_ERR){if(a>0){v(ur.apply(u,[e,x,r,a-1]));return}b(B)}})})}).catch(b)});return c(t,r),t}i(ur,"_setItem");function Hr(e,n,r){return ur.apply(this,[e,n,r,1])}i(Hr,"setItem$1");function Zr(e,n){var r=this;e=A(e);var a=new o(function(u,t){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(b){oe(b,v,"DELETE FROM "+v.storeName+" WHERE key = ?",[e],function(){u()},function(x,S){t(S)})})}).catch(t)});return c(a,n),a}i(Zr,"removeItem$1");function en(e){var n=this,r=new o(function(a,u){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(v){oe(v,t,"DELETE FROM "+t.storeName,[],function(){a()},function(b,x){u(x)})})}).catch(u)});return c(r,e),r}i(en,"clear$1");function rn(e){var n=this,r=new o(function(a,u){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(v){oe(v,t,"SELECT COUNT(key) as c FROM "+t.storeName,[],function(b,x){var S=x.rows.item(0).c;a(S)},function(b,x){u(x)})})}).catch(u)});return c(r,e),r}i(rn,"length$1");function nn(e,n){var r=this,a=new o(function(u,t){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(b){oe(b,v,"SELECT key FROM "+v.storeName+" WHERE id = ? LIMIT 1",[e+1],function(x,S){var R=S.rows.length?S.rows.item(0).key:null;u(R)},function(x,S){t(S)})})}).catch(t)});return c(a,n),a}i(nn,"key$1");function tn(e){var n=this,r=new o(function(a,u){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(v){oe(v,t,"SELECT key FROM "+t.storeName,[],function(b,x){for(var S=[],R=0;R<x.rows.length;R++)S.push(x.rows.item(R).key);a(S)},function(b,x){u(x)})})}).catch(u)});return c(r,e),r}i(tn,"keys$1");function on(e){return new o(function(n,r){e.transaction(function(a){a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(u,t){for(var v=[],b=0;b<t.rows.length;b++)v.push(t.rows.item(b).name);n({db:e,storeNames:v})},function(u,t){r(t)})},function(a){r(a)})})}i(on,"getAllStoreNames");function an(e,n){n=M.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var a=this,u;return e.name?u=new o(function(t){var v;e.name===r.name?v=a._dbInfo.db:v=openDatabase(e.name,"","",0),e.storeName?t({db:v,storeNames:[e.storeName]}):t(on(v))}).then(function(t){return new o(function(v,b){t.db.transaction(function(x){function S($){return new o(function(z,k){x.executeSql("DROP TABLE IF EXISTS "+$,[],function(){z()},function(X,H){k(H)})})}i(S,"dropTable");for(var R=[],N=0,B=t.storeNames.length;N<B;N++)R.push(S(t.storeNames[N]));o.all(R).then(function(){v()}).catch(function($){b($)})},function(x){b(x)})})}):u=o.reject("Invalid arguments"),c(u,n),u}i(an,"dropInstance$1");var fn={_driver:"webSQLStorage",_initStorage:Vr,_support:qr(),iterate:Qr,getItem:Jr,setItem:Hr,removeItem:Zr,clear:en,length:rn,key:nn,keys:tn,dropInstance:an};function un(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}i(un,"isLocalStorageValid");function cr(e,n){var r=e.name+"/";return e.storeName!==n.storeName&&(r+=e.storeName+"/"),r}i(cr,"_getKeyPrefix");function cn(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}i(cn,"checkIfLocalStorageThrows");function sn(){return!cn()||localStorage.length>0}i(sn,"_isLocalStorageUsable");function ln(e){var n=this,r={};if(e)for(var a in e)r[a]=e[a];return r.keyPrefix=cr(e,n._defaultConfig),sn()?(n._dbInfo=r,r.serializer=Ie,o.resolve()):o.reject()}i(ln,"_initStorage$2");function dn(e){var n=this,r=n.ready().then(function(){for(var a=n._dbInfo.keyPrefix,u=localStorage.length-1;u>=0;u--){var t=localStorage.key(u);t.indexOf(a)===0&&localStorage.removeItem(t)}});return c(r,e),r}i(dn,"clear$2");function vn(e,n){var r=this;e=A(e);var a=r.ready().then(function(){var u=r._dbInfo,t=localStorage.getItem(u.keyPrefix+e);return t&&(t=u.serializer.deserialize(t)),t});return c(a,n),a}i(vn,"getItem$2");function hn(e,n){var r=this,a=r.ready().then(function(){for(var u=r._dbInfo,t=u.keyPrefix,v=t.length,b=localStorage.length,x=1,S=0;S<b;S++){var R=localStorage.key(S);if(R.indexOf(t)===0){var N=localStorage.getItem(R);if(N&&(N=u.serializer.deserialize(N)),N=e(N,R.substring(v),x++),N!==void 0)return N}}});return c(a,n),a}i(hn,"iterate$2");function yn(e,n){var r=this,a=r.ready().then(function(){var u=r._dbInfo,t;try{t=localStorage.key(e)}catch{t=null}return t&&(t=t.substring(u.keyPrefix.length)),t});return c(a,n),a}i(yn,"key$2");function pn(e){var n=this,r=n.ready().then(function(){for(var a=n._dbInfo,u=localStorage.length,t=[],v=0;v<u;v++){var b=localStorage.key(v);b.indexOf(a.keyPrefix)===0&&t.push(b.substring(a.keyPrefix.length))}return t});return c(r,e),r}i(pn,"keys$2");function gn(e){var n=this,r=n.keys().then(function(a){return a.length});return c(r,e),r}i(gn,"length$2");function mn(e,n){var r=this;e=A(e);var a=r.ready().then(function(){var u=r._dbInfo;localStorage.removeItem(u.keyPrefix+e)});return c(a,n),a}i(mn,"removeItem$2");function bn(e,n,r){var a=this;e=A(e);var u=a.ready().then(function(){n===void 0&&(n=null);var t=n;return new o(function(v,b){var x=a._dbInfo;x.serializer.serialize(n,function(S,R){if(R)b(R);else try{localStorage.setItem(x.keyPrefix+e,S),v(t)}catch(N){(N.name==="QuotaExceededError"||N.name==="NS_ERROR_DOM_QUOTA_REACHED")&&b(N),b(N)}})})});return c(u,r),u}i(bn,"setItem$2");function wn(e,n){if(n=M.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var a=this,u;return e.name?u=new o(function(t){e.storeName?t(cr(e,a._defaultConfig)):t(e.name+"/")}).then(function(t){for(var v=localStorage.length-1;v>=0;v--){var b=localStorage.key(v);b.indexOf(t)===0&&localStorage.removeItem(b)}}):u=o.reject("Invalid arguments"),c(u,n),u}i(wn,"dropInstance$2");var _n={_driver:"localStorageWrapper",_initStorage:ln,_support:un(),iterate:hn,getItem:vn,setItem:bn,removeItem:mn,clear:dn,length:gn,key:yn,keys:pn,dropInstance:wn},xn=i(function(n,r){return n===r||typeof n=="number"&&typeof r=="number"&&isNaN(n)&&isNaN(r)},"sameValue"),Sn=i(function(n,r){for(var a=n.length,u=0;u<a;){if(xn(n[u],r))return!0;u++}return!1},"includes"),sr=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},ce={},lr={},ue={INDEXEDDB:Xr,WEBSQL:fn,LOCALSTORAGE:_n},En=[ue.INDEXEDDB._driver,ue.WEBSQL._driver,ue.LOCALSTORAGE._driver],ye=["dropInstance"],Re=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ye),In={description:"",driver:En.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Rn(e,n){e[n]=function(){var r=arguments;return e.ready().then(function(){return e[n].apply(e,r)})}}i(Rn,"callWhenReady");function Ae(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var r in n)n.hasOwnProperty(r)&&(sr(n[r])?arguments[0][r]=n[r].slice():arguments[0][r]=n[r])}return arguments[0]}i(Ae,"extend");var An=function(){function e(n){I(this,e);for(var r in ue)if(ue.hasOwnProperty(r)){var a=ue[r],u=a._driver;this[r]=u,ce[u]||this.defineDriver(a)}this._defaultConfig=Ae({},In),this._config=Ae({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return i(e,"LocalForage"),e.prototype.config=i(function(r){if((typeof r>"u"?"undefined":E(r))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var a in r){if(a==="storeName"&&(r[a]=r[a].replace(/\W/g,"_")),a==="version"&&typeof r[a]!="number")return new Error("Database version must be a number.");this._config[a]=r[a]}return"driver"in r&&r.driver?this.setDriver(this._config.driver):!0}else return typeof r=="string"?this._config[r]:this._config},"config"),e.prototype.defineDriver=i(function(r,a,u){var t=new o(function(v,b){try{var x=r._driver,S=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!r._driver){b(S);return}for(var R=Re.concat("_initStorage"),N=0,B=R.length;N<B;N++){var $=R[N],z=!Sn(ye,$);if((z||r[$])&&typeof r[$]!="function"){b(S);return}}var k=i(function(){for(var se=i(function(Cn){return function(){var Tn=new Error("Method "+Cn+" is not implemented by the current driver"),dr=o.reject(Tn);return c(dr,arguments[arguments.length-1]),dr}},"methodNotImplementedFactory"),Ne=0,Dn=ye.length;Ne<Dn;Ne++){var De=ye[Ne];r[De]||(r[De]=se(De))}},"configureMissingMethods");k();var X=i(function(se){ce[x]&&console.info("Redefining LocalForage driver: "+x),ce[x]=r,lr[x]=se,v()},"setDriverSupport");"_support"in r?r._support&&typeof r._support=="function"?r._support().then(X,b):X(!!r._support):X(!0)}catch(H){b(H)}});return y(t,a,u),t},"defineDriver"),e.prototype.driver=i(function(){return this._driver||null},"driver"),e.prototype.getDriver=i(function(r,a,u){var t=ce[r]?o.resolve(ce[r]):o.reject(new Error("Driver not found."));return y(t,a,u),t},"getDriver"),e.prototype.getSerializer=i(function(r){var a=o.resolve(Ie);return y(a,r),a},"getSerializer"),e.prototype.ready=i(function(r){var a=this,u=a._driverSet.then(function(){return a._ready===null&&(a._ready=a._initDriver()),a._ready});return y(u,r,r),u},"ready"),e.prototype.setDriver=i(function(r,a,u){var t=this;sr(r)||(r=[r]);var v=this._getSupportedDrivers(r);function b(){t._config.driver=t.driver()}i(b,"setDriverToConfig");function x(N){return t._extend(N),b(),t._ready=t._initStorage(t._config),t._ready}i(x,"extendSelfWithDriver");function S(N){return function(){var B=0;function $(){for(;B<N.length;){var z=N[B];return B++,t._dbInfo=null,t._ready=null,t.getDriver(z).then(x).catch($)}b();var k=new Error("No available storage method found.");return t._driverSet=o.reject(k),t._driverSet}return i($,"driverPromiseLoop"),$()}}i(S,"initDriver");var R=this._driverSet!==null?this._driverSet.catch(function(){return o.resolve()}):o.resolve();return this._driverSet=R.then(function(){var N=v[0];return t._dbInfo=null,t._ready=null,t.getDriver(N).then(function(B){t._driver=B._driver,b(),t._wrapLibraryMethodsWithReady(),t._initDriver=S(v)})}).catch(function(){b();var N=new Error("No available storage method found.");return t._driverSet=o.reject(N),t._driverSet}),y(this._driverSet,a,u),this._driverSet},"setDriver"),e.prototype.supports=i(function(r){return!!lr[r]},"supports"),e.prototype._extend=i(function(r){Ae(this,r)},"_extend"),e.prototype._getSupportedDrivers=i(function(r){for(var a=[],u=0,t=r.length;u<t;u++){var v=r[u];this.supports(v)&&a.push(v)}return a},"_getSupportedDrivers"),e.prototype._wrapLibraryMethodsWithReady=i(function(){for(var r=0,a=Re.length;r<a;r++)Rn(this,Re[r])},"_wrapLibraryMethodsWithReady"),e.prototype.createInstance=i(function(r){return new e(r)},"createInstance"),e}(),Nn=new An;d.exports=Nn},{3:3}]},{},[4])(4)})})(ge);const G=i(({q:l,r:_,s:p})=>`${l} ${_} ${p}`,"asCoordinateKey"),Ce=[0,60,120,180,240,300];var Te={exports:{}};(function(l){(function(_,p,d){function w(f){var s=this,g=h();s.next=function(){var o=2091639*s.s0+s.c*23283064365386963e-26;return s.s0=s.s1,s.s1=s.s2,s.s2=o-(s.c=o|0)},s.c=1,s.s0=g(" "),s.s1=g(" "),s.s2=g(" "),s.s0-=g(f),s.s0<0&&(s.s0+=1),s.s1-=g(f),s.s1<0&&(s.s1+=1),s.s2-=g(f),s.s2<0&&(s.s2+=1),g=null}i(w,"Alea");function E(f,s){return s.c=f.c,s.s0=f.s0,s.s1=f.s1,s.s2=f.s2,s}i(E,"copy");function I(f,s){var g=new w(f),o=s&&s.state,c=g.next;return c.int32=function(){return g.next()*4294967296|0},c.double=function(){return c()+(c()*2097152|0)*11102230246251565e-32},c.quick=c,o&&(typeof o=="object"&&E(o,g),c.state=function(){return E(g,{})}),c}i(I,"impl");function h(){var f=4022871197,s=i(function(g){g=String(g);for(var o=0;o<g.length;o++){f+=g.charCodeAt(o);var c=.02519603282416938*f;f=c>>>0,c-=f,c*=f,f=c>>>0,c-=f,f+=c*4294967296}return(f>>>0)*23283064365386963e-26},"mash");return s}i(h,"Mash"),p&&p.exports?p.exports=I:d&&d.amd?d(function(){return I}):this.alea=I})(V,l,!1)})(Te);var Oe={exports:{}};(function(l){(function(_,p,d){function w(h){var f=this,s="";f.x=0,f.y=0,f.z=0,f.w=0,f.next=function(){var o=f.x^f.x<<11;return f.x=f.y,f.y=f.z,f.z=f.w,f.w^=f.w>>>19^o^o>>>8},h===(h|0)?f.x=h:s+=h;for(var g=0;g<s.length+64;g++)f.x^=s.charCodeAt(g)|0,f.next()}i(w,"XorGen");function E(h,f){return f.x=h.x,f.y=h.y,f.z=h.z,f.w=h.w,f}i(E,"copy");function I(h,f){var s=new w(h),g=f&&f.state,o=i(function(){return(s.next()>>>0)/4294967296},"prng");return o.double=function(){do var c=s.next()>>>11,y=(s.next()>>>0)/4294967296,A=(c+y)/(1<<21);while(A===0);return A},o.int32=s.next,o.quick=o,g&&(typeof g=="object"&&E(g,s),o.state=function(){return E(s,{})}),o}i(I,"impl"),p&&p.exports?p.exports=I:d&&d.amd?d(function(){return I}):this.xor128=I})(V,l,!1)})(Oe);var Be={exports:{}};(function(l){(function(_,p,d){function w(h){var f=this,s="";f.next=function(){var o=f.x^f.x>>>2;return f.x=f.y,f.y=f.z,f.z=f.w,f.w=f.v,(f.d=f.d+362437|0)+(f.v=f.v^f.v<<4^(o^o<<1))|0},f.x=0,f.y=0,f.z=0,f.w=0,f.v=0,h===(h|0)?f.x=h:s+=h;for(var g=0;g<s.length+64;g++)f.x^=s.charCodeAt(g)|0,g==s.length&&(f.d=f.x<<10^f.x>>>4),f.next()}i(w,"XorGen");function E(h,f){return f.x=h.x,f.y=h.y,f.z=h.z,f.w=h.w,f.v=h.v,f.d=h.d,f}i(E,"copy");function I(h,f){var s=new w(h),g=f&&f.state,o=i(function(){return(s.next()>>>0)/4294967296},"prng");return o.double=function(){do var c=s.next()>>>11,y=(s.next()>>>0)/4294967296,A=(c+y)/(1<<21);while(A===0);return A},o.int32=s.next,o.quick=o,g&&(typeof g=="object"&&E(g,s),o.state=function(){return E(s,{})}),o}i(I,"impl"),p&&p.exports?p.exports=I:d&&d.amd?d(function(){return I}):this.xorwow=I})(V,l,!1)})(Be);var Pe={exports:{}};(function(l){(function(_,p,d){function w(h){var f=this;f.next=function(){var g=f.x,o=f.i,c,y;return c=g[o],c^=c>>>7,y=c^c<<24,c=g[o+1&7],y^=c^c>>>10,c=g[o+3&7],y^=c^c>>>3,c=g[o+4&7],y^=c^c<<7,c=g[o+7&7],c=c^c<<13,y^=c^c<<9,g[o]=y,f.i=o+1&7,y};function s(g,o){var c,y=[];if(o===(o|0))y[0]=o;else for(o=""+o,c=0;c<o.length;++c)y[c&7]=y[c&7]<<15^o.charCodeAt(c)+y[c+1&7]<<13;for(;y.length<8;)y.push(0);for(c=0;c<8&&y[c]===0;++c);for(c==8?y[7]=-1:y[c],g.x=y,g.i=0,c=256;c>0;--c)g.next()}i(s,"init"),s(f,h)}i(w,"XorGen");function E(h,f){return f.x=h.x.slice(),f.i=h.i,f}i(E,"copy");function I(h,f){h==null&&(h=+new Date);var s=new w(h),g=f&&f.state,o=i(function(){return(s.next()>>>0)/4294967296},"prng");return o.double=function(){do var c=s.next()>>>11,y=(s.next()>>>0)/4294967296,A=(c+y)/(1<<21);while(A===0);return A},o.int32=s.next,o.quick=o,g&&(g.x&&E(g,s),o.state=function(){return E(s,{})}),o}i(I,"impl"),p&&p.exports?p.exports=I:d&&d.amd?d(function(){return I}):this.xorshift7=I})(V,l,!1)})(Pe);var Le={exports:{}};(function(l){(function(_,p,d){function w(h){var f=this;f.next=function(){var g=f.w,o=f.X,c=f.i,y,A;return f.w=g=g+1640531527|0,A=o[c+34&127],y=o[c=c+1&127],A^=A<<13,y^=y<<17,A^=A>>>15,y^=y>>>12,A=o[c]=A^y,f.i=c,A+(g^g>>>16)|0};function s(g,o){var c,y,A,M,P,Y=[],L=128;for(o===(o|0)?(y=o,o=null):(o=o+"\0",y=0,L=Math.max(L,o.length)),A=0,M=-32;M<L;++M)o&&(y^=o.charCodeAt((M+32)%o.length)),M===0&&(P=y),y^=y<<10,y^=y>>>15,y^=y<<4,y^=y>>>13,M>=0&&(P=P+1640531527|0,c=Y[M&127]^=y+P,A=c==0?A+1:0);for(A>=128&&(Y[(o&&o.length||0)&127]=-1),A=127,M=4*128;M>0;--M)y=Y[A+34&127],c=Y[A=A+1&127],y^=y<<13,c^=c<<17,y^=y>>>15,c^=c>>>12,Y[A]=y^c;g.w=P,g.X=Y,g.i=A}i(s,"init"),s(f,h)}i(w,"XorGen");function E(h,f){return f.i=h.i,f.w=h.w,f.X=h.X.slice(),f}i(E,"copy");function I(h,f){h==null&&(h=+new Date);var s=new w(h),g=f&&f.state,o=i(function(){return(s.next()>>>0)/4294967296},"prng");return o.double=function(){do var c=s.next()>>>11,y=(s.next()>>>0)/4294967296,A=(c+y)/(1<<21);while(A===0);return A},o.int32=s.next,o.quick=o,g&&(g.X&&E(g,s),o.state=function(){return E(s,{})}),o}i(I,"impl"),p&&p.exports?p.exports=I:d&&d.amd?d(function(){return I}):this.xor4096=I})(V,l,!1)})(Le);var Me={exports:{}};(function(l){(function(_,p,d){function w(h){var f=this,s="";f.next=function(){var o=f.b,c=f.c,y=f.d,A=f.a;return o=o<<25^o>>>7^c,c=c-y|0,y=y<<24^y>>>8^A,A=A-o|0,f.b=o=o<<20^o>>>12^c,f.c=c=c-y|0,f.d=y<<16^c>>>16^A,f.a=A-o|0},f.a=0,f.b=0,f.c=-1640531527,f.d=1367130551,h===Math.floor(h)?(f.a=h/4294967296|0,f.b=h|0):s+=h;for(var g=0;g<s.length+20;g++)f.b^=s.charCodeAt(g)|0,f.next()}i(w,"XorGen");function E(h,f){return f.a=h.a,f.b=h.b,f.c=h.c,f.d=h.d,f}i(E,"copy");function I(h,f){var s=new w(h),g=f&&f.state,o=i(function(){return(s.next()>>>0)/4294967296},"prng");return o.double=function(){do var c=s.next()>>>11,y=(s.next()>>>0)/4294967296,A=(c+y)/(1<<21);while(A===0);return A},o.int32=s.next,o.quick=o,g&&(typeof g=="object"&&E(g,s),o.state=function(){return E(s,{})}),o}i(I,"impl"),p&&p.exports?p.exports=I:d&&d.amd?d(function(){return I}):this.tychei=I})(V,l,!1)})(Me);var Fe={exports:{}},hr={},yr=Object.freeze({__proto__:null,default:hr}),pr=pe(yr);(function(l){(function(_,p,d){var w=256,E=6,I=52,h="random",f=d.pow(w,E),s=d.pow(2,I),g=s*2,o=w-1,c;function y(O,m,C){var D=[];m=m==!0?{entropy:!0}:m||{};var T=Y(P(m.entropy?[O,Q(p)]:O==null?L():O,3),D),F=new A(D),U=i(function(){for(var j=F.g(E),W=f,q=0;j<s;)j=(j+q)*w,W*=w,q=F.g(1);for(;j>=g;)j/=2,W/=2,q>>>=1;return(j+q)/W},"prng");return U.int32=function(){return F.g(4)|0},U.quick=function(){return F.g(4)/4294967296},U.double=U,Y(Q(F.S),p),(m.pass||C||function(j,W,q,K){return K&&(K.S&&M(K,F),j.state=function(){return M(F,{})}),q?(d[h]=j,W):j})(U,T,"global"in m?m.global:this==d,m.state)}i(y,"seedrandom");function A(O){var m,C=O.length,D=this,T=0,F=D.i=D.j=0,U=D.S=[];for(C||(O=[C++]);T<w;)U[T]=T++;for(T=0;T<w;T++)U[T]=U[F=o&F+O[T%C]+(m=U[T])],U[F]=m;(D.g=function(j){for(var W,q=0,K=D.i,Z=D.j,ee=D.S;j--;)W=ee[K=o&K+1],q=q*w+ee[o&(ee[K]=ee[Z=o&Z+W])+(ee[Z]=W)];return D.i=K,D.j=Z,q})(w)}i(A,"ARC4");function M(O,m){return m.i=O.i,m.j=O.j,m.S=O.S.slice(),m}i(M,"copy");function P(O,m){var C=[],D=typeof O,T;if(m&&D=="object")for(T in O)try{C.push(P(O[T],m-1))}catch{}return C.length?C:D=="string"?O:O+"\0"}i(P,"flatten");function Y(O,m){for(var C=O+"",D,T=0;T<C.length;)m[o&T]=o&(D^=m[o&T]*19)+C.charCodeAt(T++);return Q(m)}i(Y,"mixkey");function L(){try{var O;return c&&(O=c.randomBytes)?O=O(w):(O=new Uint8Array(w),(_.crypto||_.msCrypto).getRandomValues(O)),Q(O)}catch{var m=_.navigator,C=m&&m.plugins;return[+new Date,_,C,_.screen,Q(p)]}}i(L,"autoseed");function Q(O){return String.fromCharCode.apply(0,O)}if(i(Q,"tostring"),Y(d.random(),p),l.exports){l.exports=y;try{c=pr}catch{}}else d["seed"+h]=y})(typeof self<"u"?self:V,[],Math)})(Fe);var gr=Te.exports,mr=Oe.exports,br=Be.exports,wr=Pe.exports,_r=Le.exports,xr=Me.exports,ie=Fe.exports;ie.alea=gr,ie.xor128=mr,ie.xorwow=br,ie.xorshift7=wr,ie.xor4096=_r,ie.tychei=xr;var Sr=ie;function*$e(l,_){let p=0;for(const d of _)p++<l||(yield d)}i($e,"skip");var ze=i(l=>{const _=Sr(l),p={chooseOne(d){if(d instanceof Map||d instanceof Set){const w=Math.floor(_()*d.size),{value:E}=$e(w,d.keys()).next();return E}else{const w=d instanceof Array?d:[...d];return w[Math.floor(_()*w.length)]}},removeOne(d){if(d instanceof Map){const w=p.chooseOne(d),E=d.get(w);return d.delete(w),E}else if(d instanceof Set){const w=p.chooseOne(d);return d.delete(w),w}else{const w=Math.floor(_()*d.length),E=d[w];return d.splice(w,1),E}},*randomIterator(d){if(d instanceof Map||d instanceof Set){const w=Math.floor(_()*d.size);yield*$e(w,d.keys())}else{const w=d instanceof Array?d:[...d],E=Math.floor(_()*w.length);for(let I=0;I<w.length;I++)yield w[(E+I)%w.length]}}};return p},"Random");function*Er(l,_,p){for(const d of me(l,_)){const{coordinate:w}=d,E=p.has(G(w));yield{neighbour:d,connected:E}}}i(Er,"PartitionNeighbours");const Ue=i((l,_,p)=>{var d;(d=l[_])!=null||(l[_]=0),l[_]|=p},"addConnection");function*Ir({size:l,seed:_}){const{chooseOne:p,removeOne:d}=ze(_),w=[...Ye(l)],E={},I=new Set,h=new Map,f=p(w);I.add(G(f));for(const{coordinate:s}of me(l,f))h.set(G(s),s);for(;I.size<w.length;){if(h.size===0)throw new Error("working set unexpectedly empty");const s=d(h),g=G(s),o=[...Er(l,s,I)],c=o.filter(({connected:L})=>L),{neighbour:{coordinate:y,direction:A}}=p(c),{forwards:M,backwards:P}=We(A),Y=G(y);Ue(E,g,M),Ue(E,Y,P),I.add(g);for(const{neighbour:{coordinate:L}}of o.filter(({connected:Q})=>!Q))h.set(G(L),L)}for(const s of w){const g=E[G(s)],o=p(Ce),c=je(g);yield{coordinate:s,orientation:o,connection:c}}}i(Ir,"Prims");function*Rr({size:l,seed:_}){const{chooseOne:p,randomIterator:d,removeOne:w}=ze(_),E=i((g,o)=>d(me(g,o)).next().value,"RandomNeighbour"),I=i((g,o)=>{const c=new Map,y=G(g);let A=[{key:y,coordinate:g,forwards:0,backwards:0}];for(c.set(y,g);;){const M=A.at(-1).coordinate,{coordinate:P,direction:Y}=E(l,M),L=G(P);if(c.has(L)){const O=A.findIndex(({key:m})=>m===L)+1;for(let m=O;m<A.length;m++){const{key:C}=A[m];c.delete(C)}A=A.slice(0,O);continue}else{const{forwards:O,backwards:m}=We(Y);if(A.at(-1).forwards=O,A.push({key:L,coordinate:P,forwards:0,backwards:m}),!o.has(L))return A;c.set(L,P)}}},"loopErasedRandomWalk"),h=[...Ye(l)],f={},s=new Map;for(const g of h)s.set(G(g),g);for(w(s);s.size>0;){const g=w(s),o=I(g,s);for(const{key:c,forwards:y,backwards:A}of o)s.delete(c),f[c]|=y|A}for(const g of h){const o=f[G(g)],c=p(Ce),y=je(o);yield{coordinate:g,orientation:c,connection:y}}}i(Rr,"Wilsons");const je=i(l=>{if(l===0)throw new Error("connection cannot be empty");if(l===63)return 63;for(;!(l&32)||l&1;){const p=l&32;l<<=1,l&=63,p&&(l|=1)}const _=(l&30)>>1;switch(_){case 0:return 32;case 8:return 48;case 4:return 40;case 2:return 36;case 1:return 40;case 12:return 56;case 6:return 44;case 3:return 52;case 9:return 44;case 10:return 52;case 5:return 42;case 14:return 60;case 7:return 46;case 11:return 54;case 13:return 46;case 15:return 62;default:throw new Error(`unhandled truncated case ${_.toString(2)} from connection ${l.toString(2)}`)}},"normalizeConnection");function*Ar({q:l,r:_,s:p}){yield{coordinate:{q:l,r:_-1,s:p+1},direction:0},yield{coordinate:{q:l+1,r:_-1,s:p},direction:1},yield{coordinate:{q:l+1,r:_,s:p-1},direction:2},yield{coordinate:{q:l,r:_+1,s:p-1},direction:3},yield{coordinate:{q:l-1,r:_+1,s:p},direction:4},yield{coordinate:{q:l-1,r:_,s:p+1},direction:5}}i(Ar,"Neighbours$1");function*me(l,_){for(const p of Ar(_)){const{coordinate:{q:d,r:w,s:E}}=p;d<-l||d>l||w<-l||w>l||E<-l||E>l||(yield p)}}i(me,"ValidNeighbours");function*Ye(l){for(let _=-l;_<=l;_++)for(let p=-l;p<=l;p++){const d=-_-p;-l<=d&&d<=l&&(yield{q:_,r:p,s:d})}}i(Ye,"CoordinatesGenerator");const We=i(l=>({forwards:32>>l,backwards:32>>(l+3)%6}),"asConnections");function*Nr(l){const{mode:_}=l;switch(_){case"prims":yield*Ir(l);return;case"wilsons":yield*Rr(l);return}}i(Nr,"PuzzleGenerator");const be=ge.exports.createInstance({driver:ge.exports.INDEXEDDB,name:"hexpanse",version:1,storeName:"gameState"}),we=i(l=>{postMessage(l)},"reply");let de,ve,J;onmessage=i(async({data:l})=>{switch(l.type){case"restore":{de=l.config,ve=vr(de);const _=await be.getItem(ve);if(_)J=_;else{J={};for(const{coordinate:p,orientation:d,connection:w}of Nr(de))J[G(p)]={coordinate:p,orientation:d,connection:w,color:"none"};await be.setItem(ve,J)}we({type:"restored",config:de,state:J}),ne={};for(const p of Object.keys(J))Xe(p);qe();return}case"update cell":{const{coordinate:_,orientation:p}=l,d=G(_),w=J[d];w&&(w.orientation=p,await be.setItem(ve,J),delete ne[d],Xe(d),qe());return}}},"onmessage");const ae=i((l,_,p)=>{for(l.q-=p.q,l.r-=p.r,l.s-=p.s;_>0;)l={q:-l.r,r:-l.s,s:-l.q},_-=60;return l.q+=p.q,l.r+=p.r,l.s+=p.s,l},"rotate");function*Dr(l,_,p){const{q:d,r:w,s:E}=l;p&32&&(yield ae({q:d+1,r:w,s:E-1},_,l)),p&16&&(yield ae({q:d,r:w+1,s:E-1},_,l)),p&8&&(yield ae({q:d-1,r:w+1,s:E},_,l)),p&4&&(yield ae({q:d-1,r:w,s:E+1},_,l)),p&2&&(yield ae({q:d,r:w-1,s:E+1},_,l)),p&1&&(yield ae({q:d+1,r:w-1,s:E},_,l))}i(Dr,"Neighbours");let ne;const Xe=i(l=>{var w;const{coordinate:_,orientation:p,connection:d}=J[l];for(const E of Dr(_,p,d)){const I=G(E);!J[I]||((w=ne[l])!=null||(ne[l]=new Set),ne[l].add(I))}},"updateFacingNeighbours"),Cr=i(l=>{var d;const _={none:0,red:0,green:0,blue:0};for(const w of l){const{color:E}=J[w];E&&(_[E]=((d=_[E])!=null?d:0)+1)}const{color:p}=Object.entries(_).reduce((w,[E,I])=>w.count>I?w:{color:E,count:I},{color:"none",count:0});return p},"mostCommonColor"),Tr=i(l=>Object.entries(l),"entries"),qe=i(()=>{var o;let l=0;const _={},p=i((c,y)=>{var M;if(_[c])return;_[c]=y;const A=ne[c];if(A)for(const P of A)(M=ne[P])!=null&&M.has(c)&&p(P,y)},"floodFill");for(const c of Object.keys(J))p(c,++l);const d={};for(const[c,y]of Object.entries(_))(o=d[y])!=null||(d[y]=new Set),d[y].add(c);if(Object.values(d).length===1)return we({type:"game over"});const w=["none","red","green","blue"],E=new Set(w);E.delete("none");const I={none:new Set,red:new Set,green:new Set,blue:new Set},h=Object.values(d).sort((c,y)=>y.size-c.size),f=h.slice(0,E.size),s=[];for(const c of f){const y=Cr(c);E.has(y)?(I[y]=c,E.delete(y)):s.push(c)}let g=0;for(const c of E)I[c]=s[g++];for(const c of h.slice(E.size))for(const y of c)I.none.add(y);we({type:"coloring",colors:I});for(const[c,y]of Tr(I))for(const A of y)J[A].color=c},"updateSpan")})();
