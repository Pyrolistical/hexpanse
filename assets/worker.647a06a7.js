var On=Object.defineProperty;var a=(V,pe)=>On(V,"name",{value:pe,configurable:!0});(function(){"use strict";var V=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pe(l){var _=l.default;if(typeof _=="function"){var p=a(function(){return _.apply(this,arguments)},"a");p.prototype=_.prototype}else p={};return Object.defineProperty(p,"__esModule",{value:!0}),Object.keys(l).forEach(function(d){var w=Object.getOwnPropertyDescriptor(l,d);Object.defineProperty(p,d,w.get?w:{enumerable:!0,get:function(){return l[d]}})}),p}a(pe,"getAugmentedNamespace");var vr=a(function(l,_){_||(_={}),typeof _=="function"&&(_={cmp:_});var p=typeof _.cycles=="boolean"?_.cycles:!1,d=_.cmp&&function(I){return function(E){return function(h,i){var s={key:h,value:E[h]},y={key:i,value:E[i]};return I(s,y)}}}(_.cmp),w=[];return a(function I(E){if(E&&E.toJSON&&typeof E.toJSON=="function"&&(E=E.toJSON()),E!==void 0){if(typeof E=="number")return isFinite(E)?""+E:"null";if(typeof E!="object")return JSON.stringify(E);var h,i;if(Array.isArray(E)){for(i="[",h=0;h<E.length;h++)h&&(i+=","),i+=I(E[h])||"null";return i+"]"}if(E===null)return"null";if(w.indexOf(E)!==-1){if(p)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=w.push(E)-1,y=Object.keys(E).sort(d&&d(E));for(i="",h=0;h<y.length;h++){var t=y[h],c=I(E[t]);!c||(i&&(i+=","),i+=JSON.stringify(t)+":"+c)}return w.splice(s,1),"{"+i+"}"}},"stringify")(l)},"fastJsonStableStringify");function le(l){throw new Error('Could not dynamically require "'+l+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}a(le,"commonjsRequire");var ge={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(l,_){(function(p){l.exports=p()})(function(){return a(function p(d,w,I){function E(s,y){if(!w[s]){if(!d[s]){var t=typeof le=="function"&&le;if(!y&&t)return t(s,!0);if(h)return h(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var m=w[s]={exports:{}};d[s][0].call(m.exports,function(A){var M=d[s][1][A];return E(M||A)},m,m.exports,p,d,w,I)}return w[s].exports}a(E,"s");for(var h=typeof le=="function"&&le,i=0;i<I.length;i++)E(I[i]);return E},"e")({1:[function(p,d,w){(function(I){var E=I.MutationObserver||I.WebKitMutationObserver,h;if(E){var i=0,s=new E(A),y=I.document.createTextNode("");s.observe(y,{characterData:!0}),h=a(function(){y.data=i=++i%2},"scheduleDrain")}else if(!I.setImmediate&&typeof I.MessageChannel<"u"){var t=new I.MessageChannel;t.port1.onmessage=A,h=a(function(){t.port2.postMessage(0)},"scheduleDrain")}else"document"in I&&"onreadystatechange"in I.document.createElement("script")?h=a(function(){var L=I.document.createElement("script");L.onreadystatechange=function(){A(),L.onreadystatechange=null,L.parentNode.removeChild(L),L=null},I.document.documentElement.appendChild(L)},"scheduleDrain"):h=a(function(){setTimeout(A,0)},"scheduleDrain");var c,m=[];function A(){c=!0;for(var L,Y,P=m.length;P;){for(Y=m,m=[],L=-1;++L<P;)Y[L]();P=m.length}c=!1}a(A,"nextTick"),d.exports=M;function M(L){m.push(L)===1&&!c&&h()}a(M,"immediate")}).call(this,typeof V<"u"?V:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(p,d,w){var I=p(1);function E(){}a(E,"INTERNAL");var h={},i=["REJECTED"],s=["FULFILLED"],y=["PENDING"];d.exports=t;function t(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,g!==E&&M(this,g)}a(t,"Promise"),t.prototype.catch=function(g){return this.then(null,g)},t.prototype.then=function(g,C){if(typeof g!="function"&&this.state===s||typeof C!="function"&&this.state===i)return this;var D=new this.constructor(E);if(this.state!==y){var T=this.state===s?g:C;m(D,T,this.outcome)}else this.queue.push(new c(D,g,C));return D};function c(g,C,D){this.promise=g,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof D=="function"&&(this.onRejected=D,this.callRejected=this.otherCallRejected)}a(c,"QueueItem"),c.prototype.callFulfilled=function(g){h.resolve(this.promise,g)},c.prototype.otherCallFulfilled=function(g){m(this.promise,this.onFulfilled,g)},c.prototype.callRejected=function(g){h.reject(this.promise,g)},c.prototype.otherCallRejected=function(g){m(this.promise,this.onRejected,g)};function m(g,C,D){I(function(){var T;try{T=C(D)}catch(F){return h.reject(g,F)}T===g?h.reject(g,new TypeError("Cannot resolve promise with itself")):h.resolve(g,T)})}a(m,"unwrap"),h.resolve=function(g,C){var D=L(A,C);if(D.status==="error")return h.reject(g,D.value);var T=D.value;if(T)M(g,T);else{g.state=s,g.outcome=C;for(var F=-1,U=g.queue.length;++F<U;)g.queue[F].callFulfilled(C)}return g},h.reject=function(g,C){g.state=i,g.outcome=C;for(var D=-1,T=g.queue.length;++D<T;)g.queue[D].callRejected(C);return g};function A(g){var C=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof C=="function")return a(function(){C.apply(g,arguments)},"appyThen")}a(A,"getThen");function M(g,C){var D=!1;function T(W){D||(D=!0,h.reject(g,W))}a(T,"onError");function F(W){D||(D=!0,h.resolve(g,W))}a(F,"onSuccess");function U(){C(F,T)}a(U,"tryToUnwrap");var j=L(U);j.status==="error"&&T(j.value)}a(M,"safelyResolveThenable");function L(g,C){var D={};try{D.value=g(C),D.status="success"}catch(T){D.status="error",D.value=T}return D}a(L,"tryCatch"),t.resolve=Y;function Y(g){return g instanceof this?g:h.resolve(new this(E),g)}a(Y,"resolve"),t.reject=P;function P(g){var C=new this(E);return h.reject(C,g)}a(P,"reject"),t.all=Q;function Q(g){var C=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=g.length,T=!1;if(!D)return this.resolve([]);for(var F=new Array(D),U=0,j=-1,W=new this(E);++j<D;)k(g[j],j);return W;function k(K,Z){C.resolve(K).then(ee,function(fe){T||(T=!0,h.reject(W,fe))});function ee(fe){F[Z]=fe,++U===D&&!T&&(T=!0,h.resolve(W,F))}a(ee,"resolveFromAll")}}a(Q,"all"),t.race=O;function O(g){var C=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=g.length,T=!1;if(!D)return this.resolve([]);for(var F=-1,U=new this(E);++F<D;)j(g[F]);return U;function j(W){C.resolve(W).then(function(k){T||(T=!0,h.resolve(U,k))},function(k){T||(T=!0,h.reject(U,k))})}}a(O,"race")},{1:1}],3:[function(p,d,w){(function(I){typeof I.Promise!="function"&&(I.Promise=p(2))}).call(this,typeof V<"u"?V:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(p,d,w){var I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function E(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}a(E,"_classCallCheck");function h(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}a(h,"getIDB");var i=h();function s(){try{if(!i||!i.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}a(s,"isIndexedDBValid");function y(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(o){if(o.name!=="TypeError")throw o;for(var r=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,f=new r,u=0;u<e.length;u+=1)f.append(e[u]);return f.getBlob(n.type)}}a(y,"createBlob"),typeof Promise>"u"&&p(3);var t=Promise;function c(e,n){n&&e.then(function(r){n(null,r)},function(r){n(r)})}a(c,"executeCallback");function m(e,n,r){typeof n=="function"&&e.then(n),typeof r=="function"&&e.catch(r)}a(m,"executeTwoCallbacks");function A(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}a(A,"normalizeKey");function M(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}a(M,"getCallback");var L="local-forage-detect-blob-support",Y=void 0,P={},Q=Object.prototype.toString,O="readonly",g="readwrite";function C(e){for(var n=e.length,r=new ArrayBuffer(n),f=new Uint8Array(r),u=0;u<n;u++)f[u]=e.charCodeAt(u);return r}a(C,"_binStringToArrayBuffer");function D(e){return new t(function(n){var r=e.transaction(L,g),f=y([""]);r.objectStore(L).put(f,"key"),r.onabort=function(u){u.preventDefault(),u.stopPropagation(),n(!1)},r.oncomplete=function(){var u=navigator.userAgent.match(/Chrome\/(\d+)/),o=navigator.userAgent.match(/Edge\//);n(o||!u||parseInt(u[1],10)>=43)}}).catch(function(){return!1})}a(D,"_checkBlobSupportWithoutCaching");function T(e){return typeof Y=="boolean"?t.resolve(Y):D(e).then(function(n){return Y=n,Y})}a(T,"_checkBlobSupport");function F(e){var n=P[e.name],r={};r.promise=new t(function(f,u){r.resolve=f,r.reject=u}),n.deferredOperations.push(r),n.dbReady?n.dbReady=n.dbReady.then(function(){return r.promise}):n.dbReady=r.promise}a(F,"_deferReadiness");function U(e){var n=P[e.name],r=n.deferredOperations.pop();if(r)return r.resolve(),r.promise}a(U,"_advanceReadiness");function j(e,n){var r=P[e.name],f=r.deferredOperations.pop();if(f)return f.reject(n),f.promise}a(j,"_rejectReadiness");function W(e,n){return new t(function(r,f){if(P[e.name]=P[e.name]||Ge(),e.db)if(n)F(e),e.db.close();else return r(e.db);var u=[e.name];n&&u.push(e.version);var o=i.open.apply(i,u);n&&(o.onupgradeneeded=function(v){var b=o.result;try{b.createObjectStore(e.storeName),v.oldVersion<=1&&b.createObjectStore(L)}catch(x){if(x.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+v.oldVersion+" to version "+v.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw x}}),o.onerror=function(v){v.preventDefault(),f(o.error)},o.onsuccess=function(){var v=o.result;v.onversionchange=function(b){b.target.close()},r(v),U(e)}})}a(W,"_getConnection");function k(e){return W(e,!1)}a(k,"_getOriginalConnection");function K(e){return W(e,!0)}a(K,"_getUpgradedConnection");function Z(e,n){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),f=e.version<e.db.version,u=e.version>e.db.version;if(f&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),u||r){if(r){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}a(Z,"_isUpgradeNeeded");function ee(e){return new t(function(n,r){var f=new FileReader;f.onerror=r,f.onloadend=function(u){var o=btoa(u.target.result||"");n({__local_forage_encoded_blob:!0,data:o,type:e.type})},f.readAsBinaryString(e)})}a(ee,"_encodeBlob");function fe(e){var n=C(atob(e.data));return y([n],{type:e.type})}a(fe,"_decodeBlob");function qe(e){return e&&e.__local_forage_encoded_blob}a(qe,"_isEncodedBlob");function Or(e){var n=this,r=n._initReady().then(function(){var f=P[n._dbInfo.name];if(f&&f.dbReady)return f.dbReady});return m(r,e,e),r}a(Or,"_fullyReady");function Br(e){F(e);for(var n=P[e.name],r=n.forages,f=0;f<r.length;f++){var u=r[f];u._dbInfo.db&&(u._dbInfo.db.close(),u._dbInfo.db=null)}return e.db=null,k(e).then(function(o){return e.db=o,Z(e)?K(e):o}).then(function(o){e.db=n.db=o;for(var v=0;v<r.length;v++)r[v]._dbInfo.db=o}).catch(function(o){throw j(e,o),o})}a(Br,"_tryReconnect");function re(e,n,r,f){f===void 0&&(f=1);try{var u=e.db.transaction(e.storeName,n);r(null,u)}catch(o){if(f>0&&(!e.db||o.name==="InvalidStateError"||o.name==="NotFoundError"))return t.resolve().then(function(){if(!e.db||o.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),K(e)}).then(function(){return Br(e).then(function(){re(e,n,r,f-1)})}).catch(r);r(o)}}a(re,"createTransaction");function Ge(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}a(Ge,"createDbContext");function Pr(e){var n=this,r={db:null};if(e)for(var f in e)r[f]=e[f];var u=P[r.name];u||(u=Ge(),P[r.name]=u),u.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=Or);var o=[];function v(){return t.resolve()}a(v,"ignoreErrors");for(var b=0;b<u.forages.length;b++){var x=u.forages[b];x!==n&&o.push(x._initReady().catch(v))}var S=u.forages.slice(0);return t.all(o).then(function(){return r.db=u.db,k(r)}).then(function(R){return r.db=R,Z(r,n._defaultConfig.version)?K(r):R}).then(function(R){r.db=u.db=R,n._dbInfo=r;for(var N=0;N<S.length;N++){var B=S[N];B!==n&&(B._dbInfo.db=r.db,B._dbInfo.version=r.version)}})}a(Pr,"_initStorage");function Lr(e,n){var r=this;e=A(e);var f=new t(function(u,o){r.ready().then(function(){re(r._dbInfo,O,function(v,b){if(v)return o(v);try{var x=b.objectStore(r._dbInfo.storeName),S=x.get(e);S.onsuccess=function(){var R=S.result;R===void 0&&(R=null),qe(R)&&(R=fe(R)),u(R)},S.onerror=function(){o(S.error)}}catch(R){o(R)}})}).catch(o)});return c(f,n),f}a(Lr,"getItem");function Mr(e,n){var r=this,f=new t(function(u,o){r.ready().then(function(){re(r._dbInfo,O,function(v,b){if(v)return o(v);try{var x=b.objectStore(r._dbInfo.storeName),S=x.openCursor(),R=1;S.onsuccess=function(){var N=S.result;if(N){var B=N.value;qe(B)&&(B=fe(B));var $=e(B,N.key,R++);$!==void 0?u($):N.continue()}else u()},S.onerror=function(){o(S.error)}}catch(N){o(N)}})}).catch(o)});return c(f,n),f}a(Mr,"iterate");function Fr(e,n,r){var f=this;e=A(e);var u=new t(function(o,v){var b;f.ready().then(function(){return b=f._dbInfo,Q.call(n)==="[object Blob]"?T(b.db).then(function(x){return x?n:ee(n)}):n}).then(function(x){re(f._dbInfo,g,function(S,R){if(S)return v(S);try{var N=R.objectStore(f._dbInfo.storeName);x===null&&(x=void 0);var B=N.put(x,e);R.oncomplete=function(){x===void 0&&(x=null),o(x)},R.onabort=R.onerror=function(){var $=B.error?B.error:B.transaction.error;v($)}}catch($){v($)}})}).catch(v)});return c(u,r),u}a(Fr,"setItem");function $r(e,n){var r=this;e=A(e);var f=new t(function(u,o){r.ready().then(function(){re(r._dbInfo,g,function(v,b){if(v)return o(v);try{var x=b.objectStore(r._dbInfo.storeName),S=x.delete(e);b.oncomplete=function(){u()},b.onerror=function(){o(S.error)},b.onabort=function(){var R=S.error?S.error:S.transaction.error;o(R)}}catch(R){o(R)}})}).catch(o)});return c(f,n),f}a($r,"removeItem");function zr(e){var n=this,r=new t(function(f,u){n.ready().then(function(){re(n._dbInfo,g,function(o,v){if(o)return u(o);try{var b=v.objectStore(n._dbInfo.storeName),x=b.clear();v.oncomplete=function(){f()},v.onabort=v.onerror=function(){var S=x.error?x.error:x.transaction.error;u(S)}}catch(S){u(S)}})}).catch(u)});return c(r,e),r}a(zr,"clear");function Ur(e){var n=this,r=new t(function(f,u){n.ready().then(function(){re(n._dbInfo,O,function(o,v){if(o)return u(o);try{var b=v.objectStore(n._dbInfo.storeName),x=b.count();x.onsuccess=function(){f(x.result)},x.onerror=function(){u(x.error)}}catch(S){u(S)}})}).catch(u)});return c(r,e),r}a(Ur,"length");function jr(e,n){var r=this,f=new t(function(u,o){if(e<0){u(null);return}r.ready().then(function(){re(r._dbInfo,O,function(v,b){if(v)return o(v);try{var x=b.objectStore(r._dbInfo.storeName),S=!1,R=x.openKeyCursor();R.onsuccess=function(){var N=R.result;if(!N){u(null);return}e===0||S?u(N.key):(S=!0,N.advance(e))},R.onerror=function(){o(R.error)}}catch(N){o(N)}})}).catch(o)});return c(f,n),f}a(jr,"key");function Yr(e){var n=this,r=new t(function(f,u){n.ready().then(function(){re(n._dbInfo,O,function(o,v){if(o)return u(o);try{var b=v.objectStore(n._dbInfo.storeName),x=b.openKeyCursor(),S=[];x.onsuccess=function(){var R=x.result;if(!R){f(S);return}S.push(R.key),R.continue()},x.onerror=function(){u(x.error)}}catch(R){u(R)}})}).catch(u)});return c(r,e),r}a(Yr,"keys");function Wr(e,n){n=M.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var f=this,u;if(!e.name)u=t.reject("Invalid arguments");else{var o=e.name===r.name&&f._dbInfo.db,v=o?t.resolve(f._dbInfo.db):k(e).then(function(b){var x=P[e.name],S=x.forages;x.db=b;for(var R=0;R<S.length;R++)S[R]._dbInfo.db=b;return b});e.storeName?u=v.then(function(b){if(!!b.objectStoreNames.contains(e.storeName)){var x=b.version+1;F(e);var S=P[e.name],R=S.forages;b.close();for(var N=0;N<R.length;N++){var B=R[N];B._dbInfo.db=null,B._dbInfo.version=x}var $=new t(function(z,q){var X=i.open(e.name,x);X.onerror=function(H){var se=X.result;se.close(),q(H)},X.onupgradeneeded=function(){var H=X.result;H.deleteObjectStore(e.storeName)},X.onsuccess=function(){var H=X.result;H.close(),z(H)}});return $.then(function(z){S.db=z;for(var q=0;q<R.length;q++){var X=R[q];X._dbInfo.db=z,U(X._dbInfo)}}).catch(function(z){throw(j(e,z)||t.resolve()).catch(function(){}),z})}}):u=v.then(function(b){F(e);var x=P[e.name],S=x.forages;b.close();for(var R=0;R<S.length;R++){var N=S[R];N._dbInfo.db=null}var B=new t(function($,z){var q=i.deleteDatabase(e.name);q.onerror=function(){var X=q.result;X&&X.close(),z(q.error)},q.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},q.onsuccess=function(){var X=q.result;X&&X.close(),$(X)}});return B.then(function($){x.db=$;for(var z=0;z<S.length;z++){var q=S[z];U(q._dbInfo)}}).catch(function($){throw(j(e,$)||t.resolve()).catch(function(){}),$})})}return c(u,n),u}a(Wr,"dropInstance");var Xr={_driver:"asyncStorage",_initStorage:Pr,_support:s(),iterate:Mr,getItem:Lr,setItem:Fr,removeItem:$r,clear:zr,length:Ur,key:jr,keys:Yr,dropInstance:Wr};function kr(){return typeof openDatabase=="function"}a(kr,"isWebSQLValid");var te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qr="~~local_forage_type~",Ke=/^~~local_forage_type~([^~]+)~/,he="__lfsc__:",_e=he.length,xe="arbf",Se="blob",Ve="si08",Je="ui08",Qe="uic8",He="si16",Ze="si32",er="ur16",rr="ui32",nr="fl32",tr="fl64",or=_e+xe.length,ir=Object.prototype.toString;function ar(e){var n=e.length*.75,r=e.length,f,u=0,o,v,b,x;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var S=new ArrayBuffer(n),R=new Uint8Array(S);for(f=0;f<r;f+=4)o=te.indexOf(e[f]),v=te.indexOf(e[f+1]),b=te.indexOf(e[f+2]),x=te.indexOf(e[f+3]),R[u++]=o<<2|v>>4,R[u++]=(v&15)<<4|b>>2,R[u++]=(b&3)<<6|x&63;return S}a(ar,"stringToBuffer");function Ee(e){var n=new Uint8Array(e),r="",f;for(f=0;f<n.length;f+=3)r+=te[n[f]>>2],r+=te[(n[f]&3)<<4|n[f+1]>>4],r+=te[(n[f+1]&15)<<2|n[f+2]>>6],r+=te[n[f+2]&63];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}a(Ee,"bufferToString");function Gr(e,n){var r="";if(e&&(r=ir.call(e)),e&&(r==="[object ArrayBuffer]"||e.buffer&&ir.call(e.buffer)==="[object ArrayBuffer]")){var f,u=he;e instanceof ArrayBuffer?(f=e,u+=xe):(f=e.buffer,r==="[object Int8Array]"?u+=Ve:r==="[object Uint8Array]"?u+=Je:r==="[object Uint8ClampedArray]"?u+=Qe:r==="[object Int16Array]"?u+=He:r==="[object Uint16Array]"?u+=er:r==="[object Int32Array]"?u+=Ze:r==="[object Uint32Array]"?u+=rr:r==="[object Float32Array]"?u+=nr:r==="[object Float64Array]"?u+=tr:n(new Error("Failed to get type for BinaryArray"))),n(u+Ee(f))}else if(r==="[object Blob]"){var o=new FileReader;o.onload=function(){var v=qr+e.type+"~"+Ee(this.result);n(he+Se+v)},o.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(v){console.error("Couldn't convert value into a JSON string: ",e),n(null,v)}}a(Gr,"serialize");function Kr(e){if(e.substring(0,_e)!==he)return JSON.parse(e);var n=e.substring(or),r=e.substring(_e,or),f;if(r===Se&&Ke.test(n)){var u=n.match(Ke);f=u[1],n=n.substring(u[0].length)}var o=ar(n);switch(r){case xe:return o;case Se:return y([o],{type:f});case Ve:return new Int8Array(o);case Je:return new Uint8Array(o);case Qe:return new Uint8ClampedArray(o);case He:return new Int16Array(o);case er:return new Uint16Array(o);case Ze:return new Int32Array(o);case rr:return new Uint32Array(o);case nr:return new Float32Array(o);case tr:return new Float64Array(o);default:throw new Error("Unkown type: "+r)}}a(Kr,"deserialize");var Ie={serialize:Gr,deserialize:Kr,stringToBuffer:ar,bufferToString:Ee};function fr(e,n,r,f){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,f)}a(fr,"createDbTable");function Vr(e){var n=this,r={db:null};if(e)for(var f in e)r[f]=typeof e[f]!="string"?e[f].toString():e[f];var u=new t(function(o,v){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(b){return v(b)}r.db.transaction(function(b){fr(b,r,function(){n._dbInfo=r,o()},function(x,S){v(S)})},v)});return r.serializer=Ie,u}a(Vr,"_initStorage$1");function oe(e,n,r,f,u,o){e.executeSql(r,f,u,function(v,b){b.code===b.SYNTAX_ERR?v.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(x,S){S.rows.length?o(x,b):fr(x,n,function(){x.executeSql(r,f,u,o)},o)},o):o(v,b)},o)}a(oe,"tryExecuteSql");function Jr(e,n){var r=this;e=A(e);var f=new t(function(u,o){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(b){oe(b,v,"SELECT * FROM "+v.storeName+" WHERE key = ? LIMIT 1",[e],function(x,S){var R=S.rows.length?S.rows.item(0).value:null;R&&(R=v.serializer.deserialize(R)),u(R)},function(x,S){o(S)})})}).catch(o)});return c(f,n),f}a(Jr,"getItem$1");function Qr(e,n){var r=this,f=new t(function(u,o){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(b){oe(b,v,"SELECT * FROM "+v.storeName,[],function(x,S){for(var R=S.rows,N=R.length,B=0;B<N;B++){var $=R.item(B),z=$.value;if(z&&(z=v.serializer.deserialize(z)),z=e(z,$.key,B+1),z!==void 0){u(z);return}}u()},function(x,S){o(S)})})}).catch(o)});return c(f,n),f}a(Qr,"iterate$1");function ur(e,n,r,f){var u=this;e=A(e);var o=new t(function(v,b){u.ready().then(function(){n===void 0&&(n=null);var x=n,S=u._dbInfo;S.serializer.serialize(n,function(R,N){N?b(N):S.db.transaction(function(B){oe(B,S,"INSERT OR REPLACE INTO "+S.storeName+" (key, value) VALUES (?, ?)",[e,R],function(){v(x)},function($,z){b(z)})},function(B){if(B.code===B.QUOTA_ERR){if(f>0){v(ur.apply(u,[e,x,r,f-1]));return}b(B)}})})}).catch(b)});return c(o,r),o}a(ur,"_setItem");function Hr(e,n,r){return ur.apply(this,[e,n,r,1])}a(Hr,"setItem$1");function Zr(e,n){var r=this;e=A(e);var f=new t(function(u,o){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(b){oe(b,v,"DELETE FROM "+v.storeName+" WHERE key = ?",[e],function(){u()},function(x,S){o(S)})})}).catch(o)});return c(f,n),f}a(Zr,"removeItem$1");function en(e){var n=this,r=new t(function(f,u){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(v){oe(v,o,"DELETE FROM "+o.storeName,[],function(){f()},function(b,x){u(x)})})}).catch(u)});return c(r,e),r}a(en,"clear$1");function rn(e){var n=this,r=new t(function(f,u){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(v){oe(v,o,"SELECT COUNT(key) as c FROM "+o.storeName,[],function(b,x){var S=x.rows.item(0).c;f(S)},function(b,x){u(x)})})}).catch(u)});return c(r,e),r}a(rn,"length$1");function nn(e,n){var r=this,f=new t(function(u,o){r.ready().then(function(){var v=r._dbInfo;v.db.transaction(function(b){oe(b,v,"SELECT key FROM "+v.storeName+" WHERE id = ? LIMIT 1",[e+1],function(x,S){var R=S.rows.length?S.rows.item(0).key:null;u(R)},function(x,S){o(S)})})}).catch(o)});return c(f,n),f}a(nn,"key$1");function tn(e){var n=this,r=new t(function(f,u){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(v){oe(v,o,"SELECT key FROM "+o.storeName,[],function(b,x){for(var S=[],R=0;R<x.rows.length;R++)S.push(x.rows.item(R).key);f(S)},function(b,x){u(x)})})}).catch(u)});return c(r,e),r}a(tn,"keys$1");function on(e){return new t(function(n,r){e.transaction(function(f){f.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(u,o){for(var v=[],b=0;b<o.rows.length;b++)v.push(o.rows.item(b).name);n({db:e,storeNames:v})},function(u,o){r(o)})},function(f){r(f)})})}a(on,"getAllStoreNames");function an(e,n){n=M.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var f=this,u;return e.name?u=new t(function(o){var v;e.name===r.name?v=f._dbInfo.db:v=openDatabase(e.name,"","",0),e.storeName?o({db:v,storeNames:[e.storeName]}):o(on(v))}).then(function(o){return new t(function(v,b){o.db.transaction(function(x){function S($){return new t(function(z,q){x.executeSql("DROP TABLE IF EXISTS "+$,[],function(){z()},function(X,H){q(H)})})}a(S,"dropTable");for(var R=[],N=0,B=o.storeNames.length;N<B;N++)R.push(S(o.storeNames[N]));t.all(R).then(function(){v()}).catch(function($){b($)})},function(x){b(x)})})}):u=t.reject("Invalid arguments"),c(u,n),u}a(an,"dropInstance$1");var fn={_driver:"webSQLStorage",_initStorage:Vr,_support:kr(),iterate:Qr,getItem:Jr,setItem:Hr,removeItem:Zr,clear:en,length:rn,key:nn,keys:tn,dropInstance:an};function un(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}a(un,"isLocalStorageValid");function cr(e,n){var r=e.name+"/";return e.storeName!==n.storeName&&(r+=e.storeName+"/"),r}a(cr,"_getKeyPrefix");function cn(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}a(cn,"checkIfLocalStorageThrows");function sn(){return!cn()||localStorage.length>0}a(sn,"_isLocalStorageUsable");function ln(e){var n=this,r={};if(e)for(var f in e)r[f]=e[f];return r.keyPrefix=cr(e,n._defaultConfig),sn()?(n._dbInfo=r,r.serializer=Ie,t.resolve()):t.reject()}a(ln,"_initStorage$2");function dn(e){var n=this,r=n.ready().then(function(){for(var f=n._dbInfo.keyPrefix,u=localStorage.length-1;u>=0;u--){var o=localStorage.key(u);o.indexOf(f)===0&&localStorage.removeItem(o)}});return c(r,e),r}a(dn,"clear$2");function vn(e,n){var r=this;e=A(e);var f=r.ready().then(function(){var u=r._dbInfo,o=localStorage.getItem(u.keyPrefix+e);return o&&(o=u.serializer.deserialize(o)),o});return c(f,n),f}a(vn,"getItem$2");function hn(e,n){var r=this,f=r.ready().then(function(){for(var u=r._dbInfo,o=u.keyPrefix,v=o.length,b=localStorage.length,x=1,S=0;S<b;S++){var R=localStorage.key(S);if(R.indexOf(o)===0){var N=localStorage.getItem(R);if(N&&(N=u.serializer.deserialize(N)),N=e(N,R.substring(v),x++),N!==void 0)return N}}});return c(f,n),f}a(hn,"iterate$2");function yn(e,n){var r=this,f=r.ready().then(function(){var u=r._dbInfo,o;try{o=localStorage.key(e)}catch{o=null}return o&&(o=o.substring(u.keyPrefix.length)),o});return c(f,n),f}a(yn,"key$2");function pn(e){var n=this,r=n.ready().then(function(){for(var f=n._dbInfo,u=localStorage.length,o=[],v=0;v<u;v++){var b=localStorage.key(v);b.indexOf(f.keyPrefix)===0&&o.push(b.substring(f.keyPrefix.length))}return o});return c(r,e),r}a(pn,"keys$2");function gn(e){var n=this,r=n.keys().then(function(f){return f.length});return c(r,e),r}a(gn,"length$2");function mn(e,n){var r=this;e=A(e);var f=r.ready().then(function(){var u=r._dbInfo;localStorage.removeItem(u.keyPrefix+e)});return c(f,n),f}a(mn,"removeItem$2");function bn(e,n,r){var f=this;e=A(e);var u=f.ready().then(function(){n===void 0&&(n=null);var o=n;return new t(function(v,b){var x=f._dbInfo;x.serializer.serialize(n,function(S,R){if(R)b(R);else try{localStorage.setItem(x.keyPrefix+e,S),v(o)}catch(N){(N.name==="QuotaExceededError"||N.name==="NS_ERROR_DOM_QUOTA_REACHED")&&b(N),b(N)}})})});return c(u,r),u}a(bn,"setItem$2");function wn(e,n){if(n=M.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var f=this,u;return e.name?u=new t(function(o){e.storeName?o(cr(e,f._defaultConfig)):o(e.name+"/")}).then(function(o){for(var v=localStorage.length-1;v>=0;v--){var b=localStorage.key(v);b.indexOf(o)===0&&localStorage.removeItem(b)}}):u=t.reject("Invalid arguments"),c(u,n),u}a(wn,"dropInstance$2");var _n={_driver:"localStorageWrapper",_initStorage:ln,_support:un(),iterate:hn,getItem:vn,setItem:bn,removeItem:mn,clear:dn,length:gn,key:yn,keys:pn,dropInstance:wn},xn=a(function(n,r){return n===r||typeof n=="number"&&typeof r=="number"&&isNaN(n)&&isNaN(r)},"sameValue"),Sn=a(function(n,r){for(var f=n.length,u=0;u<f;){if(xn(n[u],r))return!0;u++}return!1},"includes"),sr=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},ce={},lr={},ue={INDEXEDDB:Xr,WEBSQL:fn,LOCALSTORAGE:_n},En=[ue.INDEXEDDB._driver,ue.WEBSQL._driver,ue.LOCALSTORAGE._driver],ye=["dropInstance"],Re=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ye),In={description:"",driver:En.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Rn(e,n){e[n]=function(){var r=arguments;return e.ready().then(function(){return e[n].apply(e,r)})}}a(Rn,"callWhenReady");function Ae(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var r in n)n.hasOwnProperty(r)&&(sr(n[r])?arguments[0][r]=n[r].slice():arguments[0][r]=n[r])}return arguments[0]}a(Ae,"extend");var An=function(){function e(n){E(this,e);for(var r in ue)if(ue.hasOwnProperty(r)){var f=ue[r],u=f._driver;this[r]=u,ce[u]||this.defineDriver(f)}this._defaultConfig=Ae({},In),this._config=Ae({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return a(e,"LocalForage"),e.prototype.config=a(function(r){if((typeof r>"u"?"undefined":I(r))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var f in r){if(f==="storeName"&&(r[f]=r[f].replace(/\W/g,"_")),f==="version"&&typeof r[f]!="number")return new Error("Database version must be a number.");this._config[f]=r[f]}return"driver"in r&&r.driver?this.setDriver(this._config.driver):!0}else return typeof r=="string"?this._config[r]:this._config},"config"),e.prototype.defineDriver=a(function(r,f,u){var o=new t(function(v,b){try{var x=r._driver,S=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!r._driver){b(S);return}for(var R=Re.concat("_initStorage"),N=0,B=R.length;N<B;N++){var $=R[N],z=!Sn(ye,$);if((z||r[$])&&typeof r[$]!="function"){b(S);return}}var q=a(function(){for(var se=a(function(Cn){return function(){var Tn=new Error("Method "+Cn+" is not implemented by the current driver"),dr=t.reject(Tn);return c(dr,arguments[arguments.length-1]),dr}},"methodNotImplementedFactory"),Ne=0,Dn=ye.length;Ne<Dn;Ne++){var De=ye[Ne];r[De]||(r[De]=se(De))}},"configureMissingMethods");q();var X=a(function(se){ce[x]&&console.info("Redefining LocalForage driver: "+x),ce[x]=r,lr[x]=se,v()},"setDriverSupport");"_support"in r?r._support&&typeof r._support=="function"?r._support().then(X,b):X(!!r._support):X(!0)}catch(H){b(H)}});return m(o,f,u),o},"defineDriver"),e.prototype.driver=a(function(){return this._driver||null},"driver"),e.prototype.getDriver=a(function(r,f,u){var o=ce[r]?t.resolve(ce[r]):t.reject(new Error("Driver not found."));return m(o,f,u),o},"getDriver"),e.prototype.getSerializer=a(function(r){var f=t.resolve(Ie);return m(f,r),f},"getSerializer"),e.prototype.ready=a(function(r){var f=this,u=f._driverSet.then(function(){return f._ready===null&&(f._ready=f._initDriver()),f._ready});return m(u,r,r),u},"ready"),e.prototype.setDriver=a(function(r,f,u){var o=this;sr(r)||(r=[r]);var v=this._getSupportedDrivers(r);function b(){o._config.driver=o.driver()}a(b,"setDriverToConfig");function x(N){return o._extend(N),b(),o._ready=o._initStorage(o._config),o._ready}a(x,"extendSelfWithDriver");function S(N){return function(){var B=0;function $(){for(;B<N.length;){var z=N[B];return B++,o._dbInfo=null,o._ready=null,o.getDriver(z).then(x).catch($)}b();var q=new Error("No available storage method found.");return o._driverSet=t.reject(q),o._driverSet}return a($,"driverPromiseLoop"),$()}}a(S,"initDriver");var R=this._driverSet!==null?this._driverSet.catch(function(){return t.resolve()}):t.resolve();return this._driverSet=R.then(function(){var N=v[0];return o._dbInfo=null,o._ready=null,o.getDriver(N).then(function(B){o._driver=B._driver,b(),o._wrapLibraryMethodsWithReady(),o._initDriver=S(v)})}).catch(function(){b();var N=new Error("No available storage method found.");return o._driverSet=t.reject(N),o._driverSet}),m(this._driverSet,f,u),this._driverSet},"setDriver"),e.prototype.supports=a(function(r){return!!lr[r]},"supports"),e.prototype._extend=a(function(r){Ae(this,r)},"_extend"),e.prototype._getSupportedDrivers=a(function(r){for(var f=[],u=0,o=r.length;u<o;u++){var v=r[u];this.supports(v)&&f.push(v)}return f},"_getSupportedDrivers"),e.prototype._wrapLibraryMethodsWithReady=a(function(){for(var r=0,f=Re.length;r<f;r++)Rn(this,Re[r])},"_wrapLibraryMethodsWithReady"),e.prototype.createInstance=a(function(r){return new e(r)},"createInstance"),e}(),Nn=new An;d.exports=Nn},{3:3}]},{},[4])(4)})})(ge);const G=a(({q:l,r:_,s:p})=>`${l} ${_} ${p}`,"asCoordinateKey"),Ce=[0,60,120,180,240,300];var Te={exports:{}};(function(l){(function(_,p,d){function w(i){var s=this,y=h();s.next=function(){var t=2091639*s.s0+s.c*23283064365386963e-26;return s.s0=s.s1,s.s1=s.s2,s.s2=t-(s.c=t|0)},s.c=1,s.s0=y(" "),s.s1=y(" "),s.s2=y(" "),s.s0-=y(i),s.s0<0&&(s.s0+=1),s.s1-=y(i),s.s1<0&&(s.s1+=1),s.s2-=y(i),s.s2<0&&(s.s2+=1),y=null}a(w,"Alea");function I(i,s){return s.c=i.c,s.s0=i.s0,s.s1=i.s1,s.s2=i.s2,s}a(I,"copy");function E(i,s){var y=new w(i),t=s&&s.state,c=y.next;return c.int32=function(){return y.next()*4294967296|0},c.double=function(){return c()+(c()*2097152|0)*11102230246251565e-32},c.quick=c,t&&(typeof t=="object"&&I(t,y),c.state=function(){return I(y,{})}),c}a(E,"impl");function h(){var i=4022871197,s=a(function(y){y=String(y);for(var t=0;t<y.length;t++){i+=y.charCodeAt(t);var c=.02519603282416938*i;i=c>>>0,c-=i,c*=i,i=c>>>0,c-=i,i+=c*4294967296}return(i>>>0)*23283064365386963e-26},"mash");return s}a(h,"Mash"),p&&p.exports?p.exports=E:d&&d.amd?d(function(){return E}):this.alea=E})(V,l,!1)})(Te);var Oe={exports:{}};(function(l){(function(_,p,d){function w(h){var i=this,s="";i.x=0,i.y=0,i.z=0,i.w=0,i.next=function(){var t=i.x^i.x<<11;return i.x=i.y,i.y=i.z,i.z=i.w,i.w^=i.w>>>19^t^t>>>8},h===(h|0)?i.x=h:s+=h;for(var y=0;y<s.length+64;y++)i.x^=s.charCodeAt(y)|0,i.next()}a(w,"XorGen");function I(h,i){return i.x=h.x,i.y=h.y,i.z=h.z,i.w=h.w,i}a(I,"copy");function E(h,i){var s=new w(h),y=i&&i.state,t=a(function(){return(s.next()>>>0)/4294967296},"prng");return t.double=function(){do var c=s.next()>>>11,m=(s.next()>>>0)/4294967296,A=(c+m)/(1<<21);while(A===0);return A},t.int32=s.next,t.quick=t,y&&(typeof y=="object"&&I(y,s),t.state=function(){return I(s,{})}),t}a(E,"impl"),p&&p.exports?p.exports=E:d&&d.amd?d(function(){return E}):this.xor128=E})(V,l,!1)})(Oe);var Be={exports:{}};(function(l){(function(_,p,d){function w(h){var i=this,s="";i.next=function(){var t=i.x^i.x>>>2;return i.x=i.y,i.y=i.z,i.z=i.w,i.w=i.v,(i.d=i.d+362437|0)+(i.v=i.v^i.v<<4^(t^t<<1))|0},i.x=0,i.y=0,i.z=0,i.w=0,i.v=0,h===(h|0)?i.x=h:s+=h;for(var y=0;y<s.length+64;y++)i.x^=s.charCodeAt(y)|0,y==s.length&&(i.d=i.x<<10^i.x>>>4),i.next()}a(w,"XorGen");function I(h,i){return i.x=h.x,i.y=h.y,i.z=h.z,i.w=h.w,i.v=h.v,i.d=h.d,i}a(I,"copy");function E(h,i){var s=new w(h),y=i&&i.state,t=a(function(){return(s.next()>>>0)/4294967296},"prng");return t.double=function(){do var c=s.next()>>>11,m=(s.next()>>>0)/4294967296,A=(c+m)/(1<<21);while(A===0);return A},t.int32=s.next,t.quick=t,y&&(typeof y=="object"&&I(y,s),t.state=function(){return I(s,{})}),t}a(E,"impl"),p&&p.exports?p.exports=E:d&&d.amd?d(function(){return E}):this.xorwow=E})(V,l,!1)})(Be);var Pe={exports:{}};(function(l){(function(_,p,d){function w(h){var i=this;i.next=function(){var y=i.x,t=i.i,c,m;return c=y[t],c^=c>>>7,m=c^c<<24,c=y[t+1&7],m^=c^c>>>10,c=y[t+3&7],m^=c^c>>>3,c=y[t+4&7],m^=c^c<<7,c=y[t+7&7],c=c^c<<13,m^=c^c<<9,y[t]=m,i.i=t+1&7,m};function s(y,t){var c,m=[];if(t===(t|0))m[0]=t;else for(t=""+t,c=0;c<t.length;++c)m[c&7]=m[c&7]<<15^t.charCodeAt(c)+m[c+1&7]<<13;for(;m.length<8;)m.push(0);for(c=0;c<8&&m[c]===0;++c);for(c==8?m[7]=-1:m[c],y.x=m,y.i=0,c=256;c>0;--c)y.next()}a(s,"init"),s(i,h)}a(w,"XorGen");function I(h,i){return i.x=h.x.slice(),i.i=h.i,i}a(I,"copy");function E(h,i){h==null&&(h=+new Date);var s=new w(h),y=i&&i.state,t=a(function(){return(s.next()>>>0)/4294967296},"prng");return t.double=function(){do var c=s.next()>>>11,m=(s.next()>>>0)/4294967296,A=(c+m)/(1<<21);while(A===0);return A},t.int32=s.next,t.quick=t,y&&(y.x&&I(y,s),t.state=function(){return I(s,{})}),t}a(E,"impl"),p&&p.exports?p.exports=E:d&&d.amd?d(function(){return E}):this.xorshift7=E})(V,l,!1)})(Pe);var Le={exports:{}};(function(l){(function(_,p,d){function w(h){var i=this;i.next=function(){var y=i.w,t=i.X,c=i.i,m,A;return i.w=y=y+1640531527|0,A=t[c+34&127],m=t[c=c+1&127],A^=A<<13,m^=m<<17,A^=A>>>15,m^=m>>>12,A=t[c]=A^m,i.i=c,A+(y^y>>>16)|0};function s(y,t){var c,m,A,M,L,Y=[],P=128;for(t===(t|0)?(m=t,t=null):(t=t+"\0",m=0,P=Math.max(P,t.length)),A=0,M=-32;M<P;++M)t&&(m^=t.charCodeAt((M+32)%t.length)),M===0&&(L=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,M>=0&&(L=L+1640531527|0,c=Y[M&127]^=m+L,A=c==0?A+1:0);for(A>=128&&(Y[(t&&t.length||0)&127]=-1),A=127,M=4*128;M>0;--M)m=Y[A+34&127],c=Y[A=A+1&127],m^=m<<13,c^=c<<17,m^=m>>>15,c^=c>>>12,Y[A]=m^c;y.w=L,y.X=Y,y.i=A}a(s,"init"),s(i,h)}a(w,"XorGen");function I(h,i){return i.i=h.i,i.w=h.w,i.X=h.X.slice(),i}a(I,"copy");function E(h,i){h==null&&(h=+new Date);var s=new w(h),y=i&&i.state,t=a(function(){return(s.next()>>>0)/4294967296},"prng");return t.double=function(){do var c=s.next()>>>11,m=(s.next()>>>0)/4294967296,A=(c+m)/(1<<21);while(A===0);return A},t.int32=s.next,t.quick=t,y&&(y.X&&I(y,s),t.state=function(){return I(s,{})}),t}a(E,"impl"),p&&p.exports?p.exports=E:d&&d.amd?d(function(){return E}):this.xor4096=E})(V,l,!1)})(Le);var Me={exports:{}};(function(l){(function(_,p,d){function w(h){var i=this,s="";i.next=function(){var t=i.b,c=i.c,m=i.d,A=i.a;return t=t<<25^t>>>7^c,c=c-m|0,m=m<<24^m>>>8^A,A=A-t|0,i.b=t=t<<20^t>>>12^c,i.c=c=c-m|0,i.d=m<<16^c>>>16^A,i.a=A-t|0},i.a=0,i.b=0,i.c=-1640531527,i.d=1367130551,h===Math.floor(h)?(i.a=h/4294967296|0,i.b=h|0):s+=h;for(var y=0;y<s.length+20;y++)i.b^=s.charCodeAt(y)|0,i.next()}a(w,"XorGen");function I(h,i){return i.a=h.a,i.b=h.b,i.c=h.c,i.d=h.d,i}a(I,"copy");function E(h,i){var s=new w(h),y=i&&i.state,t=a(function(){return(s.next()>>>0)/4294967296},"prng");return t.double=function(){do var c=s.next()>>>11,m=(s.next()>>>0)/4294967296,A=(c+m)/(1<<21);while(A===0);return A},t.int32=s.next,t.quick=t,y&&(typeof y=="object"&&I(y,s),t.state=function(){return I(s,{})}),t}a(E,"impl"),p&&p.exports?p.exports=E:d&&d.amd?d(function(){return E}):this.tychei=E})(V,l,!1)})(Me);var Fe={exports:{}},hr={},yr=Object.freeze({__proto__:null,default:hr}),pr=pe(yr);(function(l){(function(_,p,d){var w=256,I=6,E=52,h="random",i=d.pow(w,I),s=d.pow(2,E),y=s*2,t=w-1,c;function m(O,g,C){var D=[];g=g==!0?{entropy:!0}:g||{};var T=Y(L(g.entropy?[O,Q(p)]:O==null?P():O,3),D),F=new A(D),U=a(function(){for(var j=F.g(I),W=i,k=0;j<s;)j=(j+k)*w,W*=w,k=F.g(1);for(;j>=y;)j/=2,W/=2,k>>>=1;return(j+k)/W},"prng");return U.int32=function(){return F.g(4)|0},U.quick=function(){return F.g(4)/4294967296},U.double=U,Y(Q(F.S),p),(g.pass||C||function(j,W,k,K){return K&&(K.S&&M(K,F),j.state=function(){return M(F,{})}),k?(d[h]=j,W):j})(U,T,"global"in g?g.global:this==d,g.state)}a(m,"seedrandom");function A(O){var g,C=O.length,D=this,T=0,F=D.i=D.j=0,U=D.S=[];for(C||(O=[C++]);T<w;)U[T]=T++;for(T=0;T<w;T++)U[T]=U[F=t&F+O[T%C]+(g=U[T])],U[F]=g;(D.g=function(j){for(var W,k=0,K=D.i,Z=D.j,ee=D.S;j--;)W=ee[K=t&K+1],k=k*w+ee[t&(ee[K]=ee[Z=t&Z+W])+(ee[Z]=W)];return D.i=K,D.j=Z,k})(w)}a(A,"ARC4");function M(O,g){return g.i=O.i,g.j=O.j,g.S=O.S.slice(),g}a(M,"copy");function L(O,g){var C=[],D=typeof O,T;if(g&&D=="object")for(T in O)try{C.push(L(O[T],g-1))}catch{}return C.length?C:D=="string"?O:O+"\0"}a(L,"flatten");function Y(O,g){for(var C=O+"",D,T=0;T<C.length;)g[t&T]=t&(D^=g[t&T]*19)+C.charCodeAt(T++);return Q(g)}a(Y,"mixkey");function P(){try{var O;return c&&(O=c.randomBytes)?O=O(w):(O=new Uint8Array(w),(_.crypto||_.msCrypto).getRandomValues(O)),Q(O)}catch{var g=_.navigator,C=g&&g.plugins;return[+new Date,_,C,_.screen,Q(p)]}}a(P,"autoseed");function Q(O){return String.fromCharCode.apply(0,O)}if(a(Q,"tostring"),Y(d.random(),p),l.exports){l.exports=m;try{c=pr}catch{}}else d["seed"+h]=m})(typeof self<"u"?self:V,[],Math)})(Fe);var gr=Te.exports,mr=Oe.exports,br=Be.exports,wr=Pe.exports,_r=Le.exports,xr=Me.exports,ie=Fe.exports;ie.alea=gr,ie.xor128=mr,ie.xorwow=br,ie.xorshift7=wr,ie.xor4096=_r,ie.tychei=xr;var Sr=ie;function*$e(l,_){let p=0;for(const d of _)p++<l||(yield d)}a($e,"skip");var ze=a(l=>{const _=Sr(l),p={chooseOne(d){if(d instanceof Map||d instanceof Set){const w=Math.floor(_()*d.size),{value:I}=$e(w,d.keys()).next();return I}else{const w=d instanceof Array?d:[...d];return w[Math.floor(_()*w.length)]}},removeOne(d){if(d instanceof Map){const w=p.chooseOne(d),I=d.get(w);return d.delete(w),I}else if(d instanceof Set){const w=p.chooseOne(d);return d.delete(w),w}else{const w=Math.floor(_()*d.length),I=d[w];return d.splice(w,1),I}},*randomIterator(d){if(d instanceof Map||d instanceof Set){const w=Math.floor(_()*d.size);yield*$e(w,d.keys())}else{const w=d instanceof Array?d:[...d],I=Math.floor(_()*w.length);for(let E=0;E<w.length;E++)yield w[(I+E)%w.length]}}};return p},"Random");function*Er(l,_,p){for(const d of me(l,_)){const{coordinate:w}=d,I=p.has(G(w));yield{neighbour:d,connected:I}}}a(Er,"PartitionNeighbours");const Ue=a((l,_,p)=>{var d;(d=l[_])!=null||(l[_]=0),l[_]|=p},"addConnection");function*Ir({size:l,seed:_}){const{chooseOne:p,removeOne:d}=ze(_),w=[...Ye(l)],I={},E=new Set,h=new Map,i=p(w);E.add(G(i));for(const{coordinate:s}of me(l,i))h.set(G(s),s);for(;E.size<w.length;){if(h.size===0)throw new Error("working set unexpectedly empty");const s=d(h),y=G(s),t=[...Er(l,s,E)],c=t.filter(({connected:P})=>P),{neighbour:{coordinate:m,direction:A}}=p(c),{forwards:M,backwards:L}=We(A),Y=G(m);Ue(I,y,M),Ue(I,Y,L),E.add(y);for(const{neighbour:{coordinate:P}}of t.filter(({connected:Q})=>!Q))h.set(G(P),P)}for(const s of w){const y=I[G(s)],t=p(Ce),c=je(y);yield{coordinate:s,orientation:t,connection:c}}}a(Ir,"Prims");function*Rr({size:l,seed:_}){const{chooseOne:p,randomIterator:d,removeOne:w}=ze(_),I=a((y,t)=>d(me(y,t)).next().value,"RandomNeighbour"),E=a((y,t)=>{const c=new Map,m=G(y);let A=[{key:m,coordinate:y,forwards:0,backwards:0}];for(c.set(m,y);;){const M=A.at(-1).coordinate,{coordinate:L,direction:Y}=I(l,M),P=G(L);if(c.has(P)){const O=A.findIndex(({key:g})=>g===P)+1;for(let g=O;g<A.length;g++){const{key:C}=A[g];c.delete(C)}A=A.slice(0,O);continue}else{const{forwards:O,backwards:g}=We(Y);if(A.at(-1).forwards=O,A.push({key:P,coordinate:L,forwards:0,backwards:g}),!t.has(P))return A;c.set(P,L)}}},"loopErasedRandomWalk"),h=[...Ye(l)],i={},s=new Map;for(const y of h)s.set(G(y),y);for(w(s);s.size>0;){const y=w(s),t=E(y,s);for(const{key:c,forwards:m,backwards:A}of t)s.delete(c),i[c]|=m|A}for(const y of h){const t=i[G(y)],c=p(Ce),m=je(t);yield{coordinate:y,orientation:c,connection:m}}}a(Rr,"Wilsons");const je=a(l=>{if(l===0)throw new Error("connection cannot be empty");if(l===63)return 63;for(;!(l&32)||l&1;){const p=l&32;l<<=1,l&=63,p&&(l|=1)}const _=(l&30)>>1;switch(_){case 0:return 32;case 8:return 48;case 4:return 40;case 2:return 36;case 1:return 40;case 12:return 56;case 6:return 44;case 3:return 52;case 9:return 44;case 10:return 52;case 5:return 42;case 14:return 60;case 7:return 46;case 11:return 54;case 13:return 46;case 15:return 62;default:throw new Error(`unhandled truncated case ${_.toString(2)} from connection ${l.toString(2)}`)}},"normalizeConnection");function*Ar({q:l,r:_,s:p}){yield{coordinate:{q:l,r:_-1,s:p+1},direction:0},yield{coordinate:{q:l+1,r:_-1,s:p},direction:1},yield{coordinate:{q:l+1,r:_,s:p-1},direction:2},yield{coordinate:{q:l,r:_+1,s:p-1},direction:3},yield{coordinate:{q:l-1,r:_+1,s:p},direction:4},yield{coordinate:{q:l-1,r:_,s:p+1},direction:5}}a(Ar,"Neighbours$1");function*me(l,_){for(const p of Ar(_)){const{coordinate:{q:d,r:w,s:I}}=p;d<-l||d>l||w<-l||w>l||I<-l||I>l||(yield p)}}a(me,"ValidNeighbours");function*Ye(l){for(let _=-l;_<=l;_++)for(let p=-l;p<=l;p++){const d=-_-p;-l<=d&&d<=l&&(yield{q:_,r:p,s:d})}}a(Ye,"CoordinatesGenerator");const We=a(l=>({forwards:32>>l,backwards:32>>(l+3)%6}),"asConnections");function*Nr(l){const{mode:_}=l;switch(_){case"prims":yield*Ir(l);return;case"wilsons":yield*Rr(l);return}}a(Nr,"PuzzleGenerator");const be=ge.exports.createInstance({driver:ge.exports.INDEXEDDB,name:"hexpanse",version:1,storeName:"gameState"}),we=a(l=>{postMessage(l)},"reply");let de,ve,J;onmessage=a(async({data:l})=>{switch(l.type){case"restore":{de=l.config,ve=vr(de);const _=await be.getItem(ve);if(_)J=_;else{J={};for(const{coordinate:p,orientation:d,connection:w}of Nr(de))J[G(p)]={coordinate:p,orientation:d,connection:w,color:"none"};await be.setItem(ve,J)}we({type:"restored",config:de,state:J}),ne={};for(const p of Object.keys(J))Xe(p);ke();return}case"update cell":{const{coordinate:_,orientation:p}=l,d=G(_),w=J[d];w&&(w.orientation=p,await be.setItem(ve,J),delete ne[d],Xe(d),ke());return}}},"onmessage");const ae=a((l,_,p)=>{for(l.q-=p.q,l.r-=p.r,l.s-=p.s;_>0;)l={q:-l.r,r:-l.s,s:-l.q},_-=60;return l.q+=p.q,l.r+=p.r,l.s+=p.s,l},"rotate");function*Dr(l,_,p){const{q:d,r:w,s:I}=l;p&32&&(yield ae({q:d+1,r:w,s:I-1},_,l)),p&16&&(yield ae({q:d,r:w+1,s:I-1},_,l)),p&8&&(yield ae({q:d-1,r:w+1,s:I},_,l)),p&4&&(yield ae({q:d-1,r:w,s:I+1},_,l)),p&2&&(yield ae({q:d,r:w-1,s:I+1},_,l)),p&1&&(yield ae({q:d+1,r:w-1,s:I},_,l))}a(Dr,"Neighbours");let ne;const Xe=a(l=>{var w;const{coordinate:_,orientation:p,connection:d}=J[l];for(const I of Dr(_,p,d)){const E=G(I);!J[E]||((w=ne[l])!=null||(ne[l]=new Set),ne[l].add(E))}},"updateFacingNeighbours"),Cr=a(l=>{var d;const _={none:0,red:0,green:0,blue:0};for(const w of l){const{color:I}=J[w];I&&(_[I]=((d=_[I])!=null?d:0)+1)}const{color:p}=Object.entries(_).reduce((w,[I,E])=>w.count>E?w:{color:I,count:E},{color:"none",count:0});return p},"mostCommonColor"),Tr=a(l=>Object.entries(l),"entries"),ke=a(()=>{var y;let l=0;const _={},p=a((t,c)=>{var A;if(_[t])return;_[t]=c;const m=ne[t];if(m)for(const M of m)(A=ne[M])!=null&&A.has(t)&&p(M,c)},"floodFill");for(const t of Object.keys(J))p(t,++l);const d={};for(const[t,c]of Object.entries(_))(y=d[c])!=null||(d[c]=new Set),d[c].add(t);if(Object.values(d).length===1)return we({type:"game over"});const w=["none","red","green","blue"],I=new Set(w);I.delete("none");const E={none:new Set,red:new Set,green:new Set,blue:new Set},h=Object.values(d).sort((t,c)=>c.size-t.size),i=[];for(const t of h){if(t.size>1){const c=Cr(t);if(I.has(c)){E[c]=t,I.delete(c);continue}}i.push(t)}let s=0;for(const t of I){if(s>=i.length)break;const c=i[s++];if(c.size<=1)break;E[t]=c}for(const t of i)for(const c of t)E.none.add(c);we({type:"coloring",colors:E});for(const[t,c]of Tr(E))for(const m of c)J[m].color=t},"updateSpan")})();
